{
  "hash": "bb092487265d66361999449fa043e985",
  "result": {
    "markdown": "---\ntitle: \"Melanoma Incidence in Nordic Countries\"\nsubtitle: \"With special focus on Norway\"\nauthor: \"Raju Rimal\"\ndate: \"20 June, 2023\"\ncode-overflow: scroll\ndate-format: \"DD MMMM YYYY\"\nbibliography: References.bib\ncitations-hover: true\npreview-links: true\ncode-fold: true\ncode-tools: \n  toggle: true\nexecute: \n  warning: false\nformat: \n  html:\n    css: style.css\neditor_options: \n  chunk_output_type: console\nnocite: \"@*\"\n---\n\n\n\n\n\n## Introduction\nCutaneous melanoma (CM) is the most aggressive and lethal form of skin cancer. Melanoma can be cured if caught and treated early but if left untreated, it may spread to other parts and can be fatal. In the recent years, melanoma has increased dramatically in fair skinned population worldwide including Nordic countries like Norway, Denmark, and Sweden. Norway is ranked fifth in incidence and third in mortality worldwide. This increase can be an effect of increased awareness in general public and health care provider.\n\nThis article explores ***melanoma incidence*** and ***mortality*** in nordic countries by ***sex*** and their ***trend*** over 40-years period from 1980--2020. Further, I try to step through the analysis process from data collection to create plots and tables.\n\n## Data Preparation\n\nData on melanoma were obtained from NORDCAN [@nordcan-2023, @engholm_nordcan_2010], Association of the Nordic Cancer Registries, IARC. Using NORDCAN 2.0 API^[`https://gco.iarc.fr/gateway_prod/api/nordcan/v2/92/data/population/{type}/{sex}/({country})/({cancer})/?ages_group=5_17&year_start=1980&year_end=2020&year_grouped=0`] crude and age-adjusted rates were downloaded as JSON and converted to tabular data for further analysis. R[@r_core_team_r_2020] software was used for data gathering, cleanup, analysis, and plotting.\n\nThe API endpoint has four placeholder `type`, `sex`, `country`, and `cancer` following design was used to create individual endpoint. These individual url are used to download the JSON file as list in R.\n\n::: panel-tabset\n\n### Data API {.data-api}\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Code for preparing download URL\"}\ndesign_map <- list(\n  sex = c(Male = 1, Female = 2),\n  type = c(Incidence = 0, Mortality = 1),\n  cancer = c(Melanoma = 290),\n  country = c(\n    Denmark = 208, Finland = 246, Iceland = 352,\n    Norway = 578, Sweden = 752\n  )\n)\nlabel_values <- function(data, label_map, var) {\n  label_vec <- label_map[[var]]\n  label <- `names<-`(names(label_vec), label_vec)\n  data[[var]] <- data[, label[as.character(get(var))]]\n  return(data)\n}\n\ndesign <- CJ(\n  sex = 1:2,\n  type = 0:1,\n  cancer = 290,\n  country = c(208, 246, 352, 578, 752)\n)\ndesign[, url := glue::glue_data(.SD, \n  \"https://gco.iarc.fr/gateway_prod/api/nordcan/v2/92/data/population/{type}/{sex}/({country})/({cancer})/?ages_group=5_17&year_start=1980&year_end=2020&year_grouped=0\"\n)]\ndesign <- design %>% \n  label_values(design_map, \"sex\") %>% \n  label_values(design_map, \"type\") %>% \n  label_values(design_map, \"cancer\") %>% \n  label_values(design_map, \"country\")\n```\n:::\n\n\nAPI URL:\n: `https://gco.iarc.fr/gateway_prod/api/nordcan/v2/92/data/population/{type}/{sex}/({country})/({cancer})/?ages_group=5_17&year_start=1980&year_end=2020&year_grouped=0`\n\nReplacing the placeholders `type` (Incidence: 0, Mortality: 1), `sex` (Male: 1, Female: 2), `country` (Denmark: 208, Finland: 246, Iceland: 352, Norway: 578, and Sweden: 752), and `cancer` (Melanoma: 290) prepare the data API.\n\n\n\n\n\n\n### Sample JSON \n\n\n```{ojs}\n//| code-summary: JSON object\njson_data = await FileAttachment(\"Data/nordcan.json\").json()\njson_data[0]\n```\n\n\n### Data download\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Code for data download\"}\nif (!file.exists(\"Data/nordcan-json.Rds\")) {\n  design[, data := map(url, ~read_json(.x) %>% pluck(\"dataset\"))]\n  saveRDS(design, file = \"Data/nordcan-json.Rds\")\n} else {\n  design <- readRDS(\"Data/nordcan-json.Rds\")\n}\ndesign[, .(sex, type, country, data)]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       sex      type country       data\n 1:   Male Incidence Denmark <list[41]>\n 2:   Male Incidence Finland <list[41]>\n 3:   Male Incidence Iceland <list[41]>\n 4:   Male Incidence  Norway <list[41]>\n 5:   Male Incidence  Sweden <list[41]>\n 6:   Male Mortality Denmark <list[41]>\n 7:   Male Mortality Finland <list[41]>\n 8:   Male Mortality Iceland <list[41]>\n 9:   Male Mortality  Norway <list[41]>\n10:   Male Mortality  Sweden <list[41]>\n11: Female Incidence Denmark <list[41]>\n12: Female Incidence Finland <list[41]>\n13: Female Incidence Iceland <list[41]>\n14: Female Incidence  Norway <list[41]>\n15: Female Incidence  Sweden <list[41]>\n16: Female Mortality Denmark <list[41]>\n17: Female Mortality Finland <list[41]>\n18: Female Mortality Iceland <list[41]>\n19: Female Mortality  Norway <list[41]>\n20: Female Mortality  Sweden <list[41]>\n```\n:::\n:::\n\n\n### Data Preparation\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Rate data frame\"}\nrate_df <- design[, map_df(data, function(dta) {\n  out <- data.table(\n    year = map_int(dta, \"year\"),\n    asr_w = map_dbl(dta, \"asr\"),\n    asr_e = map_dbl(dta, \"asr_e\"),\n    asr_n = map_dbl(dta, \"asr_n\"),\n    crude_rate = map_dbl(dta, \"crude_rate\"),\n    count = map_dbl(dta, \"total\"),\n    population = map_dbl(dta, \"total_pop\"),\n    cum_risk = map(dta, \"cum_risk\") %>% \n      unlist()\n  )\n  if (\"cum_risk\" %in% names(out)) {\n    out[, cum_risk := as.numeric(cum_risk)]\n  }\n  return(out)\n}), by = .(sex, type, country)]\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nClasses 'data.table' and 'data.frame':\t820 obs. of  10 variables:\n $ sex       : chr  \"Male\" \"Male\" \"Male\" \"Male\" ...\n $ type      : chr  \"Incidence\" \"Incidence\" \"Incidence\" \"Incidence\" ...\n $ country   : chr  \"Denmark\" \"Denmark\" \"Denmark\" \"Denmark\" ...\n $ year      : int  1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 ...\n $ asr_w     : num  11.9 10.9 12.2 13.4 13.8 ...\n $ asr_e     : num  12.7 12.1 13.1 14.5 15.3 ...\n $ asr_n     : num  13.5 13.1 14.1 15.2 16 ...\n $ crude_rate: num  12.4 12 13.1 14.3 14.8 ...\n $ count     : num  196 191 210 230 239 234 269 283 291 306 ...\n $ population: num  1585436 1593815 1601416 1609960 1618038 ...\n - attr(*, \".internal.selfref\")=<externalptr> \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Rate by age\"}\nrate_by_age <- design[, map_df(data, function(dta) {\n  year <- map_int(dta, \"year\")\n  count_df <- map_df(dta, \"ages\") %>% \n    as.data.table() %>%\n    cbind(year = year) %>% \n    melt.data.table(\n      id.vars = \"year\",\n      variable.name = \"age_group\",\n      value.name = \"count\"\n    )\n  pop_df <- map_df(dta, \"populations\") %>% \n    as.data.table() %>%\n    cbind(year = year) %>% \n    melt.data.table(\n      id.vars = \"year\",\n      variable.name = \"age_group\",\n      value.name = \"population\"\n    )\n  asr_df <- map_df(dta, \"age_specific_rate\") %>% \n    modify(as.numeric) %>% \n    as.data.table() %>%\n    cbind(year = as.numeric(year)) %>% \n    melt.data.table(\n      id.vars = \"year\",\n      variable.name = \"age_group\",\n      value.name = \"asr\"\n    )\n  out <- reduce(\n    list(count_df, pop_df, asr_df),\n    merge.data.table,\n    by = c(\"year\", \"age_group\")\n  )\n  age_lbl <- paste(\n    seq(0, 85, 5),\n    seq(0, 85, 5) + 4,\n    sep = \"-\"\n  )\n  age_lbl[length(age_lbl)] <- \"85+\"\n  names(age_lbl) <- 1:18\n  \n  out[, age_group := age_lbl[age_group]]\n  out[, year := as.integer(year)]\n  out[, count := as.integer(count)]\n  out[, population := as.integer(population)]\n  out[, asr := as.numeric(asr)]\n  return(out[])\n}), by = .(sex, type, country)]\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nClasses 'data.table' and 'data.frame':\t14760 obs. of  8 variables:\n $ sex       : chr  \"Male\" \"Male\" \"Male\" \"Male\" ...\n $ type      : chr  \"Incidence\" \"Incidence\" \"Incidence\" \"Incidence\" ...\n $ country   : chr  \"Denmark\" \"Denmark\" \"Denmark\" \"Denmark\" ...\n $ year      : int  1980 1980 1980 1980 1980 1980 1980 1980 1980 1980 ...\n $ age_group : chr  \"0-4\" \"5-9\" \"10-14\" \"15-19\" ...\n $ count     : int  0 1 1 1 2 8 12 16 13 23 ...\n $ population: int  164317 185710 203405 199741 190444 191785 215098 184439 149015 135409 ...\n $ asr       : num  0 0.538 0.492 0.501 1.05 ...\n - attr(*, \".internal.selfref\")=<externalptr> \n```\n:::\n:::\n\n\n:::\n\n## Analysis\n\nFor the following analysis, crude rates were used in visualization and modelling. Stratified by `sex`, `country` and `type` following plots presents the the `crude_rate` over the `year` of diagnosis. Additionally, using `count` and `population`, a poisson regression model (@eq-poisson-model-1) was fitted.\n\n$$\n\\begin{align}\n\\log\\left(\\frac{\\lambda}{Y}\\right) &= \\beta_0 + \\beta_1 x + \\varepsilon \\\\\n\\text{equivalently, } \\log\\left(\\lambda\\right) &= \\beta_0 + \\beta_1 x + \\log(Y) + \\varepsilon\n\\end{align} \n$$ {#eq-poisson-model-1}\n\nwhere, $\\lambda$ is the number of events (`count`), $Y$ is the number of exposed (`population`) and $x$ is the `year` of diagnosis.\n\nAdditionally, using segmented regression the change points in the trend was identified and the annual percentage change (APC) and average annual percentage change (AAPC) in crude rate were calculated. For each strata, following R-code for poisson regression model and segmented regression model were used.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Data within each strata\"}\nnested_df <- rate_df[, .(\n  data = list(.SD)\n), by = .(sex, type, country)]\nhead(nested_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    sex      type country               data\n1: Male Incidence Denmark <data.table[41x7]>\n2: Male Incidence Finland <data.table[41x7]>\n3: Male Incidence Iceland <data.table[41x7]>\n4: Male Incidence  Norway <data.table[41x7]>\n5: Male Incidence  Sweden <data.table[41x7]>\n6: Male Mortality Denmark <data.table[41x7]>\n```\n:::\n:::\n\n\n::: {.callout-note icon=\"false\"}\n### Poisson regression model\n```r\nmodel <- glm(\n  count ~ year + offset(log(population)),\n  data = rate_df,\n  family = poisson(link = \"log\")\n)\n```\n\n:::\n\n::: {.callout-note icon=\"false\"}\n### Segmented regression model\n```r\nsgmt_model <- segmented(model, npsi = 2)\n```\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Poisson and segmented fit\"}\nfitted_df <- nested_df[, map_df(data, function(dta) {\n  fit <- glm(\n    count ~ year + offset(log(population)),\n    family = poisson(link = \"log\"),\n    data = dta\n  )\n  sgmt_fit <- segmented(fit, npsi = 2)\n\n  data.table(fit = list(fit), sgmt_fit = list(sgmt_fit))\n}), by = .(sex, type, country)]\nhead(fitted_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    sex      type country       fit        sgmt_fit\n1: Male Incidence Denmark <glm[30]> <segmented[42]>\n2: Male Incidence Finland <glm[30]> <segmented[42]>\n3: Male Incidence Iceland <glm[30]> <segmented[42]>\n4: Male Incidence  Norway <glm[30]> <segmented[42]>\n5: Male Incidence  Sweden <glm[30]> <segmented[42]>\n6: Male Mortality Denmark <glm[30]> <segmented[42]>\n```\n:::\n:::\n\n\nFollowing plots highlighting Norway and Finland for comparison show a higher melanoma incidence and mortality rate in Norway compared to Finland. A plateau was observed in melanoma incidence in Norway in both male and female.  \n\n::: panel-tabset\n\n### Crude rate\n\n![](Plots/Line-Nor-Fin.svg)\n\n### Poisson fit\n\n![](Plots/GLM-Nor-Fin.svg)\n\n### Segmented fit\n\n![](Plots/Sgmt-Nor-Fin.svg)\n\n### All countries\n\n::: panel-tabset\n\n### Poisson fit\n\n![](Plots/GLM-all.svg)\n\n### Segmented fit\n\n![](Plots/Sgmt-all.svg)\n\n:::\n:::\n\n- Norway has higher melanoma incidence and mortality than Finland.\n- Finland has lowest melanoma incidence and mortality in both sexes\n- Norway has highest melanoma mortality followed by Sweden in both sexes\n- Denmark has surpassed both Norway and Sweden in melanoma incidence in the recent years\n- A plateau period was observed in melanoma incidence in Norway.\n- Most countries has raise in melanoma incidence after 2005.\n- A declining melanoma moratlity was observed in all countries in recent years. \n\n\n## Model {.smaller}\n\n### Annual percentge change (APC)\n\n![](Plots/model-summary-plot.svg){width=\"100%\"}\n\n### APC within segments\n\n\n::: {.cell}\n\n```{.r .cell-code}\na_apc <- readRDS(\"Results/APC.Rds\")\napc <- copy(a_apc[[1]])\naapc <- copy(a_apc[[2]])\napc[, label_period := glue::glue_data(.SD, \"{label}<br>{psi}\")]\napc[, segment := gsub(\"slope\", \"\", segment)]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\napc[country %in% c(\"Norway\", \"Denmark\")] %>% \n  dcast.data.table(\n  country + segment ~ type + sex,\n  value.var = \"label_period\"\n) %>% gt::gt(\n  id = \"apc-table\",\n  rowname_col = \"segment\",\n  groupname_col = \"country\"\n) %>% gt::tab_spanner_delim(\"_\") %>% \n  gt::fmt_markdown(everything()) %>% \n  gt::sub_missing(everything(), missing_text = \"-\") %>%\n  gt::tab_stubhead(\"Segment\") %>% \n  gt::tab_options(\n    data_row.padding = \"0px\",\n    table.width = \"100%\",\n    table.font.size = \"small\",\n    column_labels.font.weight = \"bold\",\n    row_group.font.weight = \"bold\"\n  )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"apc-table\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#apc-table table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#apc-table thead, #apc-table tbody, #apc-table tfoot, #apc-table tr, #apc-table td, #apc-table th {\n  border-style: none;\n}\n\n#apc-table p {\n  margin: 0;\n  padding: 0;\n}\n\n#apc-table .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: small;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#apc-table .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#apc-table .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#apc-table .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#apc-table .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#apc-table .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#apc-table .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#apc-table .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#apc-table .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#apc-table .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#apc-table .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#apc-table .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#apc-table .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#apc-table .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#apc-table .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#apc-table .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#apc-table .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#apc-table .gt_row {\n  padding-top: 0px;\n  padding-bottom: 0px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#apc-table .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#apc-table .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#apc-table .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#apc-table .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#apc-table .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#apc-table .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#apc-table .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#apc-table .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#apc-table .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#apc-table .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#apc-table .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#apc-table .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#apc-table .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#apc-table .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#apc-table .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#apc-table .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#apc-table .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#apc-table .gt_left {\n  text-align: left;\n}\n\n#apc-table .gt_center {\n  text-align: center;\n}\n\n#apc-table .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#apc-table .gt_font_normal {\n  font-weight: normal;\n}\n\n#apc-table .gt_font_bold {\n  font-weight: bold;\n}\n\n#apc-table .gt_font_italic {\n  font-style: italic;\n}\n\n#apc-table .gt_super {\n  font-size: 65%;\n}\n\n#apc-table .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#apc-table .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#apc-table .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#apc-table .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#apc-table .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#apc-table .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#apc-table .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Segment\">Segment</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Incidence\">\n        <span class=\"gt_column_spanner\">Incidence</span>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Mortality\">\n        <span class=\"gt_column_spanner\">Mortality</span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Female\">Female</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Male\">Male</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Female\">Female</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Male\">Male</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"5\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Denmark\">Denmark</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_right gt_stub\"><div class='gt_from_md'><p>1</p>\n</div></th>\n<td headers=\"Denmark stub_1_1 Incidence_Female\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>2.73 (2.42, 3.04)<br>1980-2002</p>\n</div></td>\n<td headers=\"Denmark stub_1_1 Incidence_Male\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>3.53 (3.22, 3.84)<br>1980-2004</p>\n</div></td>\n<td headers=\"Denmark stub_1_1 Mortality_Female\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>10.46 (-6.14, 29.98)<br>1980-1982</p>\n</div></td>\n<td headers=\"Denmark stub_1_1 Mortality_Male\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>0.62 (0.08, 1.16)<br>1980-2004</p>\n</div></td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_right gt_stub\"><div class='gt_from_md'><p>2</p>\n</div></th>\n<td headers=\"Denmark stub_1_2 Incidence_Female\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>6.92 (5.8, 8.04)<br>2002-2011</p>\n</div></td>\n<td headers=\"Denmark stub_1_2 Incidence_Male\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>9.86 (7.38, 12.39)<br>2004-2009</p>\n</div></td>\n<td headers=\"Denmark stub_1_2 Mortality_Female\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>0.65 (0.26, 1.03)<br>1982-2014</p>\n</div></td>\n<td headers=\"Denmark stub_1_2 Mortality_Male\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>4.02 (0.85, 7.29)<br>2004-2012</p>\n</div></td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_right gt_stub\"><div class='gt_from_md'><p>3</p>\n</div></th>\n<td headers=\"Denmark stub_1_3 Incidence_Female\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>1.79 (1.18, 2.41)<br>2011-2020</p>\n</div></td>\n<td headers=\"Denmark stub_1_3 Incidence_Male\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>3.12 (2.55, 3.69)<br>2009-2020</p>\n</div></td>\n<td headers=\"Denmark stub_1_3 Mortality_Female\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>-1.98 (-6.26, 2.5)<br>2014-2020</p>\n</div></td>\n<td headers=\"Denmark stub_1_3 Mortality_Male\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>-2.14 (-4.06, -0.17)<br>2012-2020</p>\n</div></td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"5\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Norway\">Norway</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_4\" scope=\"row\" class=\"gt_row gt_right gt_stub\"><div class='gt_from_md'><p>1</p>\n</div></th>\n<td headers=\"Norway stub_1_4 Incidence_Female\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>3.92 (2.9, 4.96)<br>1980-1990</p>\n</div></td>\n<td headers=\"Norway stub_1_4 Incidence_Male\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>5.49 (4.32, 6.67)<br>1980-1991</p>\n</div></td>\n<td headers=\"Norway stub_1_4 Mortality_Female\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>1 (0.18, 1.84)<br>1980-2000</p>\n</div></td>\n<td headers=\"Norway stub_1_4 Mortality_Male\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>17.06 (-0.38, 37.54)<br>1980-1982</p>\n</div></td></tr>\n    <tr><th id=\"stub_1_5\" scope=\"row\" class=\"gt_row gt_right gt_stub\"><div class='gt_from_md'><p>2</p>\n</div></th>\n<td headers=\"Norway stub_1_5 Incidence_Female\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>-0.1 (-1.26, 1.08)<br>1990-1999</p>\n</div></td>\n<td headers=\"Norway stub_1_5 Incidence_Male\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>0.45 (-0.44, 1.35)<br>1991-2002</p>\n</div></td>\n<td headers=\"Norway stub_1_5 Mortality_Female\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>2.7 (1.31, 4.1)<br>2000-2013</p>\n</div></td>\n<td headers=\"Norway stub_1_5 Mortality_Male\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>1.79 (1.4, 2.19)<br>1982-2011</p>\n</div></td></tr>\n    <tr><th id=\"stub_1_6\" scope=\"row\" class=\"gt_row gt_right gt_stub\"><div class='gt_from_md'><p>3</p>\n</div></th>\n<td headers=\"Norway stub_1_6 Incidence_Female\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>3.62 (3.35, 3.88)<br>1999-2020</p>\n</div></td>\n<td headers=\"Norway stub_1_6 Incidence_Male\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>4.39 (4.08, 4.69)<br>2002-2020</p>\n</div></td>\n<td headers=\"Norway stub_1_6 Mortality_Female\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>-5.01 (-8.14, -1.76)<br>2013-2020</p>\n</div></td>\n<td headers=\"Norway stub_1_6 Mortality_Male\" class=\"gt_row gt_center\"><div class='gt_from_md'><p>-1.97 (-3.79, -0.12)<br>2011-2020</p>\n</div></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n## Model {.smaller}\n\n**Incidence model:**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nmdl_inc <- glm(\n  data = rate_df,\n  formula = count ~ year + sex + country,\n  offset = log(population),\n  family = poisson(link = \"log\"),\n  subset = type == \"Incidence\"\n)\n```\n:::\n\n\n**Mortality model**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nmdl_mor <- glm(\n  data = rate_df,\n  formula = count ~ year + sex + country,\n  offset = log(population),\n  family = poisson(link = \"log\"),\n  subset = type == \"Mortality\"\n)\n```\n:::\n\n\n### Incidence model summary\n\n::: {.cell}\n\n```{.r .cell-code}\nbroom::tidy(mdl_inc, conf.int = TRUE, exponentiate = TRUE) %>% \n  modify_at(c(2:4, 6:7), round, 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 7\n  term           estimate std.error statistic   p.value conf.low conf.high\n  <chr>             <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 (Intercept)       0         0.383   -205.   0            0         0    \n2 year              1.04      0        185.   0            1.04      1.04 \n3 sexMale           1.01      0.004      1.90 5.68e-  2    1         1.02 \n4 countryFinland    0.649     0.007    -62.6  0            0.64      0.658\n5 countryIceland    0.494     0.028    -25.6  1.86e-144    0.468     0.521\n6 countryNorway     1.05      0.006      8.09 5.84e- 16    1.04      1.06 \n7 countrySweden     0.936     0.005    -12.1  1.41e- 33    0.926     0.946\n```\n:::\n:::\n\n\n### Mortality model summary\n\n::: {.cell}\n\n```{.r .cell-code}\nbroom::tidy(mdl_mor, conf.int = TRUE, exponentiate = TRUE) %>% \n  modify_at(c(2:4, 6:7), round, 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 7\n  term           estimate std.error statistic   p.value conf.low conf.high\n  <chr>             <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 (Intercept)       0         0.844    -40.9  0            0         0    \n2 year              1.01      0         29.2  1.53e-187    1.01      1.01 \n3 sexMale           1.46      0.01      38.0  0            1.43      1.49 \n4 countryFinland    0.731     0.016    -19.2  1.67e- 82    0.708     0.755\n5 countryIceland    0.611     0.061     -8.02 1.05e- 15    0.54      0.688\n6 countryNorway     1.24      0.015     14.6  3.57e- 48    1.20      1.27 \n7 countrySweden     1.03      0.013      2.2  2.78e-  2    1.00      1.06 \n```\n:::\n:::\n\n\n\n## Summary \n\n- Melanoma incidence and moratlity is increasing in all countries\n- Norway has highest mortality rate through out the period and has highest increase in both incidence and mortality.\n- Melanoma incidence increased rapidly in Denmark between 2002 and 2011 in women and 2004-2009 in men surpassing Norway.\n- Mortality is decreasing in all countries in recent period.\n\n## References\n\n::: {#refs}\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}