{
  "hash": "af3a0947a093ab49dd3b11e2bb24341b",
  "result": {
    "markdown": "---\ntitle: \"Simulating data for ANOVA similar to existing dataset for analysis\"\nauthor: TheRimalaya\ndate: \"2023-02-04\"\ndate-modified: \"2024-10-21\"\ncode-fold: true\ncategories:\n  - Simulation\n  - Statistics\ntags:\n  - Simulation\n  - Statistics\n  - ANOVA\n---\n\n\nSimulating data is an important tool in both education and research, and it has been extremely helpful for testing, comparing, and understanding concepts in practical and applied settings.\n\n\n\n\n\n\nOften, we use Analysis of Variance (ANOVA) to analyze variances to find out if different cases result in similar outcomes and if the differences are significant. Some simple examples include:\n\n- The effect of different diets on the growth of fish\n- Comparing the heights of three different plant species\n- The type of flour used for baking bread\n\nThese are common examples where, in some cases, data are collected by setting up an experiment, and in other cases, they are collected through sampling. This article explains how ANOVA analyzes the variance and in what situations are they significant through both simulated and real data.\n\nConsider the following model with $i=3$ groups and $j=n$ observations,\n\n$$\ny_{ij} = \\mu + \\tau_i + \\varepsilon_{ij}, \\; i = 1, 2, 3 \n\\texttt{ and } j = 1, 2, \\ldots n\n$$\n\nHere, $\\tau_i$ is the effect corresponding to group $i$ and \n$\\varepsilon_{ij} \\sim \\mathrm{N}(0, \\sigma^2)$, the usual assumption of \nlinear model. The simulation example below describes it in detail.\n\n# Simulation Example\n\nIn this simulation example, I aim to replicate specific elements of the `USArrests` dataset by simulating 50 cases for three types of crimes: Murder, Assault, and Rape. For each crime, I categorize individuals into three groups based on illiteracy levels and simulate their respective arrest rates. Here’s concise overview of the process and analysis steps:\n\n## Simulation Design\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Simulation design\"}\nsim_design <- tidytable(\n  Illiteracy = factor(\n    rep(c(1, 2, 3), 3),\n    labels = c(\"high\", \"medium\", \"low\")\n  ),\n  Crime = factor(\n    rep(c(1, 2, 3), each = 3),\n    labels = c(\"Murder\", \"Assault\", \"Rape\")\n  ),\n  mean = c(11, 8, 5, 214, 190, 114, 23, 21, 19),\n  sd = c(3, 4, 3, 79, 82, 55, 8, 10, 10)\n)\n\nsim_design\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 9 × 4\n  Illiteracy Crime    mean    sd\n  <fct>      <fct>   <dbl> <dbl>\n1 high       Murder     11     3\n2 medium     Murder      8     4\n3 low        Murder      5     3\n4 high       Assault   214    79\n5 medium     Assault   190    82\n6 low        Assault   114    55\n7 high       Rape       23     8\n8 medium     Rape       21    10\n9 low        Rape       19    10\n```\n:::\n:::\n\n\nSince these data cannot contain negative values so instead of using `rnorm` available in `stats` package, I will use `truncnorm` available in GitHub.  There are other options as well which can be used such as: ...\n\nIf not installed, install the package as \n`remotes::install_github(\"olafmersmann/truncnorm\")` or \n`devtools::install_github(\"olafmersmann/truncnorm\")`.\n\n### Code for Simulation, Analysis, and Plot\n\nLet's simulate 50 observation Arrest `Rate` in each levels of `Illiteracy`, and `Crime` in simulation design.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\" code-summary=\"Number of simulation\"}\nnsim <- 50\n```\n:::\n\n\n::: panel-tabset\n\n### Simulation Code\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\" code-summary=\"Simulated data\"}\nsim_data <- sim_design %>% \n  group_by(Illiteracy, Crime) %>% \n  mutate(rate = map2(mean, sd, ~tidytable(\n    Rate = truncnorm::rtruncnorm(\n      n = nsim, a = 0, b = Inf, mean = .x, sd = .y\n    ) %>% round()\n  ))) %>% \n  unnest() %>% ungroup() %>% \n  nest(.by = c(Crime))\n```\n:::\n\n\nHere, Arrest rates were generated from a normal distribution using `truncnorm` from `truncnorm` package to get only positive value and also mirroring the mean and standard deviation in `USArrests`. Using normal distributions ensures the synthetic data mimics the actual data’s variation and mean, making the simulations realistic.\n\n### Data from simulation\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Simulated data by group\"}\nsim_data\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 3 × 2\n  Crime   data                 \n  <fct>   <list>               \n1 Murder  <tidytable [150 × 4]>\n2 Assault <tidytable [150 × 4]>\n3 Rape    <tidytable [150 × 4]>\n```\n:::\n:::\n\n\n::: panel-tabset\n\n#### Murder\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Simulated data for Murder\"}\nhead(sim_data[Crime == \"Murder\", data][[1]])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 6 × 4\n  Illiteracy  mean    sd  Rate\n  <fct>      <dbl> <dbl> <dbl>\n1 high          11     3     7\n2 high          11     3    11\n3 high          11     3     9\n4 high          11     3    12\n5 high          11     3    15\n6 high          11     3    13\n```\n:::\n:::\n\n\n#### Assault\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Simulated data for Assault\"}\nhead(sim_data[Crime == \"Assault\", data][[1]])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 6 × 4\n  Illiteracy  mean    sd  Rate\n  <fct>      <dbl> <dbl> <dbl>\n1 high         214    79   178\n2 high         214    79   163\n3 high         214    79   174\n4 high         214    79   234\n5 high         214    79   181\n6 high         214    79   139\n```\n:::\n:::\n\n\n#### Rape\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Simulated data for Rape\"}\nhead(sim_data[Crime == \"Rape\", data][[1]])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 6 × 4\n  Illiteracy  mean    sd  Rate\n  <fct>      <dbl> <dbl> <dbl>\n1 high          23     8    25\n2 high          23     8    22\n3 high          23     8    16\n4 high          23     8    15\n5 high          23     8    35\n6 high          23     8    23\n```\n:::\n:::\n\n\n\n:::\n\n:::\n\nUsing the simulated data above, we now fit an Anova model with `Illiteracy` as a factor (group) variable that affects the Arrest `Rate` (response variable) separately for each `Crime`. I have also made a density plot for the `Rate` variable for both simulated data and plot it with normal curve with corresponding mean and standard deviation. Following are the codes for fitting the Anova model, and creating density plot and box plot. Also we will perform a Posthoc test using Tukey's method to make a pairwise comparison of different `Illiteracy` levels.\n\n::: {.callout-tip collapse=\"true\"}\n## Code for Model Fit and Plotting\n\n::: panel-tabset\n\n### Model and plot data\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\" code-summary=\"Model fit and prepare data for plot\"}\nmdl_fit <- sim_data %>% \n  mutate(\n    Fit = map(data, ~lm(Rate ~ Illiteracy, data = .x)),\n    Summary = map(Fit, summary),\n    Anova = map(Fit, anova),\n    Tukey = map(Fit, aov) %>% map(TukeyHSD)\n  )\n\nmdl_est <- mdl_fit %>% \n  summarize(\n    across(Summary, map, broom::tidy), \n    .by = c(Crime)\n  ) %>% unnest()\n\nmdl_fit_df <- mdl_fit %>% \n  summarize(\n    across(Fit, map, broom::augment),\n    .by = c(Crime)\n  ) %>% unnest()\n\neff_df <- mdl_fit %>% \n  summarize(\n    across(Fit, map, function(.fit) {\n      effects::Effect(\"Illiteracy\", .fit) %>%\n        as_tidytable()\n    }),\n    .by = \"Crime\"\n  ) %>% unnest()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in check_dep_version(): ABI version mismatch: \nlme4 was built with Matrix ABI version 1\nCurrent Matrix ABI version is 2\nPlease re-install lme4 from source or restore original 'Matrix' package\n```\n:::\n\n```{.r .cell-code  code-fold=\"false\" code-summary=\"Model fit and prepare data for plot\"}\ntky_df <- mdl_fit %>% \n  summarize(\n    across(Tukey, function(tky) {\n      map(tky, purrr::pluck, \"Illiteracy\") %>%\n        map(as_tidytable, .keep_rownames = \"terms\")\n    }),\n    .by = \"Crime\"\n  ) %>% unnest()\n```\n:::\n\n\n### Density plot\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\" code-summary=\"Density plot\"}\ndensity_plot <- sim_data %>% \n  unnest(data) %>% \n  ggplot(aes(Rate, color = Illiteracy)) +\n    facet_wrap(\n      facets = vars(Crime),\n      ncol = 3,\n      scales = \"free\",\n    ) +\n    geom_density(aes(linetype = \"Simulated\")) +\n    geom_density(\n      aes(linetype = \"Fitted\", x = .fitted),\n      data = mdl_fit_df\n    ) +\n    geom_rug(\n      data = eff_df,\n      aes(x = fit)\n    ) +\n    scale_linetype_manual(\n      breaks = c(\"Simulated\", \"Fitted\"),\n      values = c(\"solid\", \"dashed\")\n    ) +\n    scale_color_brewer(palette = \"Set1\") +\n    theme(legend.position = \"bottom\") +\n    labs(\n      x = \"Arrest Rate\",\n      y = \"Density\",\n      linetype = NULL\n    )\n```\n:::\n\n\n### Box plot\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\" code-summary=\"Boxplot\"}\neffect_plot <- mdl_fit_df %>% \n  ggplot(aes(Rate, Illiteracy)) +\n    facet_grid(\n      cols = vars(Crime),\n      scales = \"free_x\"\n    ) +\n    geom_boxplot(\n      notch = TRUE, \n      color = \"grey\",\n      outlier.colour = \"grey\"\n    ) +\n    geom_point(\n      position = position_jitter(height = 0.25),\n      color = \"grey\",\n      size = rel(0.9)\n    ) +\n    geom_pointrange(\n      aes(\n        color = \"Estimated\",\n        xmin = lower,\n        xmax = upper,\n        x = fit\n      ),\n      data = eff_df\n    ) +\n    geom_point(\n      aes(color = \"True Mean\", x = mean),\n      data = sim_design\n    ) +\n    scale_color_brewer(\n      name = \"Mean\",\n      palette = \"Set1\"\n    ) +\n    theme(\n      legend.position = \"bottom\"\n    )\n```\n:::\n\n\n### Posthoc plot\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\" code-summary=\"Post-hoc Tukey plot\"}\ntukey_plot <- tky_df %>% \n  ggplot(aes(diff, terms)) +\n    facet_grid(\n      cols = vars(Crime), \n      scales = \"free_x\"\n    ) +\n    geom_pointrange(\n      aes(xmin = lwr, xmax = upr, x = diff),\n      shape = 21,\n      fill = \"whitesmoke\"\n    ) +\n    geom_vline(\n      xintercept = 0,\n      linetype = \"dashed\",\n      color = \"royalblue\"\n    ) +\n    scale_color_brewer(\n      name = \"Mean\",\n      palette = \"Set1\"\n    ) +\n    labs(\n      y = \"Illiteracy\",\n      x = \"Effect difference\",\n      title = \"Pairwise comparison of levels of illitracy\"\n    ) +\n    expand_limits(x = 0)\n```\n:::\n\n\n:::\n\n:::\n\n## Analysis\n\n::: panel-tabset\n\n### Distribution\n\n\n::: {.cell fig.asp='0.5'}\n\n```{.r .cell-code  code-summary=\"Density of simulated data\"}\ndensity_plot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.svg){width=100%}\n:::\n:::\n\n\nHere, the kernel density plots for arrest rates were shown alongside the normal density curve. This visual assessment checked the goodness of fit between simulated data and the expected normal distribution. The close match between kernel density and normal density validates that the data follows a normal distribution, confirming the simulation's accuracy.\n\n### Model Fit\n\nA one-way ANOVA output below helps to find if there is any difference between arrest rate based on illiteracy level for each crime. Here we see that in all crimes high illiteracy level was considered as reference and compared to this both medium and low illiteracy levels have lower arrest rate. This suggest that the higher illiteracy rate corresponds to higher arrest rate. However, for crimes: assault and rape, the effect of medium illiteracy rate has high p-value and can not be considered to have significant effect on arrest rate.\n\n::: panel-tabset\n\n#### Murder\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"ANOVA output for crime: Murder\"}\nmdl_fit[Crime == \"Murder\", Summary][[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Rate ~ Illiteracy, data = .x)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n -8.44  -2.31   0.08   1.95   7.56 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       10.9200     0.4247  25.713  < 2e-16 ***\nIlliteracymedium  -2.4800     0.6006  -4.129 6.08e-05 ***\nIlliteracylow     -6.0000     0.6006  -9.990  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.003 on 147 degrees of freedom\nMultiple R-squared:  0.4068,\tAdjusted R-squared:  0.3987 \nF-statistic:  50.4 on 2 and 147 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n\n#### Assault\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"ANOVA output for crime: Assault\"}\nmdl_fit[Crime == \"Assault\", Summary][[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Rate ~ Illiteracy, data = .x)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-158.32  -42.22   -3.11   38.74  221.68 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        208.32       9.64  21.609  < 2e-16 ***\nIlliteracymedium    -5.00      13.63  -0.367    0.714    \nIlliteracylow      -95.42      13.63  -6.999 8.51e-11 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 68.17 on 147 degrees of freedom\nMultiple R-squared:  0.2969,\tAdjusted R-squared:  0.2873 \nF-statistic: 31.03 on 2 and 147 DF,  p-value: 5.709e-12\n```\n:::\n:::\n\n\n\n#### Rape\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"ANOVA output for crime: Rape\"}\nmdl_fit[Crime == \"Rape\", Summary][[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Rate ~ Illiteracy, data = .x)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-20.10  -6.10  -0.11   5.56  20.90 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        22.440      1.219  18.403  < 2e-16 ***\nIlliteracymedium   -1.340      1.724  -0.777  0.43837    \nIlliteracylow      -5.320      1.724  -3.085  0.00243 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.622 on 147 degrees of freedom\nMultiple R-squared:  0.06547,\tAdjusted R-squared:  0.05276 \nF-statistic:  5.15 on 2 and 147 DF,  p-value: 0.006894\n```\n:::\n:::\n\n\n\n:::\n\n### Effect Plot\n\n\n::: {.cell fig.asp='0.5'}\n\n```{.r .cell-code  code-summary=\"Boxplot with fitted and true mean\"}\neffect_plot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.svg){width=100%}\n:::\n:::\n\n\nBoxplots displayed arrest rate distributions within each illiteracy group stratified by crime. Points were scattered for detailed visualization, along with fitted means and confidence intervals. Here for all crimes, higher illiteracy corresponds to higher arrest rate and is more visible in murder.\n\n### Post-hoc\n\n\n::: {.cell fig.asp='0.5'}\n\n```{.r .cell-code  code-summary=\"Post-hoc plot comparing pairwise difference\"}\ntukey_plot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-18-1.svg){width=100%}\n:::\n:::\n\n\nThe post-hoc plot has highlighted statistically significant differences between different levels of illiteracy. Here, all pairs of illiteracy levels differ significantly at 95% confidence level for Murder however there is not such significant difference between medium and high illiteracy level for assault and rape.\n\n:::\n\n# Real Data Example\n\n## Data preparation and Dataset\n\nHere, I have used `USArrests` dataset excluding the crime `UrbanPop` and merged it with another dataset `state.x77` using its `Illiteracy` variable for 50 states. The Illiteracy was than categorized using its quantiles into three categories `low`, `medium`, and `high` mimiking the simulation example above.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Merging USArrests and state.x77\"}\narrest <- as_tidytable(USArrests, .keep_rownames = \"States\") %>% \n  tidytable::left_join(\n    as_tidytable(\n      state.x77[, \"Illiteracy\", drop = FALSE],\n      .keep_rownames = \"States\"\n    ),\n    by = \"States\"\n  ) %>% \n  select(-UrbanPop) %>% \n  mutate(across(Murder:Illiteracy, as.numeric)) %>% \n  mutate(Illiteracy = cut.default(\n    Illiteracy,\n    breaks = quantile(Illiteracy, c(0, 1/3, 2/3, 1)),\n    labels = c(\"low\", \"medium\", \"high\"),\n    include.lowest = TRUE\n  )) %>% \n  mutate(Illiteracy = factor(\n    Illiteracy,\n    levels = c(\"high\", \"medium\", \"low\")\n  )) %>% \n  pivot_longer(\n    cols = Murder:Rape,\n    names_to = \"Crime\",\n    values_to = \"Rate\"\n  ) %>% nest(.by = c(Crime))\n```\n:::\n\n\n::: panel-tabset\n\n### Data by Crime\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Data by group\"}\narrest\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 3 × 2\n  Crime   data                \n  <chr>   <list>              \n1 Murder  <tidytable [50 × 3]>\n2 Assault <tidytable [50 × 3]>\n3 Rape    <tidytable [50 × 3]>\n```\n:::\n:::\n\n\n### Murder\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Data for crime: Murder\"}\nhead(arrest[Crime == \"Murder\", data][[1]], 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 3 × 3\n  States  Illiteracy  Rate\n  <chr>   <fct>      <dbl>\n1 Alabama high        13.2\n2 Alaska  high        10  \n3 Arizona high         8.1\n```\n:::\n:::\n\n\n### Assault\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Data for crime: Assault\"}\nhead(arrest[Crime == \"Assault\", data][[1]], 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 3 × 3\n  States  Illiteracy  Rate\n  <chr>   <fct>      <dbl>\n1 Alabama high         236\n2 Alaska  high         263\n3 Arizona high         294\n```\n:::\n:::\n\n\n### Rape\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Data for crime: Rape\"}\nhead(arrest[Crime == \"Rape\", data][[1]], 3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 3 × 3\n  States  Illiteracy  Rate\n  <chr>   <fct>      <dbl>\n1 Alabama high        21.2\n2 Alaska  high        44.5\n3 Arizona high        31  \n```\n:::\n:::\n\n\n:::\n\n## Analysis\n\nI am following a similar pattern as in the analysis of simulated data: distribution plot, fitting an ANOVA model, effect plot showing the fitted value with a boxplot, and a Post-hoc showing pairwise comparison of the effect of illiteracy levels on arrest rate.\n\n::: panel-tabset\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmdl_fit <- arrest %>% \n  mutate(\n    Fit = map(data, ~lm(Rate ~ Illiteracy, data = .x)),\n    Summary = map(Fit, summary),\n    Anova = map(Fit, anova),\n    Tukey = map(Fit, aov) %>% map(TukeyHSD)\n  )\n\nmdl_est <- mdl_fit %>% \n  summarize(\n    across(Summary, map, broom::tidy, conf.int = TRUE),\n    .by = c(Crime)\n  ) %>% unnest()\n\nmdl_fit_df <- mdl_fit %>% \n  summarize(\n    across(Fit, map, broom::augment),\n    .by = c(Crime)\n  ) %>% unnest()\n\neff_df <- mdl_fit %>% \n  summarize(\n    across(Fit, map, function(.fit){\n      effects::Effect(\"Illiteracy\", .fit) %>%\n        as_tidytable()\n    }),\n    .by = c(Crime)\n  ) %>% unnest()\n\ntky_df <- mdl_fit %>% \n  summarize(\n    across(Tukey, function(tky) {\n      map(tky, purrr::pluck, \"Illiteracy\") %>%\n        map(as_tidytable, .keep_rownames = \"terms\")\n    }),\n    .by = \"Crime\"\n  ) %>% unnest()\n```\n:::\n\n\n#### Distribution\n\n\n::: {.cell fig.asp='0.5'}\n\n```{.r .cell-code}\nggplot(unnest(arrest), aes(Rate, color = Illiteracy)) +\n  geom_density(aes(linetype = \"Simulated\")) +\n  geom_density(\n    aes(linetype = \"Fitted\", x = .fitted),\n    data = mdl_fit_df\n  ) +\n  geom_rug(\n    data = eff_df,\n    aes(x = fit)\n  ) +\n  scale_linetype_manual(\n    breaks = c(\"Simulated\", \"Fitted\"),\n    values = c(\"solid\", \"dashed\")\n  ) +\n  scale_color_brewer(palette = \"Set1\") +\n  theme(legend.position = \"bottom\") +\n  labs(\n    x = \"Crime\",\n    y = \"Density\",\n    linetype = NULL\n  ) +\n  facet_wrap(\n    facets = vars(Crime),\n    scales = \"free\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-25-1.svg){width=100%}\n:::\n:::\n\n\nKernel density alongside normal density curves for each crime shows and validates the normal distribution of the real data and help confirm the normality assumption for ANOVA, ensuring that the real data analysis aligns with the assumptions necessary for valid inference.\n\n#### Fit\n\n::: panel-tabset\n\n##### Murder\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"ANOVA output for crime: Murder\"}\nmdl_fit[Crime == \"Murder\", Summary][[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Rate ~ Illiteracy, data = .x)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.7067 -2.3000 -0.3059  1.7882  7.8933 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       11.4118     0.8084  14.116  < 2e-16 ***\nIlliteracymedium  -3.9051     1.1808  -3.307  0.00181 ** \nIlliteracylow     -6.8118     1.1273  -6.043 2.32e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.333 on 47 degrees of freedom\nMultiple R-squared:  0.4382,\tAdjusted R-squared:  0.4143 \nF-statistic: 18.33 on 2 and 47 DF,  p-value: 1.302e-06\n```\n:::\n:::\n\n\n##### Assult\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"ANOVA output for crime: Assault\"}\nmdl_fit[Crime == \"Assault\", Summary][[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Rate ~ Illiteracy, data = .x)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-168.000  -41.792   -4.083   47.958  145.333 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        214.00      17.53  12.208 3.51e-16 ***\nIlliteracymedium   -24.33      25.60  -0.950 0.346771    \nIlliteracylow      -99.83      24.44  -4.084 0.000171 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 72.28 on 47 degrees of freedom\nMultiple R-squared:  0.2786,\tAdjusted R-squared:  0.2479 \nF-statistic: 9.074 on 2 and 47 DF,  p-value: 0.0004653\n```\n:::\n:::\n\n\n##### Rape\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"ANOVA output for crime: Rape\"}\nmdl_fit[Crime == \"Rape\", Summary][[1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Rate ~ Illiteracy, data = .x)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-14.133  -6.259  -2.357   3.766  26.939 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)        23.353      2.275  10.263 1.38e-13 ***\nIlliteracymedium   -1.920      3.323  -0.578    0.566    \nIlliteracylow      -4.292      3.173  -1.353    0.183    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 9.382 on 47 degrees of freedom\nMultiple R-squared:  0.03766,\tAdjusted R-squared:  -0.003286 \nF-statistic: 0.9198 on 2 and 47 DF,  p-value: 0.4057\n```\n:::\n:::\n\n\n:::\n\n#### Effects\n\n\n::: {.cell fig.asp='0.5'}\n\n```{.r .cell-code}\nggplot(unnest(arrest), aes(Rate, Illiteracy)) +\n  geom_boxplot(\n    notch = FALSE,\n    color = \"grey\",\n    outlier.colour = \"grey\"\n  ) +\n  geom_point(\n    position = position_jitter(height = 0.25),\n    color = \"grey\",\n  ) +\n  geom_pointrange(\n    aes(\n      xmin = lower,\n      xmax = upper,\n      x = fit\n    ),\n    color = \"firebrick\",\n    data = eff_df\n  ) +\n  scale_color_brewer(\n    name = \"Mean\",\n    palette = \"Set1\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  ) +\n  facet_wrap(facets = vars(Crime), scales = \"free_x\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-29-1.svg){width=100%}\n:::\n:::\n\n\n#### Post-hoc\n\n::: {.cell fig.asp='0.5'}\n\n```{.r .cell-code}\nggplot(tky_df, aes(diff, terms)) +\n  geom_pointrange(\n    aes(xmin = lwr, xmax = upr, x = diff),\n    shape = 21,\n    fill = \"whitesmoke\"\n  ) +\n  geom_vline(\n    xintercept = 0,\n    linetype = \"dashed\",\n    color = \"royalblue\"\n  ) +\n  scale_color_brewer(\n    name = \"Mean\",\n    palette = \"Set1\"\n  ) +\n  labs(\n    y = \"Illiteracy\",\n    x = \"Effect difference\",\n    title = \"Pairwise comparison of levels of illiteracy\"\n  ) +\n  expand_limits(x = 0) +\n  facet_wrap(facets = vars(Crime), scales = \"free_x\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-30-1.svg){width=100%}\n:::\n:::\n\n\n:::\n\nThe analysis using both simulated and real datasets demonstrates the effectiveness of ANOVA in uncovering patterns. Simulating data that closely mirrors the USArrests dataset provided a controlled environment for testing and understanding variable interactions.\n\nWhen applied to real data, the analysis confirmed significant differences in arrest rates across illiteracy groups, validating the method. By comparing these results, I highlighted how well-designed simulations can replicate real-world scenarios, offering valuable insights and preparing for real-world analyses.\n\nThis approach underscores the utility of combining simulated and real data, showcasing the robustness and reliability of the analytical methods used.",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}