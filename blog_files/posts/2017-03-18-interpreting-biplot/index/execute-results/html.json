{
  "hash": "5bff4c47b793bc23c4c12e4f3908c79a",
  "result": {
    "markdown": "---\ntitle  : Interpretating Biplot\nsubtitle: A tool for exploring multivariate data\nslug   : interpretation-biplot\nauthor : TheRimalaya\ndate: 2017-03-18\ndate-modified: 2024-10-06\ncode-fold: true\ncategories:\n  - statistics\n  - machine learning\n  - data science\ntags:\n  - pca\n  - biplot\n  - exploring data\n  - interpretation of biplot\n---\n\n\n\n\nA biplot is a powerful graphical tool that represents data in two dimensions, where both the observations and variables are represented. Biplots are particularly useful for multivariate data, allowing users to examine relationships between variables and identify patterns.\n\nConsider a data matrix $\\mathbf{X}_{n\\times p}$ with $p$ variables and $n$ observations. To explore the data further with biplot, principal component analysis (PCA) is used here. \n\n::: {.columns}\n\n::: {.column}\n![](images/Img-1.jpg){width=\"90%\"}\n:::\n\n::: {.column}\n\n$$\n\\begin{pmatrix}\n\\mathbf{x}_1 \\\\ \\mathbf{x}_2 \\\\ \\vdots \\\\ \\mathbf{x}_p\n\\end{pmatrix}^T =\n\\begin{pmatrix}\nx_{11} & x_{12} & \\ldots & x_{1p} \\\\\nx_{21} & x_{22} & \\ldots & x_{2p} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\nx_{n1} & x_{n2} & \\ldots & x_{np}\n\\end{pmatrix}\n$$\nwhere $\\mathbf{x}_{i} = \\begin{pmatrix}x_{1i} & \\ldots & x_{ni}\\end{pmatrix}$ is the i<sup>th</sup> variable.\n\n:::\n\n:::\n\n\nPrincipal component analysis (PCA) compresses the variance of the data matrix to create a new set of orthogonal (linearly independent) variables $\\mathbf{Z} = \\begin{pmatrix}\\mathbf{z}_1 & \\mathbf{z}_2 & \\ldots & \\mathbf{z}_q\\end{pmatrix}$, where $q = \\min(n, p)$, often termed as principal components (PC) or scores. In PCA, the most variation is captured by the first component and rest in the subsequent components in decreasing order. In other words, the first principal component ($\\mathbf{z}_1$) captures the highest variation and second principal component ($\\mathbf{z}_2$) captures the maximum of remaing variation and so on.\n \n::: {.columns}\n::: {.column}\n![](images/Img-2.jpg){width=\"95%\"}\n:::\n::: {.column}\n$$\\begin{aligned}\n\\mathbf{z}_{1} &= w_{11}\\mathbf{x}_{1} + \\ldots + w_{1p}\\mathbf{x}_{p} \\\\\n\\mathbf{z}_{2} &= w_{21}\\mathbf{x}_{1} + \\ldots + w_{2p}\\mathbf{x}_{p} \\\\\n\\vdots \\\\\n\\mathbf{z}_{q} &= w_{q1}\\mathbf{x}_{1} + \\ldots + w_{qp}\\mathbf{x}_{p} \\\\\n\\end{aligned}\n$${#eq-pca}\n\n:::\n:::\n\nWe can use eigenvalue decomposition or singular value decompostion for this purpose.\n\nThese principle components are created using linear combination of the original variables. For example, $\\mathbf{z}_1 = w_{11}\\mathbf{x}_1 + \\ldots + w_{1p}\\mathbf{x}_p$ and similarly for $\\mathbf{z}_2, \\ldots, \\mathbf{z}_q$. Here we can estimate weights $w_{ij}$, where $i = 1 \\ldots q$ and $j = 1 \\ldots p$ using [eigenvalue decomposition](https://en.wikipedia.org/wiki/Eigendecomposition_of_a_matrix) or [singular value  (SVD)](https://en.wikipedia.org/wiki/Singular_value_decomposition). These weights are also refered as loading or the matrix of these weights as rotation matrix.\n\nBiplot plots the scores from two principal components together with loadings (weight) for each variables in the same plot. The following example uses [`USArrests`](https://www.rdocumentation.org/packages/datasets/versions/3.3.2/topics/USArrests) data from `datasets` package in R. The dataset contains the number of arrests per 100,000 residents for assault, murder, and rape in each of the 50 US states in 1973.\n\nTwo functions `prcomp` and `princomp` in R performs the principal component analysis. The function `prcomp` uses SVD on data matrix $\\mathbf{X}$ while `princomp` uses eigenvalue decomposition on covariance or correlation matrix of the data matrix. We will use `prcomp` for our example.\n\n### Dataset: USArrest\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nUSArrests <- as_tidytable(USArrests, .keep_rownames = \"State\")\nhead(USArrests)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 6 × 5\n  State      Murder Assault UrbanPop  Rape\n  <chr>       <dbl>   <int>    <int> <dbl>\n1 Alabama      13.2     236       58  21.2\n2 Alaska       10       263       48  44.5\n3 Arizona       8.1     294       80  31  \n4 Arkansas      8.8     190       50  19.5\n5 California    9       276       91  40.6\n6 Colorado      7.9     204       78  38.7\n```\n:::\n:::\n\n\n### Principal component analysis\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npca <- prcomp(USArrests[, -1], scale. = TRUE)\nstr(pca)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nList of 5\n $ sdev    : num [1:4] 1.575 0.995 0.597 0.416\n $ rotation: num [1:4, 1:4] -0.536 -0.583 -0.278 -0.543 -0.418 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : chr [1:4] \"Murder\" \"Assault\" \"UrbanPop\" \"Rape\"\n  .. ..$ : chr [1:4] \"PC1\" \"PC2\" \"PC3\" \"PC4\"\n $ center  : Named num [1:4] 7.79 170.76 65.54 21.23\n  ..- attr(*, \"names\")= chr [1:4] \"Murder\" \"Assault\" \"UrbanPop\" \"Rape\"\n $ scale   : Named num [1:4] 4.36 83.34 14.47 9.37\n  ..- attr(*, \"names\")= chr [1:4] \"Murder\" \"Assault\" \"UrbanPop\" \"Rape\"\n $ x       : num [1:50, 1:4] -0.976 -1.931 -1.745 0.14 -2.499 ...\n  ..- attr(*, \"dimnames\")=List of 2\n  .. ..$ : NULL\n  .. ..$ : chr [1:4] \"PC1\" \"PC2\" \"PC3\" \"PC4\"\n - attr(*, \"class\")= chr \"prcomp\"\n```\n:::\n:::\n\n\n::: panel-tabset\n\n### Biplot\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nscore_df <- as_tidytable(pca$x) %>% \n  mutate(State = USArrests[, State])\n\nloading_df <- as_tidytable(\n  pca$rotation, \n  .keep_rownames = \"Variable\"\n)\n\nggplot(score_df, aes(PC1, PC2)) +\n  geom_hline(\n    yintercept = 0, \n    color = \"royalblue\", \n    linetype = \"dashed\"\n  ) +\n  geom_vline(\n    xintercept = 0, \n    color = \"royalblue\", \n    linetype = \"dashed\"\n  ) +\n  geom_segment(\n    data = loading_df,\n    aes(\n      x = 0, xend = PC1 * 2,\n      y = 0, yend = PC2 * 2\n    ),\n    color = \"firebrick\",\n    arrow = arrow(length = unit(2, \"mm\"))\n  ) +\n  geom_text(\n    data = loading_df,\n    aes(\n      x = PC1 * 2.6, \n      y = PC2 * 2.6, \n      label = Variable\n    ),\n    color = \"firebrick\",\n    size = rel(5)\n  ) +\n  geom_text(\n    aes(label = State), \n    check_overlap = TRUE,\n    color = \"gray50\"\n  ) +\n  theme_minimal(base_size = 18) +\n  theme(\n    panel.background = element_rect(color = \"gray50\")\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n### Variance explained\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsummary(pca)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nImportance of components:\n                          PC1    PC2     PC3     PC4\nStandard deviation     1.5749 0.9949 0.59713 0.41645\nProportion of Variance 0.6201 0.2474 0.08914 0.04336\nCumulative Proportion  0.6201 0.8675 0.95664 1.00000\n```\n:::\n\n```{.r .cell-code}\nvar_df <- tidytable(\n  PC = paste0(\"PC\", 1:length(pca$sdev)),\n  Variance = pca$sdev^2\n)\nggplot(var_df, aes(PC, Variance)) +\n  geom_line(group = 1) +\n  geom_point(\n    stroke = 1, size = 3, \n    shape = 21, fill = \"whitesmoke\"\n  ) +\n  theme_minimal(base_size = 18) +\n  theme(\n    panel.background = element_rect(color = \"gray20\")\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nHere we see that more than 87% of variation in $\\mathbf{X}$ was captured by first two principal components (65% by the first and 25% by the second component).\n\n:::\n\n## Explore data using biplot\n\nNow lets compare the scores from the first two components, observations and variables in the data matrix. From the `USArrests` data, lets look at the top five states with highest and lowest arrest for each of these crimes.\n\n::: panel-tabset\n### States with highest arrests\n\n::: panel-tabset\n\n#### Murder\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nUSArrests %>% arrange(-Murder) %>% top_n()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 5 × 5\n  State          Murder Assault UrbanPop  Rape\n  <chr>           <dbl>   <int>    <int> <dbl>\n1 Georgia          17.4     211       60  25.8\n2 Mississippi      16.1     259       44  17.1\n3 Florida          15.4     335       80  31.9\n4 Louisiana        15.4     249       66  22.2\n5 South Carolina   14.4     279       48  22.5\n```\n:::\n:::\n\n\n#### Assault\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nUSArrests %>% arrange(-Assault) %>% top_n()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 5 × 5\n  State          Murder Assault UrbanPop  Rape\n  <chr>           <dbl>   <int>    <int> <dbl>\n1 North Carolina   13       337       45  16.1\n2 Florida          15.4     335       80  31.9\n3 Maryland         11.3     300       67  27.8\n4 Arizona           8.1     294       80  31  \n5 New Mexico       11.4     285       70  32.1\n```\n:::\n:::\n\n\n#### UrbanPop\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nUSArrests %>% arrange(-UrbanPop) %>% top_n()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 5 × 5\n  State         Murder Assault UrbanPop  Rape\n  <chr>          <dbl>   <int>    <int> <dbl>\n1 California       9       276       91  40.6\n2 New Jersey       7.4     159       89  18.8\n3 Rhode Island     3.4     174       87   8.3\n4 New York        11.1     254       86  26.1\n5 Massachusetts    4.4     149       85  16.3\n```\n:::\n:::\n\n\n#### Rape\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nUSArrests %>% arrange(-Rape) %>% top_n()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 5 × 5\n  State      Murder Assault UrbanPop  Rape\n  <chr>       <dbl>   <int>    <int> <dbl>\n1 Nevada       12.2     252       81  46  \n2 Alaska       10       263       48  44.5\n3 California    9       276       91  40.6\n4 Colorado      7.9     204       78  38.7\n5 Michigan     12.1     255       74  35.1\n```\n:::\n:::\n\n\n\n:::\n\n### States with lowest arrests\n\n::: panel-tabset\n\n#### Murder\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nUSArrests %>% arrange(Murder) %>% top_n()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 5 × 5\n  State         Murder Assault UrbanPop  Rape\n  <chr>          <dbl>   <int>    <int> <dbl>\n1 North Dakota     0.8      45       44   7.3\n2 Maine            2.1      83       51   7.8\n3 New Hampshire    2.1      57       56   9.5\n4 Iowa             2.2      56       57  11.3\n5 Vermont          2.2      48       32  11.2\n```\n:::\n:::\n\n\n#### Assault\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nUSArrests %>% arrange(Assault) %>% top_n()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 5 × 5\n  State        Murder Assault UrbanPop  Rape\n  <chr>         <dbl>   <int>    <int> <dbl>\n1 North Dakota    0.8      45       44   7.3\n2 Hawaii          5.3      46       83  20.2\n3 Vermont         2.2      48       32  11.2\n4 Wisconsin       2.6      53       66  10.8\n5 Iowa            2.2      56       57  11.3\n```\n:::\n:::\n\n\n#### UrbanPop\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nUSArrests %>% arrange(UrbanPop) %>% top_n()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 5 × 5\n  State          Murder Assault UrbanPop  Rape\n  <chr>           <dbl>   <int>    <int> <dbl>\n1 Vermont           2.2      48       32  11.2\n2 West Virginia     5.7      81       39   9.3\n3 Mississippi      16.1     259       44  17.1\n4 North Dakota      0.8      45       44   7.3\n5 North Carolina   13       337       45  16.1\n```\n:::\n:::\n\n\n#### Rape\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nUSArrests %>% arrange(Rape) %>% top_n()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 5 × 5\n  State         Murder Assault UrbanPop  Rape\n  <chr>          <dbl>   <int>    <int> <dbl>\n1 North Dakota     0.8      45       44   7.3\n2 Maine            2.1      83       51   7.8\n3 Rhode Island     3.4     174       87   8.3\n4 West Virginia    5.7      81       39   9.3\n5 New Hampshire    2.1      57       56   9.5\n```\n:::\n:::\n\n\n:::\n\n:::\n\nComparing these highest and lowest arrests with the biplot, we can see a pattern. The weights corresponding to PC1 for all the variables are negative and are directed towards states like Florida, Nevada, and California. These states have the highest number of arrests for all of these crimes where as states that are in the oppositve direction like Iowa, North Dakota, and Vermont have the lowest arrest.\n\nSimilarly, UrbanPop have the highest weights corresponding to PC2 so the states in that direction such as California, Hawaii, and New Jersey have highest arrest related to UrbanPop. The states in the opposite direction, i.e. with negative PC2 scores such as Mississippi, North Carolina, Vermont, and South Carolina have the lowest arrest related to UrbanPop.\n\nThe weights for all variables are negative and towards states like . So in our data these states must have the highest arrests in all these crimes where as states like New Dakota, Vermont, and Iowa have the lowest arrests.\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}