{
  "hash": "81683020043f281b378e4da724885235",
  "result": {
    "markdown": "---\ntitle: Basic Scatter Plot and linear fitted line\nslug: basic-scatter-plot-with-reg-line\nauthor: TheRimalaya\ndraft: true\ndate: 2017-03-01\ncode-fold: true\ntags:\n  - R\n  - Statistics\n  - Regression\n  - Visualization\n---\n\n\n\n\nLets scatter into some points created by data in xy-space. Data are scattered everywhere but what relation is there between some specific variable with other. Cutting down to simple talking and stick to the heading, we can use [`mtcars`](https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html) dataset in R.\n\nThe dataset from Motor Trend US magazine, 1974 comprises fuel consumption and 10 various aspects of automobile design and their performance for 32 automobiles of different models. I will try to obtain the scatter plot for the model and the fitted line for the model.\n\nIn R, there are three popular packages for obtaining plots _Base Graphics_, _Lattice Plot_ and _ggplot2_. Here we will create a scatter plot between two variables `mpg` (mile per gallon) and `disp`(displacement) along with the fitted regession line with equation and $RÂ²$ value in it using all there graphics packages.\n\nLets first fit a linear model,\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nmdl <- lm(mpg ~ disp, data = mtcars)\nsumry <- summary(mdl)\ncf <- round(coef(mdl), 2)\n\neqn <- paste(terms(mdl)[[2]],\n             paste0(cf[1], ifelse(cf[2] < 0, \" \", \" + \"),\n                    cf[2], \" \", terms(mdl)[[3]]), sep = \" = \")\nsumry.lbl <- paste0(\"R^2: \", round(sumry$r.squared, 2),\n                    \", adj R^2: \", round(sumry$adj.r.squared, 2))\n```\n:::\n\n\n::: panel-tabset\n\n### Base Graphics {.tab}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nwith(mtcars, {\n  plot(disp, mpg, pch = 22, bg = \"gray\",\n       xlab = \"Displacement\", ylab = \"Mile per Gallon\",\n       main = \"Displacement vs Mile per Gallon\")\n  abline(mdl, col = \"red\", lty = 2, lwd = 2)\n  text(max(disp), max(mpg), adj = c(1, 1), family = \"monospace\",\n       label = paste(eqn, sumry.lbl, sep = \"\\n\"))\n})\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.svg){fig-align='center' width=100%}\n:::\n:::\n\n\n### Lattice Plot {.tab}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(lattice)\nlm.panel <- function(x, y, ...) {\n  panel.xyplot(x, y, pch = 22, fill = \"gray\",\n               cex = 1.2, col = \"black\")\n  panel.text(max(x), max(y), pos = 2,\n             fontfamily = \"monospace\",\n             label = paste(eqn, sumry.lbl, sep = \"\\n\"))\n  panel.abline(mdl, col = \"red\", lty = 2, lwd = 2)\n}\nxyplot(mpg ~ disp, data = mtcars,\n       panel = lm.panel,\n       main = \"Displacement vs Mile per Gallon\",\n       xlab = \"Displacement\", ylab = \"Mile per Gallon\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.svg){fig-align='center' width=100%}\n:::\n:::\n\n\n### ggplot {.tab}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nplt <- qplot(disp, mpg, data = mtcars, geom = c(\"point\"),\n             xlab = \"Displacement\",\n             ylab = \"Mile per Gallon\",\n             main = \"Displacement vs Mile per Gallon\",\n             size = I(3), shape = I(22), fill = I(\"grey\"))\nplt + theme_bw() +\n  geom_smooth(method = \"lm\", color = \"red\", linetype = 2) +\n  annotate(x = Inf, y = Inf, geom = \"text\",\n           hjust = 1.2, vjust = 1.2,\n           family = \"monospace\",\n           label = paste(eqn, sumry.lbl, sep = \"\\n\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.svg){fig-align='center' width=100%}\n:::\n:::\n\n\nThe fitted regression summary is,\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = mpg ~ disp, data = mtcars)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.8922 -2.2022 -0.9631  1.6272  7.2305 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 29.599855   1.229720  24.070  < 2e-16 ***\ndisp        -0.041215   0.004712  -8.747 9.38e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.251 on 30 degrees of freedom\nMultiple R-squared:  0.7183,\tAdjusted R-squared:  0.709 \nF-statistic: 76.51 on 1 and 30 DF,  p-value: 9.38e-10\n```\n:::\n:::\n\n\nThis means, the effect of displacement on mile per gallon of the cars in the model is negative and its magnitude is 0.04. In other words, on one unit change of displacement, the car will travel 0.04 less per gallon.\n\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}