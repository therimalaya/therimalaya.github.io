{
  "hash": "9aaa8308b9e39a1d34205d28348b1397",
  "result": {
    "markdown": "---\ntitle: \"Melanoma Incidence in Nordic Countries\"\nauthor: \"Raju Rimal\"\ndate: 2023-06-20\ndate-modified: today\ncode-overflow: scroll\nbibliography: References.bib\ncitations-hover: true\npreview-links: true\ncode-fold: true\ncode-tools: \n  toggle: true\nexecute: \n  warning: false\nformat: \n  html:\n    css: style.css\neditor_options: \n  chunk_output_type: console\nnocite: \"@*\"\n---\n\n\n\n\n\n## Introduction\nCutaneous melanoma (CM) is the most aggressive and lethal form of skin cancer. Melanoma can be cured if caught and treated early but if left untreated, it may spread to other parts and can be fatal. In the recent years, melanoma has increased dramatically in fair skinned population worldwide including Nordic countries like Norway, Denmark, and Sweden. Norway is ranked fifth in incidence and third in mortality worldwide. This increase can be an effect of increased awareness in general public and health care provider.\n\nThis article explores ***melanoma incidence*** and ***mortality*** in nordic countries by ***sex*** and their ***trend*** over 40-years period from 1980--2020. Further, I try to step through the analysis process from data collection to create plots and tables.\n\n## Data Preparation\n\nData on melanoma were obtained from NORDCAN [@nordcan-2023, @engholm_nordcan_2010], Association of the Nordic Cancer Registries, IARC. Using NORDCAN 2.0 API^[`https://gco.iarc.fr/gateway_prod/api/nordcan/v2/92/data/population/{type}/{sex}/({country})/({cancer})/?ages_group=5_17&year_start=1980&year_end=2020&year_grouped=0`] crude and age-adjusted rates were downloaded as JSON and converted to tabular data for further analysis. R[@r_core_team_r_2020] software was used for data gathering, cleanup, analysis, and plotting.\n\nThe API endpoint has four placeholder `type`, `sex`, `country`, and `cancer` following design was used to create individual endpoint. These individual url are used to download the JSON file as list in R.\n\n::: panel-tabset\n\n### Data API {.data-api}\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Code for preparing download URL\"}\ndesign_map <- list(\n  sex = c(Male = 1, Female = 2),\n  type = c(Incidence = 0, Mortality = 1),\n  cancer = c(Melanoma = 290),\n  country = c(\n    Denmark = 208, Finland = 246, Iceland = 352,\n    Norway = 578, Sweden = 752\n  )\n)\nlabel_values <- function(data, label_map, var) {\n  label_vec <- label_map[[var]]\n  label <- `names<-`(names(label_vec), label_vec)\n  data[[var]] <- data[, label[as.character(get(var))]]\n  return(data)\n}\n\ndesign <- do.call(crossing, design_map) %>% \n  mutate(\n    url = glue::glue( \n      \"https://gco.iarc.fr/gateway_prod/api/nordcan/v2/92/data/population/{type}/{sex}/({country})/({cancer})/?ages_group=5_17&year_start=1980&year_end=2020&year_grouped=0\"\n    )\n  )\n\ndesign <- design %>% \n  label_values(design_map, \"sex\") %>% \n  label_values(design_map, \"type\") %>% \n  label_values(design_map, \"cancer\") %>% \n  label_values(design_map, \"country\")\n```\n:::\n\n\nAPI URL:\n: `https://gco.iarc.fr/gateway_prod/api/nordcan/v2/92/data/population/{type}/{sex}/({country})/({cancer})/?ages_group=5_17&year_start=1980&year_end=2020&year_grouped=0`\n\nReplacing the placeholders `type` (Incidence: 0, Mortality: 1), `sex` (Male: 1, Female: 2), `country` (Denmark: 208, Finland: 246, Iceland: 352, Norway: 578, and Sweden: 752), and `cancer` (Melanoma: 290) prepare the data API.\n\n\n\n\n\n### Sample JSON \n\n\n```{ojs}\n//| code-summary: JSON object\njson_data = await FileAttachment(\"Data/nordcan.json\").json()\njson_data[0]\n```\n\n\n### Data download\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Code for data download\"}\nif (!file.exists(\"Data/nordcan-json.Rds\")) {\n  design[, data := map(url, ~read_json(.x) %>% purrr::pluck(\"dataset\"))]\n  saveRDS(design, file = \"Data/nordcan-json.Rds\")\n} else {\n  design <- readRDS(\"Data/nordcan-json.Rds\")\n}\ndesign <- design %>% \n  tidytable::select(sex, type, country, data)\n```\n:::\n\n\n### Data Preparation\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Rate data frame\"}\nrate_df <- design[, map_df(data, function(dta) {\n  out <- data.table(\n    year = map_int(dta, ~get(\"year\", .x)),\n    asr_w = map_dbl(dta, ~get(\"asr\", .x)),\n    asr_e = map_dbl(dta, ~get(\"asr_e\", .x)),\n    asr_n = map_dbl(dta, ~get(\"asr_n\", .x)),\n    crude_rate = map_dbl(dta, ~get(\"crude_rate\", .x)),\n    count = map_dbl(dta, ~get(\"total\", .x)),\n    population = map_dbl(dta, ~get(\"total_pop\", .x)),\n    cum_risk = map(dta, ~get(\"cum_risk\", .x)) %>% \n      unlist()\n  )\n  if (\"cum_risk\" %in% names(out)) {\n    out <- out %>% \n      mutate(cum_risk = as.numeric(cum_risk))\n  }\n  return(out)\n}), by = .(sex, type, country)]\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nClasses 'tidytable', 'data.table' and 'data.frame':\t820 obs. of  10 variables:\n $ sex       : chr  \"Male\" \"Male\" \"Male\" \"Male\" ...\n $ type      : chr  \"Incidence\" \"Incidence\" \"Incidence\" \"Incidence\" ...\n $ country   : chr  \"Denmark\" \"Denmark\" \"Denmark\" \"Denmark\" ...\n $ year      : int  1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 ...\n $ asr_w     : num  11.9 10.9 12.2 13.4 13.8 ...\n $ asr_e     : num  12.7 12.1 13.1 14.5 15.3 ...\n $ asr_n     : num  13.5 13.1 14.1 15.2 16 ...\n $ crude_rate: num  12.4 12 13.1 14.3 14.8 ...\n $ count     : num  196 191 210 230 239 234 269 283 291 306 ...\n $ population: num  1585436 1593815 1601416 1609960 1618038 ...\n - attr(*, \".internal.selfref\")=<externalptr> \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Rate by age\"}\nrate_by_age <- design[, map_df(data, function(dta) {\n  year <- map_int(dta, ~get(\"year\", .x))\n  count_df <- map(dta, ~get(\"ages\", .x)) %>% \n    map_dfr(as_tidytable) %>% \n    cbind(year = year) %>% \n    pivot_longer(\n      cols = -\"year\",\n      names_to = \"age_group\",\n      values_to = \"count\"\n    )\n  pop_df <- map(dta, ~get(\"populations\", .x)) %>% \n    map_dfr(as_tidytable) %>%\n    cbind(year = year) %>% \n    pivot_longer(\n      cols = -\"year\",\n      names_to = \"age_group\",\n      values_to = \"population\"\n    )\n  asr_df <- map(dta, ~get(\"age_specific_rate\", .x)) %>% \n    map_dfr(as_tidytable) %>% \n    as_tidytable() %>%\n    cbind(year = as.numeric(year)) %>% \n    pivot_longer(\n      cols = -\"year\",\n      names_to = \"age_group\",\n      values_to = \"asr\"\n    )\n  out <- purrr::reduce(\n    list(count_df, pop_df, asr_df),\n    inner_join,\n    by = c(\"year\", \"age_group\")\n  )\n  age_lbl <- paste(\n    seq(0, 85, 5),\n    seq(0, 85, 5) + 4,\n    sep = \"-\"\n  )\n  age_lbl[length(age_lbl)] <- \"85+\"\n  names(age_lbl) <- 1:18\n\n  out %>% \n    mutate(age_group = age_lbl[age_group]) %>% \n    mutate(asr = as.numeric(asr)) %>% \n    mutate(across(c(year, count, population), as.integer))\n\n}), by = .(sex, type, country)]\n```\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nClasses 'tidytable', 'data.table' and 'data.frame':\t14760 obs. of  8 variables:\n $ sex       : chr  \"Male\" \"Male\" \"Male\" \"Male\" ...\n $ type      : chr  \"Incidence\" \"Incidence\" \"Incidence\" \"Incidence\" ...\n $ country   : chr  \"Denmark\" \"Denmark\" \"Denmark\" \"Denmark\" ...\n $ year      : int  1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 ...\n $ age_group : chr  \"0-4\" \"0-4\" \"0-4\" \"0-4\" ...\n $ count     : int  0 0 0 0 0 0 0 0 0 0 ...\n $ population: int  164317 156964 150170 145414 139557 135827 134375 136240 138423 142597 ...\n $ asr       : num  0 0 0 0 0 0 0 0 0 0 ...\n - attr(*, \".internal.selfref\")=<externalptr> \n```\n:::\n:::\n\n\n:::\n\n## Analysis\n\nFor the following analysis, crude rates were used in visualization and modelling. Stratified by `sex`, `country` and `type` following plots presents the the `crude_rate` over the `year` of diagnosis. Additionally, using `count` and `population`, a poisson regression model (@eq-poisson-model-1) was fitted.\n\n$$\n\\begin{align}\n\\log\\left(\\frac{\\lambda}{Y}\\right) &= \\beta_0 + \\beta_1 x + \\varepsilon \\\\\n\\text{equivalently, } \\log\\left(\\lambda\\right) &= \\beta_0 + \\beta_1 x + \\log(Y) + \\varepsilon\n\\end{align} \n$$ {#eq-poisson-model-1}\n\nwhere, $\\lambda$ is the number of events (`count`), $Y$ is the number of exposed (`population`) and $x$ is the `year` of diagnosis.\n\nAdditionally, using segmented regression the change points in the trend was identified and the annual percentage change (APC) and average annual percentage change (AAPC) in crude rate were calculated. For each strata, following R-code for poisson regression model and segmented regression model were used.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Data within each strata\"}\nnested_df <- rate_df %>% \n  nest(data = -c(sex, type, country))\nhead(nested_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 6 × 4\n  sex   type      country data                \n  <chr> <chr>     <chr>   <list>              \n1 Male  Incidence Denmark <tidytable [41 × 7]>\n2 Male  Incidence Finland <tidytable [41 × 7]>\n3 Male  Incidence Iceland <tidytable [41 × 7]>\n4 Male  Incidence Norway  <tidytable [41 × 7]>\n5 Male  Incidence Sweden  <tidytable [41 × 7]>\n6 Male  Mortality Denmark <tidytable [41 × 7]>\n```\n:::\n:::\n\n\n### Modelling\n\n::: {.callout-note icon=\"false\"}\n#### Poisson regression model\n\n```r\nmodel <- glm(\n  count ~ year + offset(log(population)),\n  data = rate_df,\n  family = poisson(link = \"log\")\n)\n```\n\n:::\n\n::: {.callout-note icon=\"false\"}\n#### Segmented regression model\n\n```r\nsgmt_model <- segmented(model, npsi = 2)\n```\n\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Poisson and segmented fit\"}\nfitted_df <- nested_df %>% \n  mutate(fit = map(data, function(.data) {\n    glm(\n      count ~ year + offset(log(population)),\n      family = poisson(link = \"log\"),\n      data = .data\n    )\n  })) %>% \n  mutate(sgmt_fit = map2(data, fit, function(.data, .fit) {\n    out <- segmented(.fit, seg.Z = ~year, data = .data, npsi = 2)\n    if (!(\"segmented\" %in% class(out))) {\n      out <- segmented(.fit, seg.Z = ~year, data = .data, npsi = 1)\n    }\n    return(out)\n  }))\n\nhead(fitted_df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 6 × 6\n  sex   type      country data                 fit    sgmt_fit  \n  <chr> <chr>     <chr>   <list>               <list> <list>    \n1 Male  Incidence Denmark <tidytable [41 × 7]> <glm>  <segmentd>\n2 Male  Incidence Finland <tidytable [41 × 7]> <glm>  <segmentd>\n3 Male  Incidence Iceland <tidytable [41 × 7]> <glm>  <segmentd>\n4 Male  Incidence Norway  <tidytable [41 × 7]> <glm>  <segmentd>\n5 Male  Incidence Sweden  <tidytable [41 × 7]> <glm>  <segmentd>\n6 Male  Mortality Denmark <tidytable [41 × 7]> <glm>  <segmentd>\n```\n:::\n:::\n\n\nFollowing plots highlighting Norway and Finland for comparison show a higher melanoma incidence and mortality rate in Norway compared to Finland. A plateau was observed in melanoma incidence in Norway in both male and female.  \n\n::: panel-tabset\n\n### Crude rate\n\n\n::: {.cell fig.asp='0.9'}\n\n```{.r .cell-code  code-summary=\"Crude rate plot\"}\ncols <- RColorBrewer::brewer.pal(fitted_df[, n_distinct(country)], \"Set1\") \nnames(cols) <- fitted_df[, unique(country)]\n\nrate_df %>% \n  filter(country != \"Iceland\") %>% \n  ggplot(aes(year, crude_rate, group = country)) +\n  facet_grid(\n    cols = vars(sex),\n    rows = vars(type),\n    scales = \"free_y\"\n  ) +\n  geom_line(color = \"lightgrey\") +\n  geom_point(\n    fill = \"whitesmoke\", \n    shape = 21, \n    color = \"lightgrey\",\n    stroke = 1,\n    size = 1\n  ) +\n  geom_line(\n    data = ~subset(.x, country %in% c(\"Finland\", \"Norway\")),\n    aes(color = country)\n  ) +\n  ggthemes::theme_few(base_size = 14) +\n  theme(\n    legend.position = \"bottom\",\n    legend.justification = \"left\",\n    panel.grid = element_line(color = \"#f0f0f0\")\n  ) +\n  scale_color_manual(breaks = names(cols), values = cols) +\n  labs(\n    x = \"Year of diagnosis\",\n    y = \"Crude rate per 100,000 person-years\",\n    color = \"Country\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n### Poisson fit\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Fitted values from the model\"}\nfitted_df <- fitted_df %>% \n  mutate(\n    fit_df = map(\n      fit, \n      function(.fit) {\n        new_data <- crossing(year = 1980:2020, population = 1e5)\n        tidytable(\n          year = new_data[, year],\n          .fitted = predict(.fit, newdata = new_data, type = \"response\")\n        )\n      }),\n    sgmt_fit_df = map(\n      sgmt_fit, function(.fit) {\n        new_data <- crossing(year = 1980:2020, population = 1e5)\n        pred_df <- predict(\n          .fit, newdata = new_data,\n          type = \"link\", interval = \"confidence\"\n        ) %>% exp() %>% apply(1:2, prod, 1e5) %>% \n        as_tidytable() %>% \n        rename_with(~c(\".fitted\", \".lower\", \".upper\"))\n        bind_cols(year = new_data[, year], pred_df)\n      })\n  )\n```\n:::\n\n::: {.cell fig.asp='0.9'}\n\n```{.r .cell-code  code-summary=\"Crude rate with poisson fit\"}\nfit_df <- fitted_df %>%\n  unnest(fit_df) %>%\n  filter(country != \"Iceland\")\n\nplot_poisson <- function(rate_df, fit_df, countries = NULL) {\n  if (is.null(countries)) {\n    countries <- rate_df[, country]\n  }\n  rate_df %>%\n    filter(country != \"Iceland\") %>%\n    ggplot(aes(year, crude_rate, group = country)) +\n    facet_grid(\n      cols = vars(sex),\n      rows = vars(type),\n      scales = \"free_y\"\n    ) +\n    geom_line(color = \"lightgrey\") +\n    geom_point(\n      fill = \"whitesmoke\",\n      shape = 21,\n      color = \"lightgrey\",\n      stroke = 1,\n      size = 1\n    ) +\n    geom_line(\n      data = ~ subset(fit_df, country %in% countries),\n      aes(color = country, y = .fitted),\n    ) +\n    ggthemes::theme_few(base_size = 14) +\n    theme(\n      legend.position = \"bottom\",\n      legend.justification = \"left\",\n      panel.grid = element_line(color = \"#f0f0f0\")\n    ) +\n    scale_color_manual(breaks = names(cols), values = cols) +\n    labs(\n      x = \"Year of diagnosis\",\n      y = \"Crude rate per 100,000 person-years\",\n      color = \"Country\"\n    )\n}\nplot_poisson(rate_df, fit_df, c(\"Finland\", \"Norway\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n### Segmented fit\n\n\n::: {.cell fig.asp='0.9'}\n\n```{.r .cell-code  code-summary=\"Crude rate with poisson fit\"}\nplot_segmented <- function(rate_df, fit_df, countries = NULL, show_poisson = T) {\n  sgmt_fit_df <- fitted_df %>% \n    filter(country != \"Iceland\") %>% \n    unnest(sgmt_fit_df)\n\n  if (is.null(countries)) {\n    countries <- rate_df[, unique(country)]\n  } else {\n    sgmt_fit_df <- sgmt_fit_df %>% filter(country %in% countries)\n  }\n\n  plt <- rate_df %>% \n    filter(country != \"Iceland\") %>% \n    ggplot(aes(year, crude_rate, group = country)) +\n    facet_grid(\n      cols = vars(sex),\n      rows = vars(type),\n      scales = \"free_y\"\n    ) +\n    geom_line(color = \"lightgrey\") +\n    geom_point(\n      fill = \"whitesmoke\", \n      shape = 21, \n      color = \"lightgrey\",\n      stroke = 1,\n      size = 1\n    ) +\n    geom_line(\n      data = ~subset(sgmt_fit_df, country %in% countries),\n      aes(color = country, y = .fitted),\n      linetype = if (show_poisson) \"dashed\" else \"solid\"\n    ) +\n    ggthemes::theme_few(base_size = 14) +\n    theme(\n      legend.position = \"bottom\",\n      legend.justification = \"left\",\n      panel.grid = element_line(color = \"#f0f0f0\")\n    ) +\n    scale_color_manual(breaks = names(cols), values = cols) +\n    labs(\n      x = \"Year of diagnosis\",\n      y = \"Crude rate per 100,000 person-years\",\n      color = \"Country\"\n    )\n\n    if (show_poisson) {\n      plt <- plt +\n        geom_line(\n          data = ~subset(fit_df, country %in% countries),\n          aes(color = country, y = .fitted),\n          alpha = 0.5\n        )\n    }\n    return(plt)\n}\nplot_segmented(rate_df, fit_df, c(\"Norway\", \"Finland\"))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n### All countries\n\n::: panel-tabset\n\n### Poisson fit\n\n\n::: {.cell fig.asp='0.9'}\n\n```{.r .cell-code  code-summary=\"Crude rate with poisson fit for all countries\"}\nplot_poisson(rate_df, fit_df)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n### Segmented fit\n\n\n::: {.cell fig.asp='0.9'}\n\n```{.r .cell-code  code-summary=\"Crude rate with poisson fit for all countries\"}\nplot_segmented(rate_df, fit_df, show_poisson = FALSE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n![](Plots/Sgmt-all.svg)\n\n:::\n\n:::\n\nHere, Norway leads with the highest rates of melanoma incidence and mortality, while Finland shines with the lowest rates across both sexes. Recently, Denmark has surged ahead of Norway and Sweden in terms of melanoma incidence.\n\nInterestingly, Norway had a plateau in melanoma cases for a while, but most Nordic countries saw a rise in melanoma cases after 2005. The silver lining here is that all countries have experienced a drop in melanoma mortality in recent years, thanks to better detection, treatments, and awareness.\n\n### Annual percentge change (APC)\n\n::: panel-tabset\n#### Plot\n\n\n::: {.cell fig.asp='0.5'}\n\n```{.r .cell-code}\ntidy_fit <- fitted_df %>% \n  transmute(tidy_fit = map(fit, function(.fit) {\n    broom::tidy(.fit, exponentiate = TRUE, conf.int = TRUE) %>% \n      filter(term == \"year\", country != \"Iceland\")\n  }), .by = c(sex, type, country)) %>% \n  unnest()\n\ntidy_fit %>% \n  mutate(country = factor(country, c(\n    \"Finland\", \"Denmark\",\n    \"Sweden\", \"Norway\"\n  ))) %>% \n  ggplot(aes(x = estimate, y = country, color = sex)) +\n  facet_grid(cols = vars(type)) +\n  geom_pointrange(\n    aes(xmin = conf.low, xmax = conf.high),\n    shape = 21,\n    fill = \"whitesmoke\",\n    position = position_dodge(width = 0.5)\n  ) +\n  geom_vline(xintercept = 1, linetype = 2, color = \"grey\") +\n  scale_color_brewer(palette = \"Set1\") +\n  expand_limits(x = 1) +\n  ggthemes::theme_few(base_size = 16) +\n  theme(\n    panel.grid = element_line(color = \"#f0f0f0\"),\n    legend.position = \"bottom\",\n    legend.justification = \"left\"\n  ) +\n  labs(\n    x = \"Percentage change in count\",\n    y = NULL\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n#### Table\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Calculating annual percentage change\"}\naapc_df <- fitted_df %>% \n  transmute(\n    aapc = map(sgmt_fit, function(.fit) {\n      aapc(.fit) %>% \n        t() %>% \n        as_tidytable() %>% \n        rename_with(\n          ~c(\"estimate\", \"std_err\", \"lower\", \"upper\")\n        ) %>% \n        mutate(psi = \"1980--2020\") %>% \n        mutate(\n          label = glue::glue(\n            \"{estimate} ({lower}, {upper})\",\n            .transformer = \\(d, e) round(get(d, e), 2)\n          )\n        )\n    }),\n    apc = map(sgmt_fit, function(fit) {\n      if (!\"segmented\" %in% class(fit)) return(NULL)\n      out <- slope(fit, APC = TRUE)[[1]] %>% \n        as_tidytable(.keep_rownames = \"segment\")\n      psi_start <- unname(c(1980, fit$psi[, \"Est.\"], 2020))\n      psi_end <- lead(psi_start, 1)\n      psi_range <- glue::glue(\n        \"{psi_start}--{psi_end}\",\n        .transformer = \\(d, e) round(get(d, e))\n      )\n      psi_range <- setdiff(psi_range, last(psi_range))\n      out %>% \n        mutate(psi = psi_range) %>% \n        rename_with(\n          .fn = ~c(\"estimate\", \"lower\", \"upper\"), \n          .cols = 2:4\n        ) %>% \n        mutate(label = glue::glue(\n          \"{estimate} ({lower}, {upper})\",\n          .transformer = \\(d, e) round(get(d, e), 2)\n        )) %>% \n        mutate(label_period = glue::glue(\"{label}<br>{psi}\")) %>% \n        mutate(segment = gsub(\"slope\", \"\", segment))\n    }),\n    .by = c(sex, type, country)\n  )\n\napc <- aapc_df %>% unnest(\"apc\")\naapc <- aapc_df %>% unnest(\"aapc\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Table data for APC\"}\napc %>% \n  filter(country %in% c(\"Norway\", \"Denmark\")) %>% \n  pivot_wider(\n    id_cols = c(country, segment),\n    names_from = c(type, sex),\n    values_from = \"label_period\"\n  ) %>% \n  gt::gt(\n    id = \"apc-table\",\n    rowname_col = \"segment\",\n    groupname_col = \"country\"\n  ) %>% \n  gt::tab_spanner_delim(\"_\") %>% \n  gt::fmt_markdown(everything()) %>% \n  gt::sub_missing(everything(), missing_text = \"-\") %>%\n  gt::tab_stubhead(\"Segment\") %>% \n  gt::tab_options(\n    table.width = \"100%\",\n    column_labels.font.weight = \"bold\",\n    row_group.font.weight = \"bold\"\n  )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"apc-table\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#apc-table table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#apc-table thead, #apc-table tbody, #apc-table tfoot, #apc-table tr, #apc-table td, #apc-table th {\n  border-style: none;\n}\n\n#apc-table p {\n  margin: 0;\n  padding: 0;\n}\n\n#apc-table .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 100%;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#apc-table .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#apc-table .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#apc-table .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#apc-table .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#apc-table .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#apc-table .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#apc-table .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#apc-table .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#apc-table .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#apc-table .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#apc-table .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#apc-table .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#apc-table .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#apc-table .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: bold;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#apc-table .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#apc-table .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#apc-table .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#apc-table .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#apc-table .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#apc-table .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#apc-table .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#apc-table .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#apc-table .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#apc-table .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#apc-table .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#apc-table .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#apc-table .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#apc-table .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#apc-table .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#apc-table .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#apc-table .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#apc-table .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#apc-table .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#apc-table .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#apc-table .gt_left {\n  text-align: left;\n}\n\n#apc-table .gt_center {\n  text-align: center;\n}\n\n#apc-table .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#apc-table .gt_font_normal {\n  font-weight: normal;\n}\n\n#apc-table .gt_font_bold {\n  font-weight: bold;\n}\n\n#apc-table .gt_font_italic {\n  font-style: italic;\n}\n\n#apc-table .gt_super {\n  font-size: 65%;\n}\n\n#apc-table .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#apc-table .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#apc-table .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#apc-table .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#apc-table .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#apc-table .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#apc-table .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#apc-table .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#apc-table div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"a::stub\">Segment</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"spanner-Incidence_Male\">\n        <div class=\"gt_column_spanner\">Incidence</div>\n      </th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"spanner-Mortality_Male\">\n        <div class=\"gt_column_spanner\">Mortality</div>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Incidence_Male\">Male</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Incidence_Female\">Female</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mortality_Male\">Male</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Mortality_Female\">Female</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"5\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Denmark\">Denmark</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_right gt_stub\"><span data-qmd-base64=\"MQ==\"><span class='gt_from_md'>1</span></span></th>\n<td headers=\"Denmark stub_1_1 Incidence_Male\" class=\"gt_row gt_center\"><span data-qmd-base64=\"My41NCAoMy4yMywgMy44NSk8YnI+MTk4MOKAkzIwMDQ=\"><span class='gt_from_md'>3.54 (3.23, 3.85)<br>1980–2004</span></span></td>\n<td headers=\"Denmark stub_1_1 Incidence_Female\" class=\"gt_row gt_center\"><span data-qmd-base64=\"Mi43MyAoMi40LCAzLjA2KTxicj4xOTgw4oCTMjAwMg==\"><span class='gt_from_md'>2.73 (2.4, 3.06)<br>1980–2002</span></span></td>\n<td headers=\"Denmark stub_1_1 Mortality_Male\" class=\"gt_row gt_center\"><span data-qmd-base64=\"MC42MyAoMC4xLCAxLjE3KTxicj4xOTgw4oCTMjAwNA==\"><span class='gt_from_md'>0.63 (0.1, 1.17)<br>1980–2004</span></span></td>\n<td headers=\"Denmark stub_1_1 Mortality_Female\" class=\"gt_row gt_center\"><span data-qmd-base64=\"MC41MSAoMC4xMiwgMC45MSk8YnI+MTk4MOKAkzIwMTE=\"><span class='gt_from_md'>0.51 (0.12, 0.91)<br>1980–2011</span></span></td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_right gt_stub\"><span data-qmd-base64=\"Mg==\"><span class='gt_from_md'>2</span></span></th>\n<td headers=\"Denmark stub_1_2 Incidence_Male\" class=\"gt_row gt_center\"><span data-qmd-base64=\"OS44ICg3LjMyLCAxMi4zMyk8YnI+MjAwNOKAkzIwMDk=\"><span class='gt_from_md'>9.8 (7.32, 12.33)<br>2004–2009</span></span></td>\n<td headers=\"Denmark stub_1_2 Incidence_Female\" class=\"gt_row gt_center\"><span data-qmd-base64=\"Ni45MiAoNS45NiwgNy44OCk8YnI+MjAwMuKAkzIwMTE=\"><span class='gt_from_md'>6.92 (5.96, 7.88)<br>2002–2011</span></span></td>\n<td headers=\"Denmark stub_1_2 Mortality_Male\" class=\"gt_row gt_center\"><span data-qmd-base64=\"NC4xICgwLjkzLCA3LjM3KTxicj4yMDA04oCTMjAxMg==\"><span class='gt_from_md'>4.1 (0.93, 7.37)<br>2004–2012</span></span></td>\n<td headers=\"Denmark stub_1_2 Mortality_Female\" class=\"gt_row gt_center\"><span data-qmd-base64=\"MTIuMDkgKC0xMi4yMywgNDMuMTQpPGJyPjIwMTHigJMyMDEz\"><span class='gt_from_md'>12.09 (-12.23, 43.14)<br>2011–2013</span></span></td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_right gt_stub\"><span data-qmd-base64=\"Mw==\"><span class='gt_from_md'>3</span></span></th>\n<td headers=\"Denmark stub_1_3 Incidence_Male\" class=\"gt_row gt_center\"><span data-qmd-base64=\"My4xICgyLjUzLCAzLjY4KTxicj4yMDA54oCTMjAyMA==\"><span class='gt_from_md'>3.1 (2.53, 3.68)<br>2009–2020</span></span></td>\n<td headers=\"Denmark stub_1_3 Incidence_Female\" class=\"gt_row gt_center\"><span data-qmd-base64=\"MS43OSAoMS4xOCwgMi40MSk8YnI+MjAxMeKAkzIwMjA=\"><span class='gt_from_md'>1.79 (1.18, 2.41)<br>2011–2020</span></span></td>\n<td headers=\"Denmark stub_1_3 Mortality_Male\" class=\"gt_row gt_center\"><span data-qmd-base64=\"LTIuMTUgKC00LjA4LCAtMC4xOSk8YnI+MjAxMuKAkzIwMjA=\"><span class='gt_from_md'>-2.15 (-4.08, -0.19)<br>2012–2020</span></span></td>\n<td headers=\"Denmark stub_1_3 Mortality_Female\" class=\"gt_row gt_center\"><span data-qmd-base64=\"LTQuMDggKC03LjM1LCAtMC42OSk8YnI+MjAxM+KAkzIwMjA=\"><span class='gt_from_md'>-4.08 (-7.35, -0.69)<br>2013–2020</span></span></td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"5\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Norway\">Norway</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_4\" scope=\"row\" class=\"gt_row gt_right gt_stub\"><span data-qmd-base64=\"MQ==\"><span class='gt_from_md'>1</span></span></th>\n<td headers=\"Norway stub_1_4 Incidence_Male\" class=\"gt_row gt_center\"><span data-qmd-base64=\"NS40OSAoNC4zMiwgNi42Nyk8YnI+MTk4MOKAkzE5OTE=\"><span class='gt_from_md'>5.49 (4.32, 6.67)<br>1980–1991</span></span></td>\n<td headers=\"Norway stub_1_4 Incidence_Female\" class=\"gt_row gt_center\"><span data-qmd-base64=\"My44NyAoMi42NywgNS4wOSk8YnI+MTk4MOKAkzE5OTA=\"><span class='gt_from_md'>3.87 (2.67, 5.09)<br>1980–1990</span></span></td>\n<td headers=\"Norway stub_1_4 Mortality_Male\" class=\"gt_row gt_center\"><span data-qmd-base64=\"MTcuMTIgKC0wLjMyLCAzNy42MSk8YnI+MTk4MOKAkzE5ODI=\"><span class='gt_from_md'>17.12 (-0.32, 37.61)<br>1980–1982</span></span></td>\n<td headers=\"Norway stub_1_4 Mortality_Female\" class=\"gt_row gt_center\"><span data-qmd-base64=\"MS4wMiAoMC4xOSwgMS44NSk8YnI+MTk4MOKAkzIwMDA=\"><span class='gt_from_md'>1.02 (0.19, 1.85)<br>1980–2000</span></span></td></tr>\n    <tr><th id=\"stub_1_5\" scope=\"row\" class=\"gt_row gt_right gt_stub\"><span data-qmd-base64=\"Mg==\"><span class='gt_from_md'>2</span></span></th>\n<td headers=\"Norway stub_1_5 Incidence_Male\" class=\"gt_row gt_center\"><span data-qmd-base64=\"MC40NSAoLTAuNDQsIDEuMzUpPGJyPjE5OTHigJMyMDAy\"><span class='gt_from_md'>0.45 (-0.44, 1.35)<br>1991–2002</span></span></td>\n<td headers=\"Norway stub_1_5 Incidence_Female\" class=\"gt_row gt_center\"><span data-qmd-base64=\"MC4xNyAoLTAuNjksIDEuMDQpPGJyPjE5OTDigJMyMDAw\"><span class='gt_from_md'>0.17 (-0.69, 1.04)<br>1990–2000</span></span></td>\n<td headers=\"Norway stub_1_5 Mortality_Male\" class=\"gt_row gt_center\"><span data-qmd-base64=\"MS43OCAoMS4zOSwgMi4xOCk8YnI+MTk4MuKAkzIwMTE=\"><span class='gt_from_md'>1.78 (1.39, 2.18)<br>1982–2011</span></span></td>\n<td headers=\"Norway stub_1_5 Mortality_Female\" class=\"gt_row gt_center\"><span data-qmd-base64=\"Mi42NCAoMS4yNSwgNC4wNSk8YnI+MjAwMOKAkzIwMTM=\"><span class='gt_from_md'>2.64 (1.25, 4.05)<br>2000–2013</span></span></td></tr>\n    <tr><th id=\"stub_1_6\" scope=\"row\" class=\"gt_row gt_right gt_stub\"><span data-qmd-base64=\"Mw==\"><span class='gt_from_md'>3</span></span></th>\n<td headers=\"Norway stub_1_6 Incidence_Male\" class=\"gt_row gt_center\"><span data-qmd-base64=\"NC4zOSAoNC4wOCwgNC42OSk8YnI+MjAwMuKAkzIwMjA=\"><span class='gt_from_md'>4.39 (4.08, 4.69)<br>2002–2020</span></span></td>\n<td headers=\"Norway stub_1_6 Incidence_Female\" class=\"gt_row gt_center\"><span data-qmd-base64=\"My42NyAoMy4zOSwgMy45NSk8YnI+MjAwMOKAkzIwMjA=\"><span class='gt_from_md'>3.67 (3.39, 3.95)<br>2000–2020</span></span></td>\n<td headers=\"Norway stub_1_6 Mortality_Male\" class=\"gt_row gt_center\"><span data-qmd-base64=\"LTIuMDUgKC0zLjg3LCAtMC4yKTxicj4yMDEx4oCTMjAyMA==\"><span class='gt_from_md'>-2.05 (-3.87, -0.2)<br>2011–2020</span></span></td>\n<td headers=\"Norway stub_1_6 Mortality_Female\" class=\"gt_row gt_center\"><span data-qmd-base64=\"LTUuMjggKC04LjQxLCAtMi4wNSk8YnI+MjAxM+KAkzIwMjA=\"><span class='gt_from_md'>-5.28 (-8.41, -2.05)<br>2013–2020</span></span></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n:::\n\n### Comparing countries\n\n::: panel-tabset\n\n#### Incidence\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nmdl_inc <- glm(\n  data = rate_df,\n  formula = count ~ year + sex + country,\n  offset = log(population),\n  family = poisson(link = \"log\"),\n  subset = type == \"Incidence\"\n)\n\nbroom::tidy(mdl_inc, conf.int = TRUE, exponentiate = TRUE) %>% \n  mutate(across(c(2:4, 6:7), round, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 7 × 7\n  term           estimate std.error statistic   p.value conf.low conf.high\n  <chr>             <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 (Intercept)       0         0.383   -205.   0            0         0    \n2 year              1.04      0        185.   0            1.04      1.04 \n3 sexMale           1.01      0.004      1.90 5.68e-  2    1         1.02 \n4 countryFinland    0.649     0.007    -62.6  0            0.64      0.658\n5 countryIceland    0.494     0.028    -25.6  1.86e-144    0.468     0.521\n6 countryNorway     1.05      0.006      8.09 5.84e- 16    1.04      1.06 \n7 countrySweden     0.936     0.005    -12.1  1.41e- 33    0.926     0.946\n```\n:::\n:::\n\n\n\n#### Mortality\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nmdl_mor <- glm(\n  data = rate_df,\n  formula = count ~ year + sex + country,\n  offset = log(population),\n  family = poisson(link = \"log\"),\n  subset = type == \"Mortality\"\n)\n\nbroom::tidy(mdl_mor, conf.int = TRUE, exponentiate = TRUE) %>% \n  mutate(across(c(2:4, 6:7), round, 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tidytable: 7 × 7\n  term           estimate std.error statistic   p.value conf.low conf.high\n  <chr>             <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 (Intercept)       0         0.844    -40.9  0            0         0    \n2 year              1.01      0         29.2  1.53e-187    1.01      1.01 \n3 sexMale           1.46      0.01      38.0  0            1.43      1.49 \n4 countryFinland    0.731     0.016    -19.2  1.67e- 82    0.708     0.755\n5 countryIceland    0.611     0.061     -8.02 1.05e- 15    0.54      0.688\n6 countryNorway     1.24      0.015     14.6  3.57e- 48    1.20      1.27 \n7 countrySweden     1.03      0.013      2.2  2.78e-  2    1.00      1.06 \n```\n:::\n:::\n\n\n:::\n\n## Summary \n\nIn summary, melanoma trends across the Nordic countries reveal some concerning patterns. Incidence and mortality have been increasing in all countries, with Norway showing the highest mortality rate and the most substantial rise in both incidence and mortality. Denmark saw a particularly rapid increase in melanoma cases between 2002 and 2011 in women and between 2004 and 2009 in men, surpassing Norway during those periods.\n\nHowever, there is a silver lining: recent years have shown a decrease in melanoma mortality rates across all the Nordic countries. This positive trend suggests that advancements in medical treatments, early detection efforts, and greater public awareness are starting to make a difference. While the rise in incidence remains a challenge, the declining mortality rates provide a hopeful perspective moving forward.\n\n## References\n\n::: {#refs}\n:::\n",
    "supporting": [
      "index_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}