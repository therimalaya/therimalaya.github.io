<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Mathatistics</title>
<link>https://mathatistics.com/blog.html</link>
<atom:link href="https://mathatistics.com/blog.xml" rel="self" type="application/rss+xml"/>
<description>My personal blog where I share my experiences and my learning journey.</description>
<generator>quarto-1.2.335</generator>
<lastBuildDate>Mon, 19 Jun 2023 22:00:00 GMT</lastBuildDate>
<item>
  <title>Melanoma Incidence in Nordic Countries</title>
  <dc:creator>Raju Rimal</dc:creator>
  <link>https://mathatistics.com/blog/posts/nordic-melanoma/index.html</link>
  <description><![CDATA[ 



<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Cutaneous melanoma (CM) is the most aggressive and lethal form of skin cancer. Melanoma can be cured if caught and treated early but if left untreated, it may spread to other parts and can be fatal. In the recent years, melanoma has increased dramatically in fair skinned population worldwide including Nordic countries like Norway, Denmark, and Sweden. Norway is ranked fifth in incidence and third in mortality worldwide. This increase can be an effect of increased awareness in general public and health care provider.</p>
<p>This article explores <strong><em>melanoma incidence</em></strong> and <strong><em>mortality</em></strong> in nordic countries by <strong><em>sex</em></strong> and their <strong><em>trend</em></strong> over 40-years period from 1980–2020. Further, I try to step through the analysis process from data collection to create plots and tables.</p>
</section>
<section id="data-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation">Data Preparation</h2>
<p>Data on melanoma were obtained from NORDCAN <span class="citation" data-cites="nordcan-2023">Engholm et al. (2010)</span>, Association of the Nordic Cancer Registries, IARC. Using NORDCAN 2.0 API<sup>1</sup> crude and age-adjusted rates were downloaded as JSON and converted to tabular data for further analysis. R<span class="citation" data-cites="r_core_team_r_2020">(R Core Team 2020)</span> software was used for data gathering, cleanup, analysis, and plotting.</p>
<p>The API endpoint has four placeholder <code>type</code>, <code>sex</code>, <code>country</code>, and <code>cancer</code> following design was used to create individual endpoint. These individual url are used to download the JSON file as list in R.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Data API</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Sample JSON</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" aria-controls="tabset-1-3" aria-selected="false">Data download</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" aria-controls="tabset-1-4" aria-selected="false">Data Preparation</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="data-api tab-pane active" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code for preparing download URL</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">design_map <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">list</span>(</span>
<span id="cb1-2">  <span class="at" style="color: #657422;">sex =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="at" style="color: #657422;">Male =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">Female =</span> <span class="dv" style="color: #AD0000;">2</span>),</span>
<span id="cb1-3">  <span class="at" style="color: #657422;">type =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="at" style="color: #657422;">Incidence =</span> <span class="dv" style="color: #AD0000;">0</span>, <span class="at" style="color: #657422;">Mortality =</span> <span class="dv" style="color: #AD0000;">1</span>),</span>
<span id="cb1-4">  <span class="at" style="color: #657422;">cancer =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="at" style="color: #657422;">Melanoma =</span> <span class="dv" style="color: #AD0000;">290</span>),</span>
<span id="cb1-5">  <span class="at" style="color: #657422;">country =</span> <span class="fu" style="color: #4758AB;">c</span>(</span>
<span id="cb1-6">    <span class="at" style="color: #657422;">Denmark =</span> <span class="dv" style="color: #AD0000;">208</span>, <span class="at" style="color: #657422;">Finland =</span> <span class="dv" style="color: #AD0000;">246</span>, <span class="at" style="color: #657422;">Iceland =</span> <span class="dv" style="color: #AD0000;">352</span>,</span>
<span id="cb1-7">    <span class="at" style="color: #657422;">Norway =</span> <span class="dv" style="color: #AD0000;">578</span>, <span class="at" style="color: #657422;">Sweden =</span> <span class="dv" style="color: #AD0000;">752</span></span>
<span id="cb1-8">  )</span>
<span id="cb1-9">)</span>
<span id="cb1-10">label_values <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(data, label_map, var) {</span>
<span id="cb1-11">  label_vec <span class="ot" style="color: #003B4F;">&lt;-</span> label_map[[var]]</span>
<span id="cb1-12">  label <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="st" style="color: #20794D;">`</span><span class="at" style="color: #657422;">names&lt;-</span><span class="st" style="color: #20794D;">`</span>(<span class="fu" style="color: #4758AB;">names</span>(label_vec), label_vec)</span>
<span id="cb1-13">  data[[var]] <span class="ot" style="color: #003B4F;">&lt;-</span> data[, label[<span class="fu" style="color: #4758AB;">as.character</span>(<span class="fu" style="color: #4758AB;">get</span>(var))]]</span>
<span id="cb1-14">  <span class="fu" style="color: #4758AB;">return</span>(data)</span>
<span id="cb1-15">}</span>
<span id="cb1-16"></span>
<span id="cb1-17">design <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">CJ</span>(</span>
<span id="cb1-18">  <span class="at" style="color: #657422;">sex =</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">2</span>,</span>
<span id="cb1-19">  <span class="at" style="color: #657422;">type =</span> <span class="dv" style="color: #AD0000;">0</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">1</span>,</span>
<span id="cb1-20">  <span class="at" style="color: #657422;">cancer =</span> <span class="dv" style="color: #AD0000;">290</span>,</span>
<span id="cb1-21">  <span class="at" style="color: #657422;">country =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">208</span>, <span class="dv" style="color: #AD0000;">246</span>, <span class="dv" style="color: #AD0000;">352</span>, <span class="dv" style="color: #AD0000;">578</span>, <span class="dv" style="color: #AD0000;">752</span>)</span>
<span id="cb1-22">)</span>
<span id="cb1-23">design[, url <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> glue<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">glue_data</span>(.SD, </span>
<span id="cb1-24">  <span class="st" style="color: #20794D;">"https://gco.iarc.fr/gateway_prod/api/nordcan/v2/92/data/population/{type}/{sex}/({country})/({cancer})/?ages_group=5_17&amp;year_start=1980&amp;year_end=2020&amp;year_grouped=0"</span></span>
<span id="cb1-25">)]</span>
<span id="cb1-26">design <span class="ot" style="color: #003B4F;">&lt;-</span> design <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-27">  <span class="fu" style="color: #4758AB;">label_values</span>(design_map, <span class="st" style="color: #20794D;">"sex"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-28">  <span class="fu" style="color: #4758AB;">label_values</span>(design_map, <span class="st" style="color: #20794D;">"type"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-29">  <span class="fu" style="color: #4758AB;">label_values</span>(design_map, <span class="st" style="color: #20794D;">"cancer"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb1-30">  <span class="fu" style="color: #4758AB;">label_values</span>(design_map, <span class="st" style="color: #20794D;">"country"</span>)</span></code></pre></div>
</details>
</div>
<dl>
<dt>API URL:</dt>
<dd>
<code>https://gco.iarc.fr/gateway_prod/api/nordcan/v2/92/data/population/{type}/{sex}/({country})/({cancer})/?ages_group=5_17&amp;year_start=1980&amp;year_end=2020&amp;year_grouped=0</code>
</dd>
</dl>
<p>Replacing the placeholders <code>type</code> (Incidence: 0, Mortality: 1), <code>sex</code> (Male: 1, Female: 2), <code>country</code> (Denmark: 208, Finland: 246, Iceland: 352, Norway: 578, and Sweden: 752), and <code>cancer</code> (Melanoma: 290) prepare the data API.</p>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" data-startfrom="123" data-source-offset="-0" style="background: #f1f3f5;"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 122;"><span id="cb2-123">json_data <span class="op" style="color: #5E5E5E;">=</span> <span class="cf" style="color: #003B4F;">await</span> <span class="fu" style="color: #4758AB;">FileAttachment</span>(<span class="st" style="color: #20794D;">"Data/nordcan.json"</span>)<span class="op" style="color: #5E5E5E;">.</span><span class="fu" style="color: #4758AB;">json</span>()</span>
<span id="cb2-124">json_data[<span class="dv" style="color: #AD0000;">0</span>]</span></code></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-1" data-nodetype="declaration">

</div>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<div id="ojs-cell-1-2" data-nodetype="expression">

</div>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<details>
<summary>Code for data download</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="cf" style="color: #003B4F;">if</span> (<span class="sc" style="color: #5E5E5E;">!</span><span class="fu" style="color: #4758AB;">file.exists</span>(<span class="st" style="color: #20794D;">"Data/nordcan-json.Rds"</span>)) {</span>
<span id="cb3-2">  design[, data <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="fu" style="color: #4758AB;">map</span>(url, <span class="sc" style="color: #5E5E5E;">~</span><span class="fu" style="color: #4758AB;">read_json</span>(.x) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> <span class="fu" style="color: #4758AB;">pluck</span>(<span class="st" style="color: #20794D;">"dataset"</span>))]</span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;">saveRDS</span>(design, <span class="at" style="color: #657422;">file =</span> <span class="st" style="color: #20794D;">"Data/nordcan-json.Rds"</span>)</span>
<span id="cb3-4">} <span class="cf" style="color: #003B4F;">else</span> {</span>
<span id="cb3-5">  design <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">readRDS</span>(<span class="st" style="color: #20794D;">"Data/nordcan-json.Rds"</span>)</span>
<span id="cb3-6">}</span>
<span id="cb3-7">design[, .(sex, type, country, data)]</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       sex      type country       data
 1:   Male Incidence Denmark &lt;list[41]&gt;
 2:   Male Incidence Finland &lt;list[41]&gt;
 3:   Male Incidence Iceland &lt;list[41]&gt;
 4:   Male Incidence  Norway &lt;list[41]&gt;
 5:   Male Incidence  Sweden &lt;list[41]&gt;
 6:   Male Mortality Denmark &lt;list[41]&gt;
 7:   Male Mortality Finland &lt;list[41]&gt;
 8:   Male Mortality Iceland &lt;list[41]&gt;
 9:   Male Mortality  Norway &lt;list[41]&gt;
10:   Male Mortality  Sweden &lt;list[41]&gt;
11: Female Incidence Denmark &lt;list[41]&gt;
12: Female Incidence Finland &lt;list[41]&gt;
13: Female Incidence Iceland &lt;list[41]&gt;
14: Female Incidence  Norway &lt;list[41]&gt;
15: Female Incidence  Sweden &lt;list[41]&gt;
16: Female Mortality Denmark &lt;list[41]&gt;
17: Female Mortality Finland &lt;list[41]&gt;
18: Female Mortality Iceland &lt;list[41]&gt;
19: Female Mortality  Norway &lt;list[41]&gt;
20: Female Mortality  Sweden &lt;list[41]&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<details>
<summary>Rate data frame</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">rate_df <span class="ot" style="color: #003B4F;">&lt;-</span> design[, <span class="fu" style="color: #4758AB;">map_df</span>(data, <span class="cf" style="color: #003B4F;">function</span>(dta) {</span>
<span id="cb5-2">  out <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">data.table</span>(</span>
<span id="cb5-3">    <span class="at" style="color: #657422;">year =</span> <span class="fu" style="color: #4758AB;">map_int</span>(dta, <span class="st" style="color: #20794D;">"year"</span>),</span>
<span id="cb5-4">    <span class="at" style="color: #657422;">asr_w =</span> <span class="fu" style="color: #4758AB;">map_dbl</span>(dta, <span class="st" style="color: #20794D;">"asr"</span>),</span>
<span id="cb5-5">    <span class="at" style="color: #657422;">asr_e =</span> <span class="fu" style="color: #4758AB;">map_dbl</span>(dta, <span class="st" style="color: #20794D;">"asr_e"</span>),</span>
<span id="cb5-6">    <span class="at" style="color: #657422;">asr_n =</span> <span class="fu" style="color: #4758AB;">map_dbl</span>(dta, <span class="st" style="color: #20794D;">"asr_n"</span>),</span>
<span id="cb5-7">    <span class="at" style="color: #657422;">crude_rate =</span> <span class="fu" style="color: #4758AB;">map_dbl</span>(dta, <span class="st" style="color: #20794D;">"crude_rate"</span>),</span>
<span id="cb5-8">    <span class="at" style="color: #657422;">count =</span> <span class="fu" style="color: #4758AB;">map_dbl</span>(dta, <span class="st" style="color: #20794D;">"total"</span>),</span>
<span id="cb5-9">    <span class="at" style="color: #657422;">population =</span> <span class="fu" style="color: #4758AB;">map_dbl</span>(dta, <span class="st" style="color: #20794D;">"total_pop"</span>),</span>
<span id="cb5-10">    <span class="at" style="color: #657422;">cum_risk =</span> <span class="fu" style="color: #4758AB;">map</span>(dta, <span class="st" style="color: #20794D;">"cum_risk"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb5-11">      <span class="fu" style="color: #4758AB;">unlist</span>()</span>
<span id="cb5-12">  )</span>
<span id="cb5-13">  <span class="cf" style="color: #003B4F;">if</span> (<span class="st" style="color: #20794D;">"cum_risk"</span> <span class="sc" style="color: #5E5E5E;">%in%</span> <span class="fu" style="color: #4758AB;">names</span>(out)) {</span>
<span id="cb5-14">    out[, cum_risk <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="fu" style="color: #4758AB;">as.numeric</span>(cum_risk)]</span>
<span id="cb5-15">  }</span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;">return</span>(out)</span>
<span id="cb5-17">}), by <span class="ot" style="color: #003B4F;">=</span> .(sex, type, country)]</span></code></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'data.table' and 'data.frame':  820 obs. of  10 variables:
 $ sex       : chr  "Male" "Male" "Male" "Male" ...
 $ type      : chr  "Incidence" "Incidence" "Incidence" "Incidence" ...
 $ country   : chr  "Denmark" "Denmark" "Denmark" "Denmark" ...
 $ year      : int  1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 ...
 $ asr_w     : num  11.9 10.9 12.2 13.4 13.8 ...
 $ asr_e     : num  12.7 12.1 13.1 14.5 15.3 ...
 $ asr_n     : num  13.5 13.1 14.1 15.2 16 ...
 $ crude_rate: num  12.4 12 13.1 14.3 14.8 ...
 $ count     : num  196 191 210 230 239 234 269 283 291 306 ...
 $ population: num  1585436 1593815 1601416 1609960 1618038 ...
 - attr(*, ".internal.selfref")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Rate by age</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">rate_by_age <span class="ot" style="color: #003B4F;">&lt;-</span> design[, <span class="fu" style="color: #4758AB;">map_df</span>(data, <span class="cf" style="color: #003B4F;">function</span>(dta) {</span>
<span id="cb7-2">  year <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">map_int</span>(dta, <span class="st" style="color: #20794D;">"year"</span>)</span>
<span id="cb7-3">  count_df <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">map_df</span>(dta, <span class="st" style="color: #20794D;">"ages"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb7-4">    <span class="fu" style="color: #4758AB;">as.data.table</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb7-5">    <span class="fu" style="color: #4758AB;">cbind</span>(<span class="at" style="color: #657422;">year =</span> year) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb7-6">    <span class="fu" style="color: #4758AB;">melt.data.table</span>(</span>
<span id="cb7-7">      <span class="at" style="color: #657422;">id.vars =</span> <span class="st" style="color: #20794D;">"year"</span>,</span>
<span id="cb7-8">      <span class="at" style="color: #657422;">variable.name =</span> <span class="st" style="color: #20794D;">"age_group"</span>,</span>
<span id="cb7-9">      <span class="at" style="color: #657422;">value.name =</span> <span class="st" style="color: #20794D;">"count"</span></span>
<span id="cb7-10">    )</span>
<span id="cb7-11">  pop_df <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">map_df</span>(dta, <span class="st" style="color: #20794D;">"populations"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb7-12">    <span class="fu" style="color: #4758AB;">as.data.table</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb7-13">    <span class="fu" style="color: #4758AB;">cbind</span>(<span class="at" style="color: #657422;">year =</span> year) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb7-14">    <span class="fu" style="color: #4758AB;">melt.data.table</span>(</span>
<span id="cb7-15">      <span class="at" style="color: #657422;">id.vars =</span> <span class="st" style="color: #20794D;">"year"</span>,</span>
<span id="cb7-16">      <span class="at" style="color: #657422;">variable.name =</span> <span class="st" style="color: #20794D;">"age_group"</span>,</span>
<span id="cb7-17">      <span class="at" style="color: #657422;">value.name =</span> <span class="st" style="color: #20794D;">"population"</span></span>
<span id="cb7-18">    )</span>
<span id="cb7-19">  asr_df <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">map_df</span>(dta, <span class="st" style="color: #20794D;">"age_specific_rate"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb7-20">    <span class="fu" style="color: #4758AB;">modify</span>(as.numeric) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb7-21">    <span class="fu" style="color: #4758AB;">as.data.table</span>() <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb7-22">    <span class="fu" style="color: #4758AB;">cbind</span>(<span class="at" style="color: #657422;">year =</span> <span class="fu" style="color: #4758AB;">as.numeric</span>(year)) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb7-23">    <span class="fu" style="color: #4758AB;">melt.data.table</span>(</span>
<span id="cb7-24">      <span class="at" style="color: #657422;">id.vars =</span> <span class="st" style="color: #20794D;">"year"</span>,</span>
<span id="cb7-25">      <span class="at" style="color: #657422;">variable.name =</span> <span class="st" style="color: #20794D;">"age_group"</span>,</span>
<span id="cb7-26">      <span class="at" style="color: #657422;">value.name =</span> <span class="st" style="color: #20794D;">"asr"</span></span>
<span id="cb7-27">    )</span>
<span id="cb7-28">  out <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">reduce</span>(</span>
<span id="cb7-29">    <span class="fu" style="color: #4758AB;">list</span>(count_df, pop_df, asr_df),</span>
<span id="cb7-30">    merge.data.table,</span>
<span id="cb7-31">    <span class="at" style="color: #657422;">by =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"year"</span>, <span class="st" style="color: #20794D;">"age_group"</span>)</span>
<span id="cb7-32">  )</span>
<span id="cb7-33">  age_lbl <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">paste</span>(</span>
<span id="cb7-34">    <span class="fu" style="color: #4758AB;">seq</span>(<span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">85</span>, <span class="dv" style="color: #AD0000;">5</span>),</span>
<span id="cb7-35">    <span class="fu" style="color: #4758AB;">seq</span>(<span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">85</span>, <span class="dv" style="color: #AD0000;">5</span>) <span class="sc" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">4</span>,</span>
<span id="cb7-36">    <span class="at" style="color: #657422;">sep =</span> <span class="st" style="color: #20794D;">"-"</span></span>
<span id="cb7-37">  )</span>
<span id="cb7-38">  age_lbl[<span class="fu" style="color: #4758AB;">length</span>(age_lbl)] <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="st" style="color: #20794D;">"85+"</span></span>
<span id="cb7-39">  <span class="fu" style="color: #4758AB;">names</span>(age_lbl) <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">18</span></span>
<span id="cb7-40">  </span>
<span id="cb7-41">  out[, age_group <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> age_lbl[age_group]]</span>
<span id="cb7-42">  out[, year <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="fu" style="color: #4758AB;">as.integer</span>(year)]</span>
<span id="cb7-43">  out[, count <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="fu" style="color: #4758AB;">as.integer</span>(count)]</span>
<span id="cb7-44">  out[, population <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="fu" style="color: #4758AB;">as.integer</span>(population)]</span>
<span id="cb7-45">  out[, asr <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="fu" style="color: #4758AB;">as.numeric</span>(asr)]</span>
<span id="cb7-46">  <span class="fu" style="color: #4758AB;">return</span>(out[])</span>
<span id="cb7-47">}), by <span class="ot" style="color: #003B4F;">=</span> .(sex, type, country)]</span></code></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'data.table' and 'data.frame':  14760 obs. of  8 variables:
 $ sex       : chr  "Male" "Male" "Male" "Male" ...
 $ type      : chr  "Incidence" "Incidence" "Incidence" "Incidence" ...
 $ country   : chr  "Denmark" "Denmark" "Denmark" "Denmark" ...
 $ year      : int  1980 1980 1980 1980 1980 1980 1980 1980 1980 1980 ...
 $ age_group : chr  "0-4" "5-9" "10-14" "15-19" ...
 $ count     : int  0 1 1 1 2 8 12 16 13 23 ...
 $ population: int  164317 185710 203405 199741 190444 191785 215098 184439 149015 135409 ...
 $ asr       : num  0 0.538 0.492 0.501 1.05 ...
 - attr(*, ".internal.selfref")=&lt;externalptr&gt; </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<p>For the following analysis, crude rates were used in visualization and modelling. Stratified by <code>sex</code>, <code>country</code> and <code>type</code> following plots presents the the <code>crude_rate</code> over the <code>year</code> of diagnosis. Additionally, using <code>count</code> and <code>population</code>, a poisson regression model (Equation&nbsp;1) was fitted.</p>
<p><span id="eq-poisson-model-1"><img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Balign%7D%0A%5Clog%5Cleft(%5Cfrac%7B%5Clambda%7D%7BY%7D%5Cright)%20&amp;=%20%5Cbeta_0%20+%20%5Cbeta_1%20x%20+%20%5Cvarepsilon%20%5C%5C%0A%5Ctext%7Bequivalently,%20%7D%20%5Clog%5Cleft(%5Clambda%5Cright)%20&amp;=%20%5Cbeta_0%20+%20%5Cbeta_1%20x%20+%20%5Clog(Y)%20+%20%5Cvarepsilon%0A%5Cend%7Balign%7D%0A%5Ctag%7B1%7D"></span></p>
<p>where, <img src="https://latex.codecogs.com/png.latex?%5Clambda"> is the number of events (<code>count</code>), <img src="https://latex.codecogs.com/png.latex?Y"> is the number of exposed (<code>population</code>) and <img src="https://latex.codecogs.com/png.latex?x"> is the <code>year</code> of diagnosis.</p>
<p>Additionally, using segmented regression the change points in the trend was identified and the annual percentage change (APC) and average annual percentage change (AAPC) in crude rate were calculated. For each strata, following R-code for poisson regression model and segmented regression model were used.</p>
<div class="cell">
<details>
<summary>Data within each strata</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">nested_df <span class="ot" style="color: #003B4F;">&lt;-</span> rate_df[, .(</span>
<span id="cb9-2">  <span class="at" style="color: #657422;">data =</span> <span class="fu" style="color: #4758AB;">list</span>(.SD)</span>
<span id="cb9-3">), by <span class="ot" style="color: #003B4F;">=</span> .(sex, type, country)]</span>
<span id="cb9-4"><span class="fu" style="color: #4758AB;">head</span>(nested_df)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    sex      type country               data
1: Male Incidence Denmark &lt;data.table[41x7]&gt;
2: Male Incidence Finland &lt;data.table[41x7]&gt;
3: Male Incidence Iceland &lt;data.table[41x7]&gt;
4: Male Incidence  Norway &lt;data.table[41x7]&gt;
5: Male Incidence  Sweden &lt;data.table[41x7]&gt;
6: Male Mortality Denmark &lt;data.table[41x7]&gt;</code></pre>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Poisson regression model
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">model <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">glm</span>(</span>
<span id="cb11-2">  count <span class="sc" style="color: #5E5E5E;">~</span> year <span class="sc" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;">offset</span>(<span class="fu" style="color: #4758AB;">log</span>(population)),</span>
<span id="cb11-3">  <span class="at" style="color: #657422;">data =</span> rate_df,</span>
<span id="cb11-4">  <span class="at" style="color: #657422;">family =</span> <span class="fu" style="color: #4758AB;">poisson</span>(<span class="at" style="color: #657422;">link =</span> <span class="st" style="color: #20794D;">"log"</span>)</span>
<span id="cb11-5">)</span></code></pre></div>
</div>
</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Segmented regression model
</div>
</div>
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">sgmt_model <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">segmented</span>(model, <span class="at" style="color: #657422;">npsi =</span> <span class="dv" style="color: #AD0000;">2</span>)</span></code></pre></div>
</div>
</div>
<div class="cell">
<details>
<summary>Poisson and segmented fit</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">fitted_df <span class="ot" style="color: #003B4F;">&lt;-</span> nested_df[, <span class="fu" style="color: #4758AB;">map_df</span>(data, <span class="cf" style="color: #003B4F;">function</span>(dta) {</span>
<span id="cb13-2">  fit <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">glm</span>(</span>
<span id="cb13-3">    count <span class="sc" style="color: #5E5E5E;">~</span> year <span class="sc" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;">offset</span>(<span class="fu" style="color: #4758AB;">log</span>(population)),</span>
<span id="cb13-4">    <span class="at" style="color: #657422;">family =</span> <span class="fu" style="color: #4758AB;">poisson</span>(<span class="at" style="color: #657422;">link =</span> <span class="st" style="color: #20794D;">"log"</span>),</span>
<span id="cb13-5">    <span class="at" style="color: #657422;">data =</span> dta</span>
<span id="cb13-6">  )</span>
<span id="cb13-7">  sgmt_fit <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">segmented</span>(fit, <span class="at" style="color: #657422;">npsi =</span> <span class="dv" style="color: #AD0000;">2</span>)</span>
<span id="cb13-8"></span>
<span id="cb13-9">  <span class="fu" style="color: #4758AB;">data.table</span>(<span class="at" style="color: #657422;">fit =</span> <span class="fu" style="color: #4758AB;">list</span>(fit), <span class="at" style="color: #657422;">sgmt_fit =</span> <span class="fu" style="color: #4758AB;">list</span>(sgmt_fit))</span>
<span id="cb13-10">}), by <span class="ot" style="color: #003B4F;">=</span> .(sex, type, country)]</span>
<span id="cb13-11"><span class="fu" style="color: #4758AB;">head</span>(fitted_df)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    sex      type country       fit        sgmt_fit
1: Male Incidence Denmark &lt;glm[30]&gt; &lt;segmented[42]&gt;
2: Male Incidence Finland &lt;glm[30]&gt; &lt;segmented[42]&gt;
3: Male Incidence Iceland &lt;glm[30]&gt; &lt;segmented[42]&gt;
4: Male Incidence  Norway &lt;glm[30]&gt; &lt;segmented[42]&gt;
5: Male Incidence  Sweden &lt;glm[30]&gt; &lt;segmented[42]&gt;
6: Male Mortality Denmark &lt;glm[30]&gt; &lt;segmented[42]&gt;</code></pre>
</div>
</div>
<p>Following plots highlighting Norway and Finland for comparison show a higher melanoma incidence and mortality rate in Norway compared to Finland. A plateau was observed in melanoma incidence in Norway in both male and female.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" aria-controls="tabset-3-1" aria-selected="true">Crude rate</a></li><li class="nav-item"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" aria-controls="tabset-3-2" aria-selected="false">Poisson fit</a></li><li class="nav-item"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" aria-controls="tabset-3-3" aria-selected="false">Segmented fit</a></li><li class="nav-item"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" aria-controls="tabset-3-4" aria-selected="false">All countries</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" aria-labelledby="tabset-3-1-tab">
<p><img src="https://mathatistics.com/blog/posts/nordic-melanoma/Plots/Line-Nor-Fin.svg" class="img-fluid"></p>
</div>
<div id="tabset-3-2" class="tab-pane" aria-labelledby="tabset-3-2-tab">
<p><img src="https://mathatistics.com/blog/posts/nordic-melanoma/Plots/GLM-Nor-Fin.svg" class="img-fluid"></p>
</div>
<div id="tabset-3-3" class="tab-pane" aria-labelledby="tabset-3-3-tab">
<p><img src="https://mathatistics.com/blog/posts/nordic-melanoma/Plots/Sgmt-Nor-Fin.svg" class="img-fluid"></p>
</div>
<div id="tabset-3-4" class="tab-pane" aria-labelledby="tabset-3-4-tab">
<div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true">Poisson fit</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false">Segmented fit</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" aria-labelledby="tabset-2-1-tab">
<p><img src="https://mathatistics.com/blog/posts/nordic-melanoma/Plots/GLM-all.svg" class="img-fluid"></p>
</div>
<div id="tabset-2-2" class="tab-pane" aria-labelledby="tabset-2-2-tab">
<p><img src="https://mathatistics.com/blog/posts/nordic-melanoma/Plots/Sgmt-all.svg" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>Norway has higher melanoma incidence and mortality than Finland.</li>
<li>Finland has lowest melanoma incidence and mortality in both sexes</li>
<li>Norway has highest melanoma mortality followed by Sweden in both sexes</li>
<li>Denmark has surpassed both Norway and Sweden in melanoma incidence in the recent years</li>
<li>A plateau period was observed in melanoma incidence in Norway.</li>
<li>Most countries has raise in melanoma incidence after 2005.</li>
<li>A declining melanoma moratlity was observed in all countries in recent years.</li>
</ul>
</section>
<section id="model" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="model">Model</h2>
<section id="annual-percentge-change-apc" class="level3">
<h3 class="anchored" data-anchor-id="annual-percentge-change-apc">Annual percentge change (APC)</h3>
<p><img src="https://mathatistics.com/blog/posts/nordic-melanoma/Plots/model-summary-plot.svg" class="img-fluid" style="width:100.0%"></p>
</section>
<section id="apc-within-segments" class="level3">
<h3 class="anchored" data-anchor-id="apc-within-segments">APC within segments</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">a_apc <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">readRDS</span>(<span class="st" style="color: #20794D;">"Results/APC.Rds"</span>)</span>
<span id="cb15-2">apc <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">copy</span>(a_apc[[<span class="dv" style="color: #AD0000;">1</span>]])</span>
<span id="cb15-3">aapc <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">copy</span>(a_apc[[<span class="dv" style="color: #AD0000;">2</span>]])</span>
<span id="cb15-4">apc[, label_period <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> glue<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">glue_data</span>(.SD, <span class="st" style="color: #20794D;">"{label}&lt;br&gt;{psi}"</span>)]</span>
<span id="cb15-5">apc[, segment <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="fu" style="color: #4758AB;">gsub</span>(<span class="st" style="color: #20794D;">"slope"</span>, <span class="st" style="color: #20794D;">""</span>, segment)]</span></code></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">apc[country <span class="sc" style="color: #5E5E5E;">%in%</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"Norway"</span>, <span class="st" style="color: #20794D;">"Denmark"</span>)] <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb16-2">  <span class="fu" style="color: #4758AB;">dcast.data.table</span>(</span>
<span id="cb16-3">  country <span class="sc" style="color: #5E5E5E;">+</span> segment <span class="sc" style="color: #5E5E5E;">~</span> type <span class="sc" style="color: #5E5E5E;">+</span> sex,</span>
<span id="cb16-4">  <span class="at" style="color: #657422;">value.var =</span> <span class="st" style="color: #20794D;">"label_period"</span></span>
<span id="cb16-5">) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> gt<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">gt</span>(</span>
<span id="cb16-6">  <span class="at" style="color: #657422;">id =</span> <span class="st" style="color: #20794D;">"apc-table"</span>,</span>
<span id="cb16-7">  <span class="at" style="color: #657422;">rowname_col =</span> <span class="st" style="color: #20794D;">"segment"</span>,</span>
<span id="cb16-8">  <span class="at" style="color: #657422;">groupname_col =</span> <span class="st" style="color: #20794D;">"country"</span></span>
<span id="cb16-9">) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> gt<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">tab_spanner_delim</span>(<span class="st" style="color: #20794D;">"_"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb16-10">  gt<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">fmt_markdown</span>(<span class="fu" style="color: #4758AB;">everything</span>()) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb16-11">  gt<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">sub_missing</span>(<span class="fu" style="color: #4758AB;">everything</span>(), <span class="at" style="color: #657422;">missing_text =</span> <span class="st" style="color: #20794D;">"-"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb16-12">  gt<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">tab_stubhead</span>(<span class="st" style="color: #20794D;">"Segment"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb16-13">  gt<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">tab_options</span>(</span>
<span id="cb16-14">    <span class="at" style="color: #657422;">data_row.padding =</span> <span class="st" style="color: #20794D;">"0px"</span>,</span>
<span id="cb16-15">    <span class="at" style="color: #657422;">table.width =</span> <span class="st" style="color: #20794D;">"100%"</span>,</span>
<span id="cb16-16">    <span class="at" style="color: #657422;">table.font.size =</span> <span class="st" style="color: #20794D;">"small"</span>,</span>
<span id="cb16-17">    <span class="at" style="color: #657422;">column_labels.font.weight =</span> <span class="st" style="color: #20794D;">"bold"</span>,</span>
<span id="cb16-18">    <span class="at" style="color: #657422;">row_group.font.weight =</span> <span class="st" style="color: #20794D;">"bold"</span></span>
<span id="cb16-19">  )</span></code></pre></div>
</details>
<div class="cell-output-display">

<div id="apc-table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#apc-table table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#apc-table thead, #apc-table tbody, #apc-table tfoot, #apc-table tr, #apc-table td, #apc-table th {
  border-style: none;
}

#apc-table p {
  margin: 0;
  padding: 0;
}

#apc-table .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: small;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 100%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#apc-table .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#apc-table .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#apc-table .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#apc-table .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#apc-table .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#apc-table .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#apc-table .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#apc-table .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#apc-table .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#apc-table .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#apc-table .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#apc-table .gt_spanner_row {
  border-bottom-style: hidden;
}

#apc-table .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#apc-table .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#apc-table .gt_from_md > :first-child {
  margin-top: 0;
}

#apc-table .gt_from_md > :last-child {
  margin-bottom: 0;
}

#apc-table .gt_row {
  padding-top: 0px;
  padding-bottom: 0px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#apc-table .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#apc-table .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#apc-table .gt_row_group_first td {
  border-top-width: 2px;
}

#apc-table .gt_row_group_first th {
  border-top-width: 2px;
}

#apc-table .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#apc-table .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#apc-table .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#apc-table .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#apc-table .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#apc-table .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#apc-table .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#apc-table .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#apc-table .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#apc-table .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#apc-table .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#apc-table .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#apc-table .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#apc-table .gt_left {
  text-align: left;
}

#apc-table .gt_center {
  text-align: center;
}

#apc-table .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#apc-table .gt_font_normal {
  font-weight: normal;
}

#apc-table .gt_font_bold {
  font-weight: bold;
}

#apc-table .gt_font_italic {
  font-style: italic;
}

#apc-table .gt_super {
  font-size: 65%;
}

#apc-table .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#apc-table .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#apc-table .gt_indent_1 {
  text-indent: 5px;
}

#apc-table .gt_indent_2 {
  text-indent: 10px;
}

#apc-table .gt_indent_3 {
  text-indent: 15px;
}

#apc-table .gt_indent_4 {
  text-indent: 20px;
}

#apc-table .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings gt_spanner_row">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="Segment">Segment</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Incidence">
        <span class="gt_column_spanner">Incidence</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2" scope="colgroup" id="Mortality">
        <span class="gt_column_spanner">Mortality</span>
      </th>
    </tr>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Female">Female</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Male">Male</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Female">Female</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Male">Male</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_group_heading_row">
      <th colspan="5" class="gt_group_heading" scope="colgroup" id="Denmark">Denmark</th>
    </tr>
    <tr class="gt_row_group_first"><th id="stub_1_1" scope="row" class="gt_row gt_right gt_stub"><div class="gt_from_md"><p>1</p>
</div></th>
<td headers="Denmark stub_1_1 Incidence_Female" class="gt_row gt_center"><div class="gt_from_md"><p>2.73 (2.42, 3.04)<br>1980-2002</p>
</div></td>
<td headers="Denmark stub_1_1 Incidence_Male" class="gt_row gt_center"><div class="gt_from_md"><p>3.53 (3.22, 3.84)<br>1980-2004</p>
</div></td>
<td headers="Denmark stub_1_1 Mortality_Female" class="gt_row gt_center"><div class="gt_from_md"><p>10.46 (-6.14, 29.98)<br>1980-1982</p>
</div></td>
<td headers="Denmark stub_1_1 Mortality_Male" class="gt_row gt_center"><div class="gt_from_md"><p>0.62 (0.08, 1.16)<br>1980-2004</p>
</div></td></tr>
    <tr><th id="stub_1_2" scope="row" class="gt_row gt_right gt_stub"><div class="gt_from_md"><p>2</p>
</div></th>
<td headers="Denmark stub_1_2 Incidence_Female" class="gt_row gt_center"><div class="gt_from_md"><p>6.92 (5.8, 8.04)<br>2002-2011</p>
</div></td>
<td headers="Denmark stub_1_2 Incidence_Male" class="gt_row gt_center"><div class="gt_from_md"><p>9.86 (7.38, 12.39)<br>2004-2009</p>
</div></td>
<td headers="Denmark stub_1_2 Mortality_Female" class="gt_row gt_center"><div class="gt_from_md"><p>0.65 (0.26, 1.03)<br>1982-2014</p>
</div></td>
<td headers="Denmark stub_1_2 Mortality_Male" class="gt_row gt_center"><div class="gt_from_md"><p>4.02 (0.85, 7.29)<br>2004-2012</p>
</div></td></tr>
    <tr><th id="stub_1_3" scope="row" class="gt_row gt_right gt_stub"><div class="gt_from_md"><p>3</p>
</div></th>
<td headers="Denmark stub_1_3 Incidence_Female" class="gt_row gt_center"><div class="gt_from_md"><p>1.79 (1.18, 2.41)<br>2011-2020</p>
</div></td>
<td headers="Denmark stub_1_3 Incidence_Male" class="gt_row gt_center"><div class="gt_from_md"><p>3.12 (2.55, 3.69)<br>2009-2020</p>
</div></td>
<td headers="Denmark stub_1_3 Mortality_Female" class="gt_row gt_center"><div class="gt_from_md"><p>-1.98 (-6.26, 2.5)<br>2014-2020</p>
</div></td>
<td headers="Denmark stub_1_3 Mortality_Male" class="gt_row gt_center"><div class="gt_from_md"><p>-2.14 (-4.06, -0.17)<br>2012-2020</p>
</div></td></tr>
    <tr class="gt_group_heading_row">
      <th colspan="5" class="gt_group_heading" scope="colgroup" id="Norway">Norway</th>
    </tr>
    <tr class="gt_row_group_first"><th id="stub_1_4" scope="row" class="gt_row gt_right gt_stub"><div class="gt_from_md"><p>1</p>
</div></th>
<td headers="Norway stub_1_4 Incidence_Female" class="gt_row gt_center"><div class="gt_from_md"><p>3.92 (2.9, 4.96)<br>1980-1990</p>
</div></td>
<td headers="Norway stub_1_4 Incidence_Male" class="gt_row gt_center"><div class="gt_from_md"><p>5.49 (4.32, 6.67)<br>1980-1991</p>
</div></td>
<td headers="Norway stub_1_4 Mortality_Female" class="gt_row gt_center"><div class="gt_from_md"><p>1 (0.18, 1.84)<br>1980-2000</p>
</div></td>
<td headers="Norway stub_1_4 Mortality_Male" class="gt_row gt_center"><div class="gt_from_md"><p>17.06 (-0.38, 37.54)<br>1980-1982</p>
</div></td></tr>
    <tr><th id="stub_1_5" scope="row" class="gt_row gt_right gt_stub"><div class="gt_from_md"><p>2</p>
</div></th>
<td headers="Norway stub_1_5 Incidence_Female" class="gt_row gt_center"><div class="gt_from_md"><p>-0.1 (-1.26, 1.08)<br>1990-1999</p>
</div></td>
<td headers="Norway stub_1_5 Incidence_Male" class="gt_row gt_center"><div class="gt_from_md"><p>0.45 (-0.44, 1.35)<br>1991-2002</p>
</div></td>
<td headers="Norway stub_1_5 Mortality_Female" class="gt_row gt_center"><div class="gt_from_md"><p>2.7 (1.31, 4.1)<br>2000-2013</p>
</div></td>
<td headers="Norway stub_1_5 Mortality_Male" class="gt_row gt_center"><div class="gt_from_md"><p>1.79 (1.4, 2.19)<br>1982-2011</p>
</div></td></tr>
    <tr><th id="stub_1_6" scope="row" class="gt_row gt_right gt_stub"><div class="gt_from_md"><p>3</p>
</div></th>
<td headers="Norway stub_1_6 Incidence_Female" class="gt_row gt_center"><div class="gt_from_md"><p>3.62 (3.35, 3.88)<br>1999-2020</p>
</div></td>
<td headers="Norway stub_1_6 Incidence_Male" class="gt_row gt_center"><div class="gt_from_md"><p>4.39 (4.08, 4.69)<br>2002-2020</p>
</div></td>
<td headers="Norway stub_1_6 Mortality_Female" class="gt_row gt_center"><div class="gt_from_md"><p>-5.01 (-8.14, -1.76)<br>2013-2020</p>
</div></td>
<td headers="Norway stub_1_6 Mortality_Male" class="gt_row gt_center"><div class="gt_from_md"><p>-1.97 (-3.79, -0.12)<br>2011-2020</p>
</div></td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
</section>
<section id="model-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="model-1">Model</h2>
<p><strong>Incidence model:</strong></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">mdl_inc <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">glm</span>(</span>
<span id="cb17-2">  <span class="at" style="color: #657422;">data =</span> rate_df,</span>
<span id="cb17-3">  <span class="at" style="color: #657422;">formula =</span> count <span class="sc" style="color: #5E5E5E;">~</span> year <span class="sc" style="color: #5E5E5E;">+</span> sex <span class="sc" style="color: #5E5E5E;">+</span> country,</span>
<span id="cb17-4">  <span class="at" style="color: #657422;">offset =</span> <span class="fu" style="color: #4758AB;">log</span>(population),</span>
<span id="cb17-5">  <span class="at" style="color: #657422;">family =</span> <span class="fu" style="color: #4758AB;">poisson</span>(<span class="at" style="color: #657422;">link =</span> <span class="st" style="color: #20794D;">"log"</span>),</span>
<span id="cb17-6">  <span class="at" style="color: #657422;">subset =</span> type <span class="sc" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"Incidence"</span></span>
<span id="cb17-7">)</span></code></pre></div>
</details>
</div>
<p><strong>Mortality model</strong></p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">mdl_mor <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">glm</span>(</span>
<span id="cb18-2">  <span class="at" style="color: #657422;">data =</span> rate_df,</span>
<span id="cb18-3">  <span class="at" style="color: #657422;">formula =</span> count <span class="sc" style="color: #5E5E5E;">~</span> year <span class="sc" style="color: #5E5E5E;">+</span> sex <span class="sc" style="color: #5E5E5E;">+</span> country,</span>
<span id="cb18-4">  <span class="at" style="color: #657422;">offset =</span> <span class="fu" style="color: #4758AB;">log</span>(population),</span>
<span id="cb18-5">  <span class="at" style="color: #657422;">family =</span> <span class="fu" style="color: #4758AB;">poisson</span>(<span class="at" style="color: #657422;">link =</span> <span class="st" style="color: #20794D;">"log"</span>),</span>
<span id="cb18-6">  <span class="at" style="color: #657422;">subset =</span> type <span class="sc" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"Mortality"</span></span>
<span id="cb18-7">)</span></code></pre></div>
</details>
</div>
<section id="incidence-model-summary" class="level3">
<h3 class="anchored" data-anchor-id="incidence-model-summary">Incidence model summary</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">broom<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">tidy</span>(mdl_inc, <span class="at" style="color: #657422;">conf.int =</span> <span class="cn" style="color: #8f5902;">TRUE</span>, <span class="at" style="color: #657422;">exponentiate =</span> <span class="cn" style="color: #8f5902;">TRUE</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb19-2">  <span class="fu" style="color: #4758AB;">modify_at</span>(<span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">2</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">4</span>, <span class="dv" style="color: #AD0000;">6</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">7</span>), round, <span class="dv" style="color: #AD0000;">3</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 7
  term           estimate std.error statistic   p.value conf.low conf.high
  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)       0         0.383   -205.   0            0         0    
2 year              1.04      0        185.   0            1.04      1.04 
3 sexMale           1.01      0.004      1.90 5.68e-  2    1         1.02 
4 countryFinland    0.649     0.007    -62.6  0            0.64      0.658
5 countryIceland    0.494     0.028    -25.6  1.86e-144    0.468     0.521
6 countryNorway     1.05      0.006      8.09 5.84e- 16    1.04      1.06 
7 countrySweden     0.936     0.005    -12.1  1.41e- 33    0.926     0.946</code></pre>
</div>
</div>
</section>
<section id="mortality-model-summary" class="level3">
<h3 class="anchored" data-anchor-id="mortality-model-summary">Mortality model summary</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">broom<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">tidy</span>(mdl_mor, <span class="at" style="color: #657422;">conf.int =</span> <span class="cn" style="color: #8f5902;">TRUE</span>, <span class="at" style="color: #657422;">exponentiate =</span> <span class="cn" style="color: #8f5902;">TRUE</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;">modify_at</span>(<span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">2</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">4</span>, <span class="dv" style="color: #AD0000;">6</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">7</span>), round, <span class="dv" style="color: #AD0000;">3</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 7
  term           estimate std.error statistic   p.value conf.low conf.high
  &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)       0         0.844    -40.9  0            0         0    
2 year              1.01      0         29.2  1.53e-187    1.01      1.01 
3 sexMale           1.46      0.01      38.0  0            1.43      1.49 
4 countryFinland    0.731     0.016    -19.2  1.67e- 82    0.708     0.755
5 countryIceland    0.611     0.061     -8.02 1.05e- 15    0.54      0.688
6 countryNorway     1.24      0.015     14.6  3.57e- 48    1.20      1.27 
7 countrySweden     1.03      0.013      2.2  2.78e-  2    1.00      1.06 </code></pre>
</div>
</div>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<ul>
<li>Melanoma incidence and moratlity is increasing in all countries</li>
<li>Norway has highest mortality rate through out the period and has highest increase in both incidence and mortality.</li>
<li>Melanoma incidence increased rapidly in Denmark between 2002 and 2011 in women and 2004-2009 in men surpassing Norway.</li>
<li>Mortality is decreasing in all countries in recent period.</li>
</ul>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-engholm_nordcan_2010" class="csl-entry">
Engholm, Gerda, Jacques Ferlay, Niels Christensen, Freddie Bray, Marianne L. Gjerstorff, Åsa Klint, Jóanis E. Køtlum, Elínborg Ólafsdóttir, Eero Pukkala, and Hans H. Storm. 2010. <span>“<span>NORDCAN</span> – a Nordic Tool for Cancer Information, Planning, Quality Control and Research.”</span> <em>Acta Oncologica</em> 49 (5): 725–36. <a href="https://doi.org/ch4598">https://doi.org/ch4598</a>.
</div>
<div id="ref-nordcan-2023" class="csl-entry">
Larønningen, S., J. Ferlay, H. Beydogan, F. Bray, G. Engholm, M. Ervik, J. Gulbrandsen, et al. 2022. <span>“<span>NORDCAN</span>: Cancer Incidence, Mortality, Prevalence and Survival in the Nordic Countries, Version 9.2 (23.06.2022).”</span> 2022. <a href="https://nordcan.iarc.fr/">https://nordcan.iarc.fr/</a>.
</div>
<div id="ref-muggeo_segmented_2008" class="csl-entry">
Muggeo, Vito M. R. 2008. <span>“Segmented: An r Package to Fit Regression Models with Broken-Line Relationships.”</span> <em>R News</em> 8 (1): 20–25. <a href="https://cran.r-project.org/doc/Rnews/">https://cran.r-project.org/doc/Rnews/</a>.
</div>
<div id="ref-cancer_registry_of_norway_cancer_2022-1" class="csl-entry">
Norway, Cancer Registry of. 2022. <span>“Cancer in <span>Norway</span> 2021: <span>Cancer</span> Incidence, Mortality, Survival and Prevalence in <span>Norway</span>.”</span> 0806-3621. Cancer Registry of Norway. <a href="https://www.kreftregisteret.no/globalassets/cancer-in-norway/2021/cin_report.pdf">https://www.kreftregisteret.no/globalassets/cancer-in-norway/2021/cin_report.pdf</a>.
</div>
<div id="ref-r_core_team_r_2020" class="csl-entry">
R Core Team. 2020. <span>“R: <span>A</span> Language and Environment for Statistical Computing.”</span> Manual. Vienna, Austria. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-welch_rapid_2021" class="csl-entry">
Welch, H. Gilbert, Benjamin L. Mazer, and Adewole S. Adamson. 2021. <span>“The <span>Rapid</span> <span>Rise</span> in <span>Cutaneous</span> <span>Melanoma</span> <span>Diagnoses</span>.”</span> <em>New England Journal of Medicine</em> 384 (1): 72–79. <a href="https://doi.org/gm6vs4">https://doi.org/gm6vs4</a>.
</div>
<div id="ref-whiteman_growing_2016" class="csl-entry">
Whiteman, David C., Adele C. Green, and Catherine M. Olsen. 2016. <span>“The <span>Growing</span> <span>Burden</span> of <span>Invasive</span> <span>Melanoma</span>: <span>Projections</span> of <span>Incidence</span> <span>Rates</span> and <span>Numbers</span> of <span>New</span> <span>Cases</span> in <span>Six</span> <span>Susceptible</span> <span>Populations</span> Through 2031.”</span> <em>The Journal of Investigative Dermatology</em> 136 (6): 1161–71. <a href="https://doi.org/f8psv4">https://doi.org/f8psv4</a>.
</div>
</div>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><code>https://gco.iarc.fr/gateway_prod/api/nordcan/v2/92/data/population/{type}/{sex}/({country})/({cancer})/?ages_group=5_17&amp;year_start=1980&amp;year_end=2020&amp;year_grouped=0</code>↩︎</p></li>
</ol>
</section></div> ]]></description>
  <guid>https://mathatistics.com/blog/posts/nordic-melanoma/index.html</guid>
  <pubDate>Mon, 19 Jun 2023 22:00:00 GMT</pubDate>
  <media:content url="https://mathatistics.com/blog/posts/nordic-melanoma/Plots/Line-Nor-Fin.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Age Adjusted Rates in Epidemiology</title>
  <dc:creator>Raju Rimal</dc:creator>
  <link>https://mathatistics.com/blog/posts/age-adjusted-rates/index.html</link>
  <description><![CDATA[ 



<p>In general, rates means how fast something is changing usually over time. In epidemiology uses it to describe how quickly a disese occurs in a population. For example, 35 cases of melanoma cases in 100,000 person per year convey a the sense of speed of spread of disease in that population. Incidence rate and mortality rate are two examples that we will discuss further below.</p>
<blockquote class="blockquote">
<p>In epidemiology, rate measures the frequency of occurance of an event in a given population over certain period of time<sup>1</sup>.</p>
</blockquote>
<p>Let us use melanoma as a outcome in the following discussion. Here, we can calculate a crude incidence rate as,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BR%7D%20=%20%5Cfrac%7B%5Ctextsf%7Bno.%20of%20melanoma%20cases%7D%7D%7B%5Ctextsf%7Bno.%20of%20person-year%7D%7D%20%5Ctimes%20%5Ctextsf%7Bsome%20multiplier%7D"></p>
<p>In the case of mortality rate, we can replace the numerator of above expression by the number of melanoma deaths.</p>
<section id="age-specific-rate" class="level2">
<h2 class="anchored" data-anchor-id="age-specific-rate">Age-specific rate</h2>
<p>Weather to understand a broder prespecitve or to compare across population, these rates are often analyzed stratified by sex and age. This also helps to remove the confounding effection of these factors. The incidence/mortality rate per age-group is usually referred to as <em>Age-specific rates</em> where rates are computed for each age-groups. This is often desirable since factor <code>age</code> has a strong effect on mortality and incidence of most disease especially the cronic one.</p>
</section>
<section id="age-adjusted-rate" class="level2">
<h2 class="anchored" data-anchor-id="age-adjusted-rate">Age-adjusted rate</h2>
<p>Many research articles, however presents the age-adjusted rates. Age-adjusted rates are standardized (weighted) using some standard population age-structure. For example, many european studies on melanoma uses european standard age distribution. While any reasonal studies have also used world standard population. Cancer registry in their reports sometimes uses age-structure of that country in some given year. For instance, Norway<sup>2</sup> and Finland<sup>3</sup> have used the their population in 2014 as standard population in their recent cancer report while Australia have used 2001 Australian population<sup>4</sup>.</p>
<p>Standardized (adjusted) rates makes comparison between the population possible. Figure @ref(fig:age-std) shows the difference in the age distribution between world population and European population. Following table are some of the standard population often used in the study. Further on standard popuation see <a href="https://seer.cancer.gov/stdpopulations/stdpop.19ages.html"><code>seer.cancer.gov</code></a><sup>5</sup>.</p>
<div class="columns">
<div class="column">
<div class="cell">
<div class="cell-output-display">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>European and World standard population</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Age Group </th>
   <th style="text-align:right;"> World </th>
   <th style="text-align:right;"> Europe </th>
   <th style="text-align:right;"> Nordic </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;padding: 2px;"> 0-4 </td>
   <td style="text-align:right;padding: 2px;"> 12000 </td>
   <td style="text-align:right;padding: 2px;"> 8000 </td>
   <td style="text-align:right;padding: 2px;"> 5900 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 5-9 </td>
   <td style="text-align:right;padding: 2px;"> 10000 </td>
   <td style="text-align:right;padding: 2px;"> 7000 </td>
   <td style="text-align:right;padding: 2px;"> 6600 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 10-14 </td>
   <td style="text-align:right;padding: 2px;"> 9000 </td>
   <td style="text-align:right;padding: 2px;"> 7000 </td>
   <td style="text-align:right;padding: 2px;"> 6200 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 15-19 </td>
   <td style="text-align:right;padding: 2px;"> 9000 </td>
   <td style="text-align:right;padding: 2px;"> 7000 </td>
   <td style="text-align:right;padding: 2px;"> 5800 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 20-24 </td>
   <td style="text-align:right;padding: 2px;"> 8000 </td>
   <td style="text-align:right;padding: 2px;"> 7000 </td>
   <td style="text-align:right;padding: 2px;"> 6100 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 25-29 </td>
   <td style="text-align:right;padding: 2px;"> 8000 </td>
   <td style="text-align:right;padding: 2px;"> 7000 </td>
   <td style="text-align:right;padding: 2px;"> 6800 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 30-34 </td>
   <td style="text-align:right;padding: 2px;"> 6000 </td>
   <td style="text-align:right;padding: 2px;"> 7000 </td>
   <td style="text-align:right;padding: 2px;"> 7300 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 35-39 </td>
   <td style="text-align:right;padding: 2px;"> 6000 </td>
   <td style="text-align:right;padding: 2px;"> 7000 </td>
   <td style="text-align:right;padding: 2px;"> 7300 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 40-44 </td>
   <td style="text-align:right;padding: 2px;"> 6000 </td>
   <td style="text-align:right;padding: 2px;"> 7000 </td>
   <td style="text-align:right;padding: 2px;"> 7000 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 45-49 </td>
   <td style="text-align:right;padding: 2px;"> 6000 </td>
   <td style="text-align:right;padding: 2px;"> 7000 </td>
   <td style="text-align:right;padding: 2px;"> 6900 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 50-54 </td>
   <td style="text-align:right;padding: 2px;"> 5000 </td>
   <td style="text-align:right;padding: 2px;"> 7000 </td>
   <td style="text-align:right;padding: 2px;"> 7400 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 55-59 </td>
   <td style="text-align:right;padding: 2px;"> 4000 </td>
   <td style="text-align:right;padding: 2px;"> 6000 </td>
   <td style="text-align:right;padding: 2px;"> 6100 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 60-64 </td>
   <td style="text-align:right;padding: 2px;"> 4000 </td>
   <td style="text-align:right;padding: 2px;"> 5000 </td>
   <td style="text-align:right;padding: 2px;"> 4800 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 65-69 </td>
   <td style="text-align:right;padding: 2px;"> 3000 </td>
   <td style="text-align:right;padding: 2px;"> 4000 </td>
   <td style="text-align:right;padding: 2px;"> 4100 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 70-74 </td>
   <td style="text-align:right;padding: 2px;"> 2000 </td>
   <td style="text-align:right;padding: 2px;"> 3000 </td>
   <td style="text-align:right;padding: 2px;"> 3900 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 75-79 </td>
   <td style="text-align:right;padding: 2px;"> 1000 </td>
   <td style="text-align:right;padding: 2px;"> 2000 </td>
   <td style="text-align:right;padding: 2px;"> 3500 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 80-84 </td>
   <td style="text-align:right;padding: 2px;"> 500 </td>
   <td style="text-align:right;padding: 2px;"> 1000 </td>
   <td style="text-align:right;padding: 2px;"> 2400 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 2px;"> 85+ </td>
   <td style="text-align:right;padding: 2px;"> 500 </td>
   <td style="text-align:right;padding: 2px;"> 1000 </td>
   <td style="text-align:right;padding: 2px;"> 1900 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div><div class="column">
<div class="cell">
<div class="cell-output-display">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>US 2000 standard population</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Age Group </th>
   <th style="text-align:right;"> Std.Population </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;padding: 1px;"> 00 </td>
   <td style="text-align:right;padding: 1px;"> 13818 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 01-04 </td>
   <td style="text-align:right;padding: 1px;"> 55317 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 05-09 </td>
   <td style="text-align:right;padding: 1px;"> 72533 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 10-14 </td>
   <td style="text-align:right;padding: 1px;"> 73032 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 15-19 </td>
   <td style="text-align:right;padding: 1px;"> 72169 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 20-24 </td>
   <td style="text-align:right;padding: 1px;"> 66478 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 25-29 </td>
   <td style="text-align:right;padding: 1px;"> 64529 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 30-34 </td>
   <td style="text-align:right;padding: 1px;"> 71044 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 35-39 </td>
   <td style="text-align:right;padding: 1px;"> 80762 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 40-44 </td>
   <td style="text-align:right;padding: 1px;"> 81851 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 45-49 </td>
   <td style="text-align:right;padding: 1px;"> 72118 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 50-54 </td>
   <td style="text-align:right;padding: 1px;"> 62716 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 55-59 </td>
   <td style="text-align:right;padding: 1px;"> 48454 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 60-64 </td>
   <td style="text-align:right;padding: 1px;"> 38793 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 65-69 </td>
   <td style="text-align:right;padding: 1px;"> 34264 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 70-74 </td>
   <td style="text-align:right;padding: 1px;"> 31773 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 75-79 </td>
   <td style="text-align:right;padding: 1px;"> 26999 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 80-84 </td>
   <td style="text-align:right;padding: 1px;"> 17842 </td>
  </tr>
  <tr>
   <td style="text-align:left;padding: 1px;"> 85+ </td>
   <td style="text-align:right;padding: 1px;"> 15508 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<div class="columns">
<div class="column">
<section id="calculating-age-standardized-rate" class="level2">
<h2 class="anchored" data-anchor-id="calculating-age-standardized-rate">Calculating age-standardized rate</h2>
<p>The age-standardized rate (ASR) is calculated as,</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7BAge.Std.%20Rate%7D%20=%20%5Cfrac%7B%5Csum_i%5Cmathcal%7BR%7D_i%5Cmathcal%7Bw%7D_i%7D%7B%5Csum_i%5Cmathcal%7Bw%7D_i%7D"></p>
<p>where, <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7Bw%7D_i"> is the weight corresponding to <img src="https://latex.codecogs.com/png.latex?i%5E%5Ctext%7Bth%7D"> age-group in the reference population.</p>
<p>Let’s explore further with an example from melanoma cases from Australia.</p>
</section>
</div><div class="column">
<div class="cell" data-fig.asp="0.8">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://mathatistics.com/blog/posts/age-adjusted-rates/index_files/figure-html/age-std-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">World and European standard population</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example</h2>
<p>The following example have used the Austrailian cancer data with 5-year age-group<sup>6</sup> after filtering melanoma cases from 1982 to 2018. The dataset has yearly count and age-specific incidence rate of melanoma for men and women.</p>
<p>Let us use the above European standard population to find the yearly age-standardized incidence by sex.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">data <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">fread</span>(<span class="st" style="color: #20794D;">"melanoma.csv"</span>)</span>
<span id="cb1-2">std_pop <span class="ot" style="color: #003B4F;">&lt;-</span> popEpi<span class="sc" style="color: #5E5E5E;">::</span>stdpop18</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">data[AgeGroup <span class="sc" style="color: #5E5E5E;">%in%</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"85-89"</span>, <span class="st" style="color: #20794D;">"90+"</span>), AgeGroup <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="st" style="color: #20794D;">"85+"</span>]</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;">setnames</span>(std_pop, <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"AgeGroup"</span>, <span class="st" style="color: #20794D;">"World"</span>, <span class="st" style="color: #20794D;">"Europe"</span>, <span class="st" style="color: #20794D;">"Nordic"</span>))</span>
<span id="cb2-3">std_pop[AgeGroup <span class="sc" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"85"</span>, AgeGroup <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="st" style="color: #20794D;">"85+"</span>]</span>
<span id="cb2-4">std_pop[, <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">2</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">4</span>) <span class="sc" style="color: #5E5E5E;">:</span><span class="er" style="color: #AD0000;">=</span> <span class="fu" style="color: #4758AB;">lapply</span>(.SD, prop.table), .SDcols <span class="ot" style="color: #003B4F;">=</span> <span class="dv" style="color: #AD0000;">2</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">4</span>]</span>
<span id="cb2-5">asp_data <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">merge.data.table</span>(data, std_pop[, .(AgeGroup, World)], <span class="at" style="color: #657422;">by =</span> <span class="st" style="color: #20794D;">"AgeGroup"</span>)</span>
<span id="cb2-6">asp <span class="ot" style="color: #003B4F;">&lt;-</span> asp_data[, .(<span class="at" style="color: #657422;">AgeAdjRate =</span> <span class="fu" style="color: #4758AB;">sum</span>(ASR <span class="sc" style="color: #5E5E5E;">*</span> World)), by <span class="ot" style="color: #003B4F;">=</span> .(Year, Sex)]</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">asp[, <span class="fu" style="color: #4758AB;">tail</span>(.SD, <span class="dv" style="color: #AD0000;">8</span>), by <span class="ot" style="color: #003B4F;">=</span> Sex] <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb3-2">    <span class="fu" style="color: #4758AB;">dcast.data.table</span>(</span>
<span id="cb3-3">        <span class="at" style="color: #657422;">formula =</span> Sex <span class="sc" style="color: #5E5E5E;">~</span> Year,</span>
<span id="cb3-4">        <span class="at" style="color: #657422;">value.var =</span> <span class="st" style="color: #20794D;">"AgeAdjRate"</span>) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb3-5">        kableExtra<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">kbl</span>(<span class="at" style="color: #657422;">caption =</span> <span class="fu" style="color: #4758AB;">paste</span>(</span>
<span id="cb3-6">            <span class="st" style="color: #20794D;">"Age-standardized incidence rate of melanoma"</span>,</span>
<span id="cb3-7">            <span class="st" style="color: #20794D;">"Australia from 2011 to 2018"</span></span>
<span id="cb3-8">    )) <span class="sc" style="color: #5E5E5E;">%&gt;%</span> </span>
<span id="cb3-9">    kableExtra<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">kable_styling</span>(<span class="at" style="color: #657422;">full_width =</span> <span class="cn" style="color: #8f5902;">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">

<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>Age-standardized incidence rate of melanoma Australia from 2011 to 2018</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Sex </th>
   <th style="text-align:right;"> 2011 </th>
   <th style="text-align:right;"> 2012 </th>
   <th style="text-align:right;"> 2013 </th>
   <th style="text-align:right;"> 2014 </th>
   <th style="text-align:right;"> 2015 </th>
   <th style="text-align:right;"> 2016 </th>
   <th style="text-align:right;"> 2017 </th>
   <th style="text-align:right;"> 2018 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Females </td>
   <td style="text-align:right;"> 28.915 </td>
   <td style="text-align:right;"> 29.6905 </td>
   <td style="text-align:right;"> 30.3050 </td>
   <td style="text-align:right;"> 30.5225 </td>
   <td style="text-align:right;"> 30.8590 </td>
   <td style="text-align:right;"> 32.161 </td>
   <td style="text-align:right;"> 31.5110 </td>
   <td style="text-align:right;"> 32.404 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Males </td>
   <td style="text-align:right;"> 41.433 </td>
   <td style="text-align:right;"> 42.3845 </td>
   <td style="text-align:right;"> 43.1275 </td>
   <td style="text-align:right;"> 42.8415 </td>
   <td style="text-align:right;"> 43.7275 </td>
   <td style="text-align:right;"> 45.309 </td>
   <td style="text-align:right;"> 45.2745 </td>
   <td style="text-align:right;"> 45.040 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Now, let us compare the age-specific rates (crude rates) and age-standardized rates with a plot,</p>
<section id="compare-the-age-specific-rates-and-age-adjusted-rates" class="level3 accordions">
<h3 class="accordions anchored" data-anchor-id="compare-the-age-specific-rates-and-age-adjusted-rates">Compare the age-specific rates and age-adjusted rates</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Plot</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="accordion tab-pane active" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-fig.asp="0.5">
<div class="cell-output-display">
<div id="fig-rate-plot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://mathatistics.com/blog/posts/age-adjusted-rates/index_files/figure-html/fig-rate-plot-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Age-standardized melanoma rate in Australia</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="accordion tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="cell">

</div>
</div>
</div>
</div>
</section>
<section id="compare-the-age-adjusted-rates-by-sex" class="level3 accordions">
<h3 class="accordions anchored" data-anchor-id="compare-the-age-adjusted-rates-by-sex">Compare the age-adjusted rates by sex</h3>
<div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" aria-controls="tabset-2-1" aria-selected="true">Plot</a></li><li class="nav-item"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" aria-controls="tabset-2-2" aria-selected="false">Code</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="accordion tab-pane active" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-fig.asp="0.5">
<div class="cell-output-display">
<div id="fig-adj-rate-plot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://mathatistics.com/blog/posts/age-adjusted-rates/index_files/figure-html/fig-adj-rate-plot-1.svg" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Age-standardized melanoma rate in Australia</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="accordion tab-pane" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;">ggplot</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-2">    <span class="fu" style="color: #4758AB;">geom_line</span>(</span>
<span id="cb4-3">        <span class="at" style="color: #657422;">data =</span> data, </span>
<span id="cb4-4">        <span class="fu" style="color: #4758AB;">aes</span>(</span>
<span id="cb4-5">            <span class="at" style="color: #657422;">x =</span> Year, </span>
<span id="cb4-6">            <span class="at" style="color: #657422;">y =</span> ASR, </span>
<span id="cb4-7">            <span class="at" style="color: #657422;">group =</span> AgeGroup,</span>
<span id="cb4-8">            <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">"Crude"</span></span>
<span id="cb4-9">        )</span>
<span id="cb4-10">    ) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-11">    <span class="fu" style="color: #4758AB;">geom_line</span>(</span>
<span id="cb4-12">        <span class="at" style="color: #657422;">data =</span> asp,</span>
<span id="cb4-13">        <span class="fu" style="color: #4758AB;">aes</span>(</span>
<span id="cb4-14">            <span class="at" style="color: #657422;">x =</span> Year, </span>
<span id="cb4-15">            <span class="at" style="color: #657422;">y =</span> AgeAdjRate, </span>
<span id="cb4-16">            <span class="at" style="color: #657422;">group =</span> <span class="dv" style="color: #AD0000;">1</span>,</span>
<span id="cb4-17">            <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">"Age-adjusted"</span></span>
<span id="cb4-18">        )</span>
<span id="cb4-19">    ) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-20">    <span class="fu" style="color: #4758AB;">geom_text</span>(</span>
<span id="cb4-21">        <span class="at" style="color: #657422;">data =</span> data[Year <span class="sc" style="color: #5E5E5E;">==</span> <span class="fu" style="color: #4758AB;">max</span>(Year)],</span>
<span id="cb4-22">        <span class="at" style="color: #657422;">check_overlap =</span> <span class="cn" style="color: #8f5902;">TRUE</span>,</span>
<span id="cb4-23">        <span class="at" style="color: #657422;">size =</span> <span class="fu" style="color: #4758AB;">rel</span>(<span class="dv" style="color: #AD0000;">2</span>),</span>
<span id="cb4-24">        <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">"#0f0f0f"</span>,</span>
<span id="cb4-25">        <span class="fu" style="color: #4758AB;">aes</span>(</span>
<span id="cb4-26">            <span class="at" style="color: #657422;">x =</span> Year <span class="sc" style="color: #5E5E5E;">+</span> <span class="dv" style="color: #AD0000;">2</span>,</span>
<span id="cb4-27">            <span class="at" style="color: #657422;">y =</span> ASR,</span>
<span id="cb4-28">            <span class="at" style="color: #657422;">label =</span> AgeGroup</span>
<span id="cb4-29">        )</span>
<span id="cb4-30">    ) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-31">    <span class="fu" style="color: #4758AB;">scale_x_continuous</span>(<span class="at" style="color: #657422;">breaks =</span> scales<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">breaks_extended</span>(<span class="dv" style="color: #AD0000;">8</span>)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-32">    <span class="fu" style="color: #4758AB;">scale_y_continuous</span>(<span class="at" style="color: #657422;">breaks =</span> scales<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">breaks_extended</span>(<span class="dv" style="color: #AD0000;">8</span>)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-33">    <span class="fu" style="color: #4758AB;">scale_color_manual</span>(<span class="cn" style="color: #8f5902;">NULL</span>, <span class="at" style="color: #657422;">values =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"firebrick"</span>, <span class="st" style="color: #20794D;">"grey"</span>)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-34">    <span class="fu" style="color: #4758AB;">facet_grid</span>(<span class="at" style="color: #657422;">cols =</span> <span class="fu" style="color: #4758AB;">vars</span>(Sex)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-35">    <span class="fu" style="color: #4758AB;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-36">    <span class="fu" style="color: #4758AB;">theme</span>(</span>
<span id="cb4-37">        <span class="at" style="color: #657422;">panel.border =</span> <span class="fu" style="color: #4758AB;">element_rect</span>(<span class="at" style="color: #657422;">fill =</span> <span class="cn" style="color: #8f5902;">NA</span>, <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">"darkgrey"</span>),</span>
<span id="cb4-38">        <span class="at" style="color: #657422;">legend.position =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">1</span>),</span>
<span id="cb4-39">        <span class="at" style="color: #657422;">legend.justification =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">1</span>)</span>
<span id="cb4-40">    ) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-41">    <span class="fu" style="color: #4758AB;">labs</span>(</span>
<span id="cb4-42">        <span class="at" style="color: #657422;">x =</span> <span class="st" style="color: #20794D;">"Diagnosis year"</span>,</span>
<span id="cb4-43">        <span class="at" style="color: #657422;">y =</span> <span class="fu" style="color: #4758AB;">paste</span>(</span>
<span id="cb4-44">            <span class="st" style="color: #20794D;">"Age-adjusted incidence rate"</span>,</span>
<span id="cb4-45">            <span class="st" style="color: #20794D;">"per 100,000 person year"</span>,</span>
<span id="cb4-46">            <span class="at" style="color: #657422;">sep =</span> <span class="st" style="color: #20794D;">"</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">"</span></span>
<span id="cb4-47">        )</span>
<span id="cb4-48">    )</span></code></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<p>Figure Figure&nbsp;1 shows that the incidence of melanoma has larger difference in men between the age-groups than in women and men also have a sharp increase in older age group. In addition, the Figure Figure&nbsp;2 shows that males have higher age-adjusted incidence of melanoma than women in Australia and this trend is increasing over time with rapid increase before 1983 before a drop.</p>
<p>Age-adjusted rates are useful for comparing rates between population but it cannot give the interpretation required for comparing within a population or over a time period in that population. This is one of the reason, cancer registry uses the internal (population structure of their own population) to compute the age-adjusted rates.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>https://www.cdc.gov/csels/dsepd/ss1978/lesson3/section1.html↩︎</p></li>
<li id="fn2"><p>https://www.kreftregisteret.no/globalassets/cancer-in-norway/2021/cin_report.pdf↩︎</p></li>
<li id="fn3"><p>https://cancerregistry.fi/reports-and-publications/annual-report-on-cancer-in-finland/↩︎</p></li>
<li id="fn4"><p>https://www.aihw.gov.au/reports/cancer/cancer-in-australia-2021/summary↩︎</p></li>
<li id="fn5"><p>https://seer.cancer.gov/stdpopulations/stdpop.19ages.html↩︎</p></li>
<li id="fn6"><p>https://www.aihw.gov.au/reports/cancer/cancer-data-in-australia/data↩︎</p></li>
</ol>
</section></div> ]]></description>
  <guid>https://mathatistics.com/blog/posts/age-adjusted-rates/index.html</guid>
  <pubDate>Fri, 02 Dec 2022 20:00:57 GMT</pubDate>
</item>
<item>
  <title>Convert list of array/matrix into an array in R</title>
  <dc:creator>therimalaya</dc:creator>
  <link>https://mathatistics.com/blog/posts/2022-03-18-convert-list-to-array/index.html</link>
  <description><![CDATA[ 



<p>Array and matrix/tables are data structures in R with same data types such as numeric, string or boolean. This examples show how to convert a list of vector/matrix/array into a multi-dimentional array so that it will become easier to aggregate them in particular dimension. We can also do this converting everything into data frame but this way can be useful sometimes and is worth learning.</p>
<p>Let us use a dataset already available in R and convert that into a list of tables or matrix. Here I will use <code>Titanic</code> dataset and convert it into a nested list of array using <code>purrr</code> package.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">library</span>(purrr)</span>
<span id="cb1-2">titanic_list <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">array_tree</span>(Titanic, <span class="dv" style="color: #AD0000;">4</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">3</span>)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;">str</span>(titanic_list)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 2
 $ No :List of 2
  ..$ Child: num [1:4, 1:2] 0 0 35 0 0 0 17 0
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ Class: chr [1:4] "1st" "2nd" "3rd" "Crew"
  .. .. ..$ Sex  : chr [1:2] "Male" "Female"
  ..$ Adult: num [1:4, 1:2] 118 154 387 670 4 13 89 3
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ Class: chr [1:4] "1st" "2nd" "3rd" "Crew"
  .. .. ..$ Sex  : chr [1:2] "Male" "Female"
 $ Yes:List of 2
  ..$ Child: num [1:4, 1:2] 5 11 13 0 1 13 14 0
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ Class: chr [1:4] "1st" "2nd" "3rd" "Crew"
  .. .. ..$ Sex  : chr [1:2] "Male" "Female"
  ..$ Adult: num [1:4, 1:2] 57 14 75 192 140 80 76 20
  .. ..- attr(*, "dimnames")=List of 2
  .. .. ..$ Class: chr [1:4] "1st" "2nd" "3rd" "Crew"
  .. .. ..$ Sex  : chr [1:2] "Male" "Female"</code></pre>
</div>
</div>
<p>Following function will convert this nested array into a multi-dimensional array.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">list2array <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(list, <span class="at" style="color: #657422;">dnames.name =</span> <span class="cn" style="color: #8f5902;">NULL</span>) {</span>
<span id="cb3-2">  l2a <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(l) {</span>
<span id="cb3-3">    <span class="fu" style="color: #4758AB;">do.call</span>(abind<span class="sc" style="color: #5E5E5E;">::</span>abind, <span class="fu" style="color: #4758AB;">append</span>(l, <span class="fu" style="color: #4758AB;">list</span>(<span class="at" style="color: #657422;">rev.along =</span> <span class="dv" style="color: #AD0000;">0</span>)))</span>
<span id="cb3-4">  }</span>
<span id="cb3-5">  <span class="cf" style="color: #003B4F;">while</span> (<span class="fu" style="color: #4758AB;">is.list</span>(list[[<span class="dv" style="color: #AD0000;">1</span>]])) {</span>
<span id="cb3-6">    list <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">map</span>(list, l2a)</span>
<span id="cb3-7">  }</span>
<span id="cb3-8">  out <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">l2a</span>(list)</span>
<span id="cb3-9">  <span class="cf" style="color: #003B4F;">if</span> (<span class="sc" style="color: #5E5E5E;">!</span><span class="fu" style="color: #4758AB;">is.null</span>(dnames.name)) <span class="fu" style="color: #4758AB;">names</span>(<span class="fu" style="color: #4758AB;">dimnames</span>(out)) <span class="ot" style="color: #003B4F;">&lt;-</span> dnames.name</span>
<span id="cb3-10">  <span class="fu" style="color: #4758AB;">return</span>(out)</span>
<span id="cb3-11">}</span></code></pre></div>
</div>
<p>Now, testing the function we just created.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">NewTitanic <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">list2array</span>(titanic_list, <span class="at" style="color: #657422;">dnames.name =</span> <span class="fu" style="color: #4758AB;">names</span>(<span class="fu" style="color: #4758AB;">dimnames</span>(Titanic)))</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;">str</span>(NewTitanic)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:4, 1:2, 1:2, 1:2] 0 0 35 0 0 0 17 0 118 154 ...
 - attr(*, "dimnames")=List of 4
  ..$ Class   : chr [1:4] "1st" "2nd" "3rd" "Crew"
  ..$ Sex     : chr [1:2] "Male" "Female"
  ..$ Age     : chr [1:2] "Child" "Adult"
  ..$ Survived: chr [1:2] "No" "Yes"</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;">identical</span>(Titanic, <span class="fu" style="color: #4758AB;">as.table</span>(NewTitanic))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>



 ]]></description>
  <category>R</category>
  <guid>https://mathatistics.com/blog/posts/2022-03-18-convert-list-to-array/index.html</guid>
  <pubDate>Thu, 17 Mar 2022 23:00:00 GMT</pubDate>
</item>
<item>
  <title>How ANOVA analyze the variance</title>
  <dc:creator>therimalaya</dc:creator>
  <link>https://mathatistics.com/blog/posts/2021-03-29-how-anova-analyze-variance/index.html</link>
  <description><![CDATA[ 



<p>Often we Analysis of Variance (ANOVA) to analyze the variances to find if different cases results in similar outcome and if the difference is significant. Following are some simple examples,</p>
<ul>
<li>The effect of different diets on growth of fishes</li>
<li>Comparing the height of three different species of a plant</li>
<li>Type of flour used for baking a bread</li>
</ul>
<p>These are some common examples where in some cases data are collected by setting up an experiment and in other cases they are collected through sampling. This article tries to explain how the ANOVA analyze the variance and in what situation are they significant throught both simulated and real data.</p>
<p>Consider the following model with <img src="https://latex.codecogs.com/png.latex?i=3"> groups and <img src="https://latex.codecogs.com/png.latex?j=n"> observations,</p>
<p><img src="https://latex.codecogs.com/png.latex?y_%7Bij%7D%20=%20%5Cmu%20+%20%5Ctau_i%20+%20%5Cvarepsilon_%7Bij%7D,%20%5C;%20i%20=%201,%202,%203%0A%5Ctexttt%7B%20and%20%7D%20j%20=%201,%202,%20%5Cldots%20n"></p>
<p>here, <img src="https://latex.codecogs.com/png.latex?%5Ctau_i"> is the effect corresponding to group <img src="https://latex.codecogs.com/png.latex?i"> and <img src="https://latex.codecogs.com/png.latex?%5Cvarepsilon_%7Bij%7D%20%5Csim%20%5Cmathrm%7BN%7D(0,%20%5Csigma%5E2)">, the usual assumption of linear model. In order to understand how ANOVA finds the differences between groups and how the group mean and their standard deviation influence the results from ANOVA, let us consider following four cases:</p>
<dl>
<dt>Case 1</dt>
<dd>
Similar group means with high variation within the groups
</dd>
<dt>Case 2</dt>
<dd>
Similar group means with low variation within the groups
</dd>
<dt>Case 3</dt>
<dd>
Distant group means with high variation within the groups
</dd>
<dt>Case 4</dt>
<dd>
Distant group means with low variation within the groups
</dd>
</dl>
<section id="simulating-data-resembling-these-cases" class="level2">
<h2 class="anchored" data-anchor-id="simulating-data-resembling-these-cases">Simulating data resembling these cases</h2>
<div class="cell">

</div>
</section>
<section id="fitting-anova-model-for-each-cases" class="level2">
<h2 class="anchored" data-anchor-id="fitting-anova-model-for-each-cases">Fitting ANOVA model for each cases</h2>
<div class="cell">

</div>
</section>
<section id="prepare-data-for-plotting" class="level2">
<h2 class="anchored" data-anchor-id="prepare-data-for-plotting">Prepare data for plotting</h2>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 2.21</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 1.48</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 6.18</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 2.66</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://mathatistics.com/blog/posts/2021-03-29-how-anova-analyze-variance/index_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 2.21</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 1.48</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 6.18</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 2.66</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 3.12</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 3.47</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 6.01</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 6.22</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://mathatistics.com/blog/posts/2021-03-29-how-anova-analyze-variance/index_files/figure-html/unnamed-chunk-6-1.svg" class="img-fluid" style="width:100.0%"></p>
</div>
</div>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>


</section>

 ]]></description>
  <guid>https://mathatistics.com/blog/posts/2021-03-29-how-anova-analyze-variance/index.html</guid>
  <pubDate>Sun, 28 Mar 2021 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Interpreting Biplot</title>
  <dc:creator>therimalaya</dc:creator>
  <link>https://mathatistics.com/blog/posts/2017-03-18-interpreting-biplot/index.html</link>
  <description><![CDATA[ 



<p>Obviously, the name suggests itself that there are two aspect of data plotted in latent scale. Biplot in case of principal component analysis (PCA) plot both variable and observation in latent scale (scores and loadings). Throughout this article, I will use <a href="https://www.rdocumentation.org/packages/datasets/versions/3.3.2/topics/USArrests"><code>USArrests</code></a> data from <code>datasets</code> package. Lets fit a PCA model using <code>princomp</code> function. However, this can also be done using <code>prcomp</code>. The later one uses singular value decomposition while the former one uses eigenvalue decomposition. Here I have used correlation rather than covariance to compute principal components because there are large values in case of <code>Murder</code> and <code>UrbanPop</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pc.a <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">princomp</span>(USArrests, <span class="at" style="color: #657422;">cor =</span> <span class="cn" style="color: #8f5902;">TRUE</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;">plot</span>(pc.a, <span class="at" style="color: #657422;">type =</span> <span class="st" style="color: #20794D;">"lines"</span>, <span class="at" style="color: #657422;">pch =</span> <span class="dv" style="color: #AD0000;">22</span>, <span class="at" style="color: #657422;">bg =</span> <span class="st" style="color: #20794D;">"grey"</span>,</span>
<span id="cb1-3">     <span class="at" style="color: #657422;">main =</span> <span class="st" style="color: #20794D;">"Variance explained by each componets in PCA"</span>)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;">text</span>(<span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">4</span>, pc.a<span class="sc" style="color: #5E5E5E;">$</span>sdev<span class="sc" style="color: #5E5E5E;">^</span><span class="dv" style="color: #AD0000;">2</span>, <span class="at" style="color: #657422;">pos =</span> <span class="dv" style="color: #AD0000;">4</span>,</span>
<span id="cb1-5">     <span class="at" style="color: #657422;">labels =</span> <span class="fu" style="color: #4758AB;">round</span>(<span class="fu" style="color: #4758AB;">cumsum</span>(pls<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">explvar</span>(pc.a)), <span class="dv" style="color: #AD0000;">1</span>))</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;">box</span>()</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://mathatistics.com/blog/posts/2017-03-18-interpreting-biplot/index_files/figure-html/get-records-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Variance of each components and the proportaion of the total variance explained for each additional components is displayed as label</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Here, with three components, we have captured 95.7 percent of total variation present in <code>USArrests</code> dataset. Lets get the biplot and try to understand it.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;">library</span>(ggfortify)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;">autoplot</span>(</span>
<span id="cb2-3">  pc.a, <span class="at" style="color: #657422;">label =</span> T, <span class="at" style="color: #657422;">shape =</span> <span class="cn" style="color: #8f5902;">FALSE</span>,</span>
<span id="cb2-4">  <span class="at" style="color: #657422;">loadings =</span> <span class="cn" style="color: #8f5902;">TRUE</span>, <span class="at" style="color: #657422;">loadings.label =</span> <span class="cn" style="color: #8f5902;">TRUE</span>,</span>
<span id="cb2-5">  <span class="at" style="color: #657422;">label.size =</span> <span class="fl" style="color: #AD0000;">3.5</span>, <span class="at" style="color: #657422;">label.repel =</span> <span class="cn" style="color: #8f5902;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://mathatistics.com/blog/posts/2017-03-18-interpreting-biplot/index_files/figure-html/biplot-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>



 ]]></description>
  <category>statistics</category>
  <guid>https://mathatistics.com/blog/posts/2017-03-18-interpreting-biplot/index.html</guid>
  <pubDate>Fri, 17 Mar 2017 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Model assessment and variable selection</title>
  <dc:creator>therimalaya</dc:creator>
  <link>https://mathatistics.com/blog/posts/2017-03-05-model-assessment-and-variable-selection-prodecure/index.html</link>
  <description><![CDATA[ 



<p>Whenever we add a variable in our model, we are not only adding information but also noise that clutter the information and makes the analysis difficult. Simpler model is always better since they contain less noise and they are easy to interpret. In real life, things are not that simple. But relax, there are statistical methods that make model assessment and perform variable selection and gives optimal set of variables for us.</p>
<p>Here, I will discuss how to compare model to know which one is better than other. This model assessment help us to select a model with few variable that can perform as good as a model with large number of variables. Here comes the idea of variable selection. I will try to explain these concepts with an example. For the example I will use <code>mtcars</code> data set which is available in R by default. Following are two well know procedure of selecting subset of variables,</p>
<section id="best-subset-method" class="level1">
<h1>Best subset method</h1>
<p>Best subset procedure selects best regression model by running all possible subset of variables. When number of variable is large, the possible combinations of candidate subset become huge. For example, for 2 variable case (<img src="https://latex.codecogs.com/png.latex?X_1"> and <img src="https://latex.codecogs.com/png.latex?X_2">), there are 4 possible subsets – 1 with no predictors, 2 with single predictors and 1 with both predictors. Similarly, if there are 4 variable case (<img src="https://latex.codecogs.com/png.latex?X_1,%20X_2,%20X_3"> and <img src="https://latex.codecogs.com/png.latex?X_4">), there will be 16 possible subset. In general, fitting all possible subset of large number of predictors becomes computationally intensive.</p>
<p>Once, all the possible model is fitted, they are compared based on some criteria. This model assessment may based on various criteria such as coefficient of determination (<img src="https://latex.codecogs.com/png.latex?R%5E2">), adjusted <img src="https://latex.codecogs.com/png.latex?R%5E2">, Mallow’s CP, AIC and BIC. In R, <a href="https://www.rdocumentation.org/packages/leaps/versions/2.1-1">leaps</a> package can be used for performing this operation. Lets dig into our <code>mtcars</code> example.</p>
<details>
<summary>
<p><strong>Fitting a complete model:</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">full.model <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;">~</span> ., <span class="at" style="color: #657422;">data =</span> mtcars)</span>
<span id="cb1-2">smry <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">summary</span>(full.model)</span></code></pre></div>
</div>
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">smry</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ ., data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4506 -1.6044 -0.1196  1.2193  4.6271 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) 12.30337   18.71788   0.657   0.5181  
cyl         -0.11144    1.04502  -0.107   0.9161  
disp         0.01334    0.01786   0.747   0.4635  
hp          -0.02148    0.02177  -0.987   0.3350  
drat         0.78711    1.63537   0.481   0.6353  
wt          -3.71530    1.89441  -1.961   0.0633 .
qsec         0.82104    0.73084   1.123   0.2739  
vs           0.31776    2.10451   0.151   0.8814  
am           2.52023    2.05665   1.225   0.2340  
gear         0.65541    1.49326   0.439   0.6652  
carb        -0.19942    0.82875  -0.241   0.8122  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.65 on 21 degrees of freedom
Multiple R-squared:  0.869, Adjusted R-squared:  0.8066 
F-statistic: 13.93 on 10 and 21 DF,  p-value: 3.793e-07</code></pre>
</div>
</div>
</details>
<p>Here, we can see that the model has explained almost 86.9 percent of variation present in <code>mpg</code>, but non of the predictors are significant. This is a hint of having unnecessary variables that has increased model error. Using <code>regsubsets</code> function from <code>leaps</code> package, we can select a subset of predictors based on some criteria.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;">library</span>(leaps)</span>
<span id="cb4-2">best.subset <span class="ot" style="color: #003B4F;">&lt;-</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;">regsubsets</span>(</span>
<span id="cb4-4">    <span class="at" style="color: #657422;">x      =</span> mtcars[, <span class="sc" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span>],     <span class="co" style="color: #5E5E5E;"># predictor variables</span></span>
<span id="cb4-5">    <span class="at" style="color: #657422;">y      =</span> mtcars[, <span class="dv" style="color: #AD0000;">1</span>],      <span class="co" style="color: #5E5E5E;"># response variable (mpg)</span></span>
<span id="cb4-6">    <span class="at" style="color: #657422;">nbest  =</span> <span class="dv" style="color: #AD0000;">1</span>,                <span class="co" style="color: #5E5E5E;"># top 1 best model</span></span>
<span id="cb4-7">    <span class="at" style="color: #657422;">nvmax  =</span> <span class="fu" style="color: #4758AB;">ncol</span>(mtcars) <span class="sc" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="co" style="color: #5E5E5E;"># max. number of variable (all)</span></span>
<span id="cb4-8">    <span class="at" style="color: #657422;">method =</span> <span class="st" style="color: #20794D;">"exhaustive"</span>      <span class="co" style="color: #5E5E5E;"># search all possible subset</span></span>
<span id="cb4-9">  )</span>
<span id="cb4-10">bs.smry <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">summary</span>(best.subset)</span></code></pre></div>
</div>
<p>We can combine following summary output with a plot created from additional estimates to get some insight. These estimates are also found in the summary object. The output show which variables are included with a star(<code>*</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">pander<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">pander</span>(bs.smry<span class="sc" style="color: #5E5E5E;">$</span>outmat)</span>
<span id="cb5-2">bs.est <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">data.frame</span>(</span>
<span id="cb5-3">  <span class="at" style="color: #657422;">nvar   =</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span>(best.subset<span class="sc" style="color: #5E5E5E;">$</span>nvmax <span class="sc" style="color: #5E5E5E;">-</span> <span class="dv" style="color: #AD0000;">1</span>),</span>
<span id="cb5-4">  <span class="at" style="color: #657422;">adj.r2 =</span> <span class="fu" style="color: #4758AB;">round</span>(bs.smry<span class="sc" style="color: #5E5E5E;">$</span>adjr2, <span class="dv" style="color: #AD0000;">3</span>),</span>
<span id="cb5-5">  <span class="at" style="color: #657422;">cp     =</span> <span class="fu" style="color: #4758AB;">round</span>(bs.smry<span class="sc" style="color: #5E5E5E;">$</span>cp, <span class="dv" style="color: #AD0000;">3</span>),</span>
<span id="cb5-6">  <span class="at" style="color: #657422;">bic    =</span> <span class="fu" style="color: #4758AB;">round</span>(bs.smry<span class="sc" style="color: #5E5E5E;">$</span>bic, <span class="dv" style="color: #AD0000;">3</span>)</span>
<span id="cb5-7">)</span>
<span id="cb5-8">bs.est <span class="ot" style="color: #003B4F;">&lt;-</span> tidyr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">gather</span>(bs.est, <span class="st" style="color: #20794D;">"estimates"</span>, <span class="st" style="color: #20794D;">"value"</span>, <span class="sc" style="color: #5E5E5E;">-</span>nvar)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 19%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">cyl</th>
<th style="text-align: center;">disp</th>
<th style="text-align: center;">hp</th>
<th style="text-align: center;">drat</th>
<th style="text-align: center;">wt</th>
<th style="text-align: center;">qsec</th>
<th style="text-align: center;">vs</th>
<th style="text-align: center;">am</th>
<th style="text-align: center;">gear</th>
<th style="text-align: center;">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>1 ( 1 )</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>2 ( 1 )</strong></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>3 ( 1 )</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>4 ( 1 )</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>5 ( 1 )</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>6 ( 1 )</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>7 ( 1 )</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>8 ( 1 )</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>9 ( 1 )</strong></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>10 ( 1 )</strong></td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
<td style="text-align: center;">*</td>
</tr>
</tbody>
</table>
</div>
</div>
<details>
<summary>
We can make a plot to visualise the properties of these individual models and select a model with specific number of predictor that can give minimum BIC, or minimum CP or maximum adjusted rsquared.
</summary>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;">library</span>(ggplot2)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;">library</span>(dplyr)</span>
<span id="cb6-3">bs.est.select <span class="ot" style="color: #003B4F;">&lt;-</span> bs.est <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;">group_by</span>(estimates) <span class="sc" style="color: #5E5E5E;">%&gt;%</span></span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;">filter</span>(</span>
<span id="cb6-6">    (value <span class="sc" style="color: #5E5E5E;">==</span> <span class="fu" style="color: #4758AB;">max</span>(value) <span class="sc" style="color: #5E5E5E;">&amp;</span> estimates <span class="sc" style="color: #5E5E5E;">==</span> <span class="st" style="color: #20794D;">"adj.r2"</span>) <span class="sc" style="color: #5E5E5E;">|</span></span>
<span id="cb6-7">    (value <span class="sc" style="color: #5E5E5E;">==</span> <span class="fu" style="color: #4758AB;">min</span>(value) <span class="sc" style="color: #5E5E5E;">&amp;</span> estimates <span class="sc" style="color: #5E5E5E;">!=</span> <span class="st" style="color: #20794D;">"adj.r2"</span>)</span>
<span id="cb6-8">  )</span>
<span id="cb6-9">assessment.plt <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">ggplot</span>(bs.est, <span class="fu" style="color: #4758AB;">aes</span>(nvar, value, <span class="at" style="color: #657422;">color =</span> estimates)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb6-10">  <span class="fu" style="color: #4758AB;">geom_point</span>(<span class="at" style="color: #657422;">shape =</span> <span class="dv" style="color: #AD0000;">21</span>, <span class="at" style="color: #657422;">fill =</span> <span class="st" style="color: #20794D;">"lightgray"</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb6-11">  <span class="fu" style="color: #4758AB;">geom_line</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;">~</span>estimates, <span class="at" style="color: #657422;">scale =</span> <span class="st" style="color: #20794D;">'free_y'</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb6-13">  <span class="fu" style="color: #4758AB;">theme</span>(<span class="at" style="color: #657422;">legend.position =</span> <span class="st" style="color: #20794D;">"top"</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;">labs</span>(<span class="at" style="color: #657422;">x =</span> <span class="st" style="color: #20794D;">"Number of variables in the model"</span>,</span>
<span id="cb6-15">       <span class="at" style="color: #657422;">y =</span> <span class="st" style="color: #20794D;">"Value of Estimate"</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb6-16">  <span class="fu" style="color: #4758AB;">scale_x_continuous</span>(<span class="at" style="color: #657422;">breaks =</span> <span class="fu" style="color: #4758AB;">seq</span>(<span class="dv" style="color: #AD0000;">0</span>, <span class="dv" style="color: #AD0000;">10</span>, <span class="dv" style="color: #AD0000;">2</span>)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb6-17">  <span class="fu" style="color: #4758AB;">geom_point</span>(<span class="at" style="color: #657422;">data =</span> bs.est.select, <span class="at" style="color: #657422;">fill =</span> <span class="st" style="color: #20794D;">"red"</span>,</span>
<span id="cb6-18">             <span class="at" style="color: #657422;">shape =</span> <span class="dv" style="color: #AD0000;">21</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb6-19">  <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> <span class="fu" style="color: #4758AB;">paste0</span>(<span class="st" style="color: #20794D;">"nvar:"</span>, nvar, <span class="st" style="color: #20794D;">'</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">'</span>, <span class="st" style="color: #20794D;">"value:"</span>, value)),</span>
<span id="cb6-20">            <span class="at" style="color: #657422;">data =</span> bs.est.select, </span>
<span id="cb6-21">            <span class="at" style="color: #657422;">size =</span> <span class="dv" style="color: #AD0000;">3</span>, <span class="at" style="color: #657422;">hjust =</span> <span class="dv" style="color: #AD0000;">0</span>, <span class="at" style="color: #657422;">vjust =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">1</span>, <span class="sc" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span>, <span class="sc" style="color: #5E5E5E;">-</span><span class="dv" style="color: #AD0000;">1</span>),</span>
<span id="cb6-22">            <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">"black"</span>, <span class="at" style="color: #657422;">family =</span> <span class="st" style="color: #20794D;">"monospace"</span>)</span></code></pre></div>
</div>
</details>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://mathatistics.com/blog/posts/2017-03-05-model-assessment-and-variable-selection-prodecure/index_files/figure-html/assessment.plot-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>From these plots, we see that with 5 variables we will obtain maximum adjusted coefficient of determination (<img src="https://latex.codecogs.com/png.latex?R%5E2">). Similarly, both BIC and Mallow CP will be minimum for models with only 3 predictor variables. With the help of table above, we can identify these variables. From the table, row corresponding to 3 variables, we see that the three predictors are <code>wt</code>, <code>qsec</code> and <code>am</code>. To obtain maximum adjusted <img src="https://latex.codecogs.com/png.latex?R%5E2">, <code>disp</code> and <code>hp</code> should be added to the previous 3 predictors.</p>
<p>This way, we can reduce a model to few variables optimising different assessment criteria. Let look at the fit of these reduced models:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">model<span class="fl" style="color: #AD0000;">.3</span> <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;">~</span> wt <span class="sc" style="color: #5E5E5E;">+</span> qsec <span class="sc" style="color: #5E5E5E;">+</span> am, <span class="at" style="color: #657422;">data =</span> mtcars)</span>
<span id="cb7-2">model<span class="fl" style="color: #AD0000;">.5</span> <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">update</span>(model<span class="fl" style="color: #AD0000;">.3</span>, . <span class="sc" style="color: #5E5E5E;">~</span> . <span class="sc" style="color: #5E5E5E;">+</span> disp <span class="sc" style="color: #5E5E5E;">+</span> hp)</span></code></pre></div>
</div>
<section id="summaries-of-the-models" class="level2 tabset">
<h2 class="tabset anchored" data-anchor-id="summaries-of-the-models">Summaries of the models</h2>
<section id="variable-model" class="level3 tab">
<h3 class="tab anchored" data-anchor-id="variable-model">3 Variable Model</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;">summary</span>(model<span class="fl" style="color: #AD0000;">.3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ wt + qsec + am, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4811 -1.5555 -0.7257  1.4110  4.6610 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   9.6178     6.9596   1.382 0.177915    
wt           -3.9165     0.7112  -5.507 6.95e-06 ***
qsec          1.2259     0.2887   4.247 0.000216 ***
am            2.9358     1.4109   2.081 0.046716 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.459 on 28 degrees of freedom
Multiple R-squared:  0.8497,    Adjusted R-squared:  0.8336 
F-statistic: 52.75 on 3 and 28 DF,  p-value: 1.21e-11</code></pre>
</div>
</div>
</section>
<section id="variable-model-1" class="level3 tab">
<h3 class="tab anchored" data-anchor-id="variable-model-1">5 Variable Model</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;">summary</span>(model<span class="fl" style="color: #AD0000;">.5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ wt + qsec + am + disp + hp, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.5399 -1.7398 -0.3196  1.1676  4.5534 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) 14.36190    9.74079   1.474  0.15238   
wt          -4.08433    1.19410  -3.420  0.00208 **
qsec         1.00690    0.47543   2.118  0.04391 * 
am           3.47045    1.48578   2.336  0.02749 * 
disp         0.01124    0.01060   1.060  0.29897   
hp          -0.02117    0.01450  -1.460  0.15639   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.429 on 26 degrees of freedom
Multiple R-squared:  0.8637,    Adjusted R-squared:  0.8375 
F-statistic: 32.96 on 5 and 26 DF,  p-value: 1.844e-10</code></pre>
</div>
</div>
<p>From these output, it seems that although adjusted <img src="https://latex.codecogs.com/png.latex?R%5E2"> has increased in later model, the additional variables are not significant. we can compare these two model with an ANOVA test which compares the residual variance between these two models. We can write the hypothesis as,</p>
<p><img src="https://latex.codecogs.com/png.latex?H_0:"> <em>Model 1</em> and <em>Model 2</em> are same vs <img src="https://latex.codecogs.com/png.latex?H_1:"> <em>Model 1</em> and <em>Model 2</em> are different</p>
<p>where, <em>Model 1</em> and <em>Model 2</em> represents 3 variable and 5 variable model</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;">anova</span>(model<span class="fl" style="color: #AD0000;">.3</span>, model<span class="fl" style="color: #AD0000;">.5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: mpg ~ wt + qsec + am
Model 2: mpg ~ wt + qsec + am + disp + hp
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1     28 169.29                           
2     26 153.44  2    15.848 1.3427 0.2786</code></pre>
</div>
</div>
<p>The ANOVA result can not reject the hypothesis so claim that <em>Model 1</em> and <em>Model 2</em> are same. So, it is better to select the simpler model with 3 predictor variables.</p>
</section>
</section>
</section>
<section id="step-wise-selection" class="level1">
<h1>Step-wise selection</h1>
<p>When the number of increases, a exhaustive search of all possible subset is computationally intensive. This disadvantage can be overcome by using step-wise selection procedure. A step-wise variable selection procedure can be,</p>
<dl>
<dt><strong>Forward Selection Procedure</strong></dt>
<dd>
In this procedure …
</dd>
<dt><strong>Backward Elimination Procedure</strong></dt>
<dd>
Here …
</dd>
</dl>


</section>

 ]]></description>
  <guid>https://mathatistics.com/blog/posts/2017-03-05-model-assessment-and-variable-selection-prodecure/index.html</guid>
  <pubDate>Sat, 04 Mar 2017 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Create LaTeX, HTML and Markdown tables in R</title>
  <dc:creator>Raju Rimal</dc:creator>
  <link>https://mathatistics.com/blog/posts/2017-03-01-generate-latex-or-html-table-with-r/index.html</link>
  <description><![CDATA[ 



<p>R can do data analysis and it can create beautiful reports. You can build all these documents directly in R using <code>rmarkdown</code> which is powered by powerful <code>pandoc</code>. In lots of occasions, user just wants to get some output format of tables that we can use in other platform such as Microsoft word, LaTeX, HTML or Markdown. Here I will discuss about some packages that helps us doing so including <code>xtable</code>, <code>pander</code>, <code>knitr</code>, <code>stargazer</code> and <code>tables</code>. I will use a sample dataset and a summary output from a linear model fit and convert them into various format. Although each of them need their own elaborate discussion, I will just use very basics of them since one can always go and dig into the help file for any details.</p>
<section id="creating-tables" class="level2 tabset">
<h2 class="tabset anchored" data-anchor-id="creating-tables">Creating Tables</h2>
<div class="cell">

</div>
<section id="xtable" class="level3 tab">
<h3 class="tab anchored" data-anchor-id="xtable">xtable</h3>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">xtable<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">print.xtable</span>(</span>
<span id="cb1-2">  xtable<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">xtable</span>(mtcars), <span class="at" style="color: #657422;">type =</span> <span class="st" style="color: #20794D;">'html'</span></span>
<span id="cb1-3">)</span></code></pre></div>

<!-- html table generated in R 4.3.1 by xtable 1.8-4 package -->
<!-- Tue Sep 19 10:56:58 2023 -->

<table border="1">
<tbody><tr>
<th>
</th>
<th>
mpg
</th>
<th>
cyl
</th>
<th>
disp
</th>
<th>
hp
</th>
<th>
drat
</th>
<th>
wt
</th>
<th>
qsec
</th>
<th>
vs
</th>
<th>
am
</th>
<th>
gear
</th>
<th>
carb
</th>
</tr>
<tr>
<td align="right">
Mazda RX4
</td>
<td align="right">
21.00
</td>
<td align="right">
6.00
</td>
<td align="right">
160.00
</td>
<td align="right">
110.00
</td>
<td align="right">
3.90
</td>
<td align="right">
2.62
</td>
<td align="right">
16.46
</td>
<td align="right">
0.00
</td>
<td align="right">
1.00
</td>
<td align="right">
4.00
</td>
<td align="right">
4.00
</td>
</tr>
<tr>
<td align="right">
Mazda RX4 Wag
</td>
<td align="right">
21.00
</td>
<td align="right">
6.00
</td>
<td align="right">
160.00
</td>
<td align="right">
110.00
</td>
<td align="right">
3.90
</td>
<td align="right">
2.88
</td>
<td align="right">
17.02
</td>
<td align="right">
0.00
</td>
<td align="right">
1.00
</td>
<td align="right">
4.00
</td>
<td align="right">
4.00
</td>
</tr>
<tr>
<td align="right">
Datsun 710
</td>
<td align="right">
22.80
</td>
<td align="right">
4.00
</td>
<td align="right">
108.00
</td>
<td align="right">
93.00
</td>
<td align="right">
3.85
</td>
<td align="right">
2.32
</td>
<td align="right">
18.61
</td>
<td align="right">
1.00
</td>
<td align="right">
1.00
</td>
<td align="right">
4.00
</td>
<td align="right">
1.00
</td>
</tr>
<tr>
<td align="right">
Hornet 4 Drive
</td>
<td align="right">
21.40
</td>
<td align="right">
6.00
</td>
<td align="right">
258.00
</td>
<td align="right">
110.00
</td>
<td align="right">
3.08
</td>
<td align="right">
3.21
</td>
<td align="right">
19.44
</td>
<td align="right">
1.00
</td>
<td align="right">
0.00
</td>
<td align="right">
3.00
</td>
<td align="right">
1.00
</td>
</tr>
<tr>
<td align="right">
Hornet Sportabout
</td>
<td align="right">
18.70
</td>
<td align="right">
8.00
</td>
<td align="right">
360.00
</td>
<td align="right">
175.00
</td>
<td align="right">
3.15
</td>
<td align="right">
3.44
</td>
<td align="right">
17.02
</td>
<td align="right">
0.00
</td>
<td align="right">
0.00
</td>
<td align="right">
3.00
</td>
<td align="right">
2.00
</td>
</tr>

</tbody></table>
</section>
<section id="pander" class="level3 tab">
<h3 class="tab anchored" data-anchor-id="pander">pander</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">pander<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">pander</span>(mtcars)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Table continues below</caption>
<colgroup>
<col style="width: 30%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">mpg</th>
<th style="text-align: center;">cyl</th>
<th style="text-align: center;">disp</th>
<th style="text-align: center;">hp</th>
<th style="text-align: center;">drat</th>
<th style="text-align: center;">wt</th>
<th style="text-align: center;">qsec</th>
<th style="text-align: center;">vs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Mazda RX4</strong></td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">160</td>
<td style="text-align: center;">110</td>
<td style="text-align: center;">3.9</td>
<td style="text-align: center;">2.62</td>
<td style="text-align: center;">16.46</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Mazda RX4 Wag</strong></td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">160</td>
<td style="text-align: center;">110</td>
<td style="text-align: center;">3.9</td>
<td style="text-align: center;">2.875</td>
<td style="text-align: center;">17.02</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Datsun 710</strong></td>
<td style="text-align: center;">22.8</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">108</td>
<td style="text-align: center;">93</td>
<td style="text-align: center;">3.85</td>
<td style="text-align: center;">2.32</td>
<td style="text-align: center;">18.61</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Hornet 4 Drive</strong></td>
<td style="text-align: center;">21.4</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">258</td>
<td style="text-align: center;">110</td>
<td style="text-align: center;">3.08</td>
<td style="text-align: center;">3.215</td>
<td style="text-align: center;">19.44</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Hornet Sportabout</strong></td>
<td style="text-align: center;">18.7</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">360</td>
<td style="text-align: center;">175</td>
<td style="text-align: center;">3.15</td>
<td style="text-align: center;">3.44</td>
<td style="text-align: center;">17.02</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 33%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">am</th>
<th style="text-align: center;">gear</th>
<th style="text-align: center;">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>Mazda RX4</strong></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Mazda RX4 Wag</strong></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Datsun 710</strong></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Hornet 4 Drive</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>Hornet Sportabout</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="knitr" class="level3 tab">
<h3 class="tab anchored" data-anchor-id="knitr">knitr</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">knitr<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">kable</span>(mtcars)</span></code></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 26%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mpg</th>
<th style="text-align: right;">cyl</th>
<th style="text-align: right;">disp</th>
<th style="text-align: right;">hp</th>
<th style="text-align: right;">drat</th>
<th style="text-align: right;">wt</th>
<th style="text-align: right;">qsec</th>
<th style="text-align: right;">vs</th>
<th style="text-align: right;">am</th>
<th style="text-align: right;">gear</th>
<th style="text-align: right;">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mazda RX4</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.620</td>
<td style="text-align: right;">16.46</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mazda RX4 Wag</td>
<td style="text-align: right;">21.0</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">160</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.90</td>
<td style="text-align: right;">2.875</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Datsun 710</td>
<td style="text-align: right;">22.8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">2.320</td>
<td style="text-align: right;">18.61</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hornet 4 Drive</td>
<td style="text-align: right;">21.4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">258</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">3.215</td>
<td style="text-align: right;">19.44</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hornet Sportabout</td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">360</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">3.440</td>
<td style="text-align: right;">17.02</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="tables" class="level3 tab">
<h3 class="tab anchored" data-anchor-id="tables">tables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">tables<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">as.tabular</span>(mtcars)</span></code></pre></div>
<div class="cell-output-display">

<table class="Rtable">
 <thead>
 <tr class="center">
  <th></th>
  <th>mpg</th>
  <th>cyl</th>
  <th>disp</th>
  <th>hp</th>
  <th>drat</th>
  <th>wt</th>
  <th>qsec</th>
  <th>vs</th>
  <th>am</th>
  <th>gear</th>
  <th>carb</th>
</tr>
 </thead>
 <tbody>
 <tr class="center">
  <th class="left">Mazda RX4</th>
  <td>21.0</td>
  <td>6</td>
  <td>160</td>
  <td>110</td>
  <td>3.90</td>
  <td>2.620</td>
  <td>16.46</td>
  <td>0</td>
  <td>1</td>
  <td>4</td>
  <td>4</td>
</tr>
 <tr class="center">
  <th class="left">Mazda RX4 Wag</th>
  <td>21.0</td>
  <td>6</td>
  <td>160</td>
  <td>110</td>
  <td>3.90</td>
  <td>2.875</td>
  <td>17.02</td>
  <td>0</td>
  <td>1</td>
  <td>4</td>
  <td>4</td>
</tr>
 <tr class="center">
  <th class="left">Datsun 710</th>
  <td>22.8</td>
  <td>4</td>
  <td>108</td>
  <td> 93</td>
  <td>3.85</td>
  <td>2.320</td>
  <td>18.61</td>
  <td>1</td>
  <td>1</td>
  <td>4</td>
  <td>1</td>
</tr>
 <tr class="center">
  <th class="left">Hornet 4 Drive</th>
  <td>21.4</td>
  <td>6</td>
  <td>258</td>
  <td>110</td>
  <td>3.08</td>
  <td>3.215</td>
  <td>19.44</td>
  <td>1</td>
  <td>0</td>
  <td>3</td>
  <td>1</td>
</tr>
 <tr class="center">
  <th class="left">Hornet Sportabout</th>
  <td>18.7</td>
  <td>8</td>
  <td>360</td>
  <td>175</td>
  <td>3.15</td>
  <td>3.440</td>
  <td>17.02</td>
  <td>0</td>
  <td>0</td>
  <td>3</td>
  <td>2</td>
</tr>
 </tbody>
 </table>

</div>
</div>
</section>
</section>
<section id="exercise" class="level2">
<h2 class="anchored" data-anchor-id="exercise">Exercise</h2>
<ol type="1">
<li>Use the <code>mtcars</code> dataset, fit a linear model with <code>mpg</code> as response variable and <code>wt</code>,<code>hp</code> and <code>disp</code> as predictor variable. Generate a LaTeX table and HTML table for the fitted model using xtable.</li>
</ol>


</section>

 ]]></description>
  <guid>https://mathatistics.com/blog/posts/2017-03-01-generate-latex-or-html-table-with-r/index.html</guid>
  <pubDate>Tue, 28 Feb 2017 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Using Data from different Packages</title>
  <dc:creator>Junali Chhetri</dc:creator>
  <link>https://mathatistics.com/blog/posts/2017-03-01-using-data-from-different-packages/index.html</link>
  <description><![CDATA[ 



<p>Most of the time we need data either for teaching purpose or learning things. Whatever be the reason, data are really important things. R and different packages of R contains different datasets which we can use directly just by installing them. Many books related to R illustrate there examples using these data sources. We can find the dataset from differnt sources as <code>data()</code></p>
<p>The datasets from the package <code>datasets</code> and other loaded packages is shown in default. However, we can obtain the datasets contained in specific packages as,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;">data</span>(<span class="at" style="color: #657422;">package=</span><span class="st" style="color: #20794D;">'MASS'</span>)</span></code></pre></div>
</div>
<p>The above will output the dataset contained in the package <code>MASS</code>. These datasets can be saved in a variable and used as different data structure like matrix, data frame or may be list. For example,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;">data</span>(Rubber, <span class="at" style="color: #657422;">package=</span><span class="st" style="color: #20794D;">'MASS'</span>) </span>
<span id="cb2-2">rubber.data <span class="ot" style="color: #003B4F;">&lt;-</span> Rubber</span></code></pre></div>
</div>
<section id="exercises" class="level3">
<h3 class="anchored" data-anchor-id="exercises">Exercises</h3>
<ol type="1">
<li>Save the Rabbit dataset from the package <code>MASS</code> into rabbitData and find the mean of BPchange for different Doses applied.</li>
<li>Load the data Greene from package <code>car</code> and find which location has the maximum variation in success.</li>
</ol>


</section>

 ]]></description>
  <category>R</category>
  <guid>https://mathatistics.com/blog/posts/2017-03-01-using-data-from-different-packages/index.html</guid>
  <pubDate>Tue, 28 Feb 2017 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Basic Scatter Plot and linear fitted line</title>
  <dc:creator>therimalaya</dc:creator>
  <link>https://mathatistics.com/blog/posts/2017-03-01-basic-scatter-plot-and-linear-fitted-line/index.html</link>
  <description><![CDATA[ 



<p>Lets scatter into some points created by data in xy-space. Data are scattered everywhere but what relation is there between some specific variable with other. Cutting down to simple talking and stick to the heading, we can use <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html"><code>mtcars</code></a> dataset in R.</p>
<p>The dataset from Motor Trend US magazine, 1974 comprises fuel consumption and 10 various aspects of automobile design and their performance for 32 automobiles of different models. I will try to obtain the scatter plot for the model and the fitted line for the model.</p>
<p>In R, there are three popular packages for obtaining plots <em>Base Graphics</em>, <em>Lattice Plot</em> and <em>ggplot2</em>. Here we will create a scatter plot between two variables <code>mpg</code> (mile per gallon) and <code>disp</code>(displacement) along with the fitted regession line with equation and <img src="https://latex.codecogs.com/png.latex?R%C2%B2"> value in it using all there graphics packages.</p>
<p>Lets first fit a linear model,</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">mdl <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;">~</span> disp, <span class="at" style="color: #657422;">data =</span> mtcars)</span>
<span id="cb1-2">sumry <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">summary</span>(mdl)</span>
<span id="cb1-3">cf <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">round</span>(<span class="fu" style="color: #4758AB;">coef</span>(mdl), <span class="dv" style="color: #AD0000;">2</span>)</span>
<span id="cb1-4"></span>
<span id="cb1-5">eqn <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">paste</span>(<span class="fu" style="color: #4758AB;">terms</span>(mdl)[[<span class="dv" style="color: #AD0000;">2</span>]],</span>
<span id="cb1-6">             <span class="fu" style="color: #4758AB;">paste0</span>(cf[<span class="dv" style="color: #AD0000;">1</span>], <span class="fu" style="color: #4758AB;">ifelse</span>(cf[<span class="dv" style="color: #AD0000;">2</span>] <span class="sc" style="color: #5E5E5E;">&lt;</span> <span class="dv" style="color: #AD0000;">0</span>, <span class="st" style="color: #20794D;">" "</span>, <span class="st" style="color: #20794D;">" + "</span>),</span>
<span id="cb1-7">                    cf[<span class="dv" style="color: #AD0000;">2</span>], <span class="st" style="color: #20794D;">" "</span>, <span class="fu" style="color: #4758AB;">terms</span>(mdl)[[<span class="dv" style="color: #AD0000;">3</span>]]), <span class="at" style="color: #657422;">sep =</span> <span class="st" style="color: #20794D;">" = "</span>)</span>
<span id="cb1-8">sumry.lbl <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">paste0</span>(<span class="st" style="color: #20794D;">"R^2: "</span>, <span class="fu" style="color: #4758AB;">round</span>(sumry<span class="sc" style="color: #5E5E5E;">$</span>r.squared, <span class="dv" style="color: #AD0000;">2</span>),</span>
<span id="cb1-9">                    <span class="st" style="color: #20794D;">", adj R^2: "</span>, <span class="fu" style="color: #4758AB;">round</span>(sumry<span class="sc" style="color: #5E5E5E;">$</span>adj.r.squared, <span class="dv" style="color: #AD0000;">2</span>))</span></code></pre></div>
</div>
<section id="plots" class="level2 tabset">
<h2 class="tabset anchored" data-anchor-id="plots">Plots</h2>
<section id="base-graphics" class="level3 tab">
<h3 class="tab anchored" data-anchor-id="base-graphics">Base Graphics</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;">with</span>(mtcars, {</span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;">plot</span>(disp, mpg, <span class="at" style="color: #657422;">pch =</span> <span class="dv" style="color: #AD0000;">22</span>, <span class="at" style="color: #657422;">bg =</span> <span class="st" style="color: #20794D;">"gray"</span>,</span>
<span id="cb2-3">       <span class="at" style="color: #657422;">xlab =</span> <span class="st" style="color: #20794D;">"Displacement"</span>, <span class="at" style="color: #657422;">ylab =</span> <span class="st" style="color: #20794D;">"Mile per Gallon"</span>,</span>
<span id="cb2-4">       <span class="at" style="color: #657422;">main =</span> <span class="st" style="color: #20794D;">"Displacement vs Mile per Gallon"</span>)</span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;">abline</span>(mdl, <span class="at" style="color: #657422;">col =</span> <span class="st" style="color: #20794D;">"red"</span>, <span class="at" style="color: #657422;">lty =</span> <span class="dv" style="color: #AD0000;">2</span>, <span class="at" style="color: #657422;">lwd =</span> <span class="dv" style="color: #AD0000;">2</span>)</span>
<span id="cb2-6">  <span class="fu" style="color: #4758AB;">text</span>(<span class="fu" style="color: #4758AB;">max</span>(disp), <span class="fu" style="color: #4758AB;">max</span>(mpg), <span class="at" style="color: #657422;">adj =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">1</span>, <span class="dv" style="color: #AD0000;">1</span>), <span class="at" style="color: #657422;">family =</span> <span class="st" style="color: #20794D;">"monospace"</span>,</span>
<span id="cb2-7">       <span class="at" style="color: #657422;">label =</span> <span class="fu" style="color: #4758AB;">paste</span>(eqn, sumry.lbl, <span class="at" style="color: #657422;">sep =</span> <span class="st" style="color: #20794D;">"</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">"</span>))</span>
<span id="cb2-8">})</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://mathatistics.com/blog/posts/2017-03-01-basic-scatter-plot-and-linear-fitted-line/index_files/figure-html/unnamed-chunk-3-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lattice-plot" class="level3 tab">
<h3 class="tab anchored" data-anchor-id="lattice-plot">Lattice Plot</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;">library</span>(lattice)</span>
<span id="cb3-2">lm.panel <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(x, y, ...) {</span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;">panel.xyplot</span>(x, y, <span class="at" style="color: #657422;">pch =</span> <span class="dv" style="color: #AD0000;">22</span>, <span class="at" style="color: #657422;">fill =</span> <span class="st" style="color: #20794D;">"gray"</span>,</span>
<span id="cb3-4">               <span class="at" style="color: #657422;">cex =</span> <span class="fl" style="color: #AD0000;">1.2</span>, <span class="at" style="color: #657422;">col =</span> <span class="st" style="color: #20794D;">"black"</span>)</span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;">panel.text</span>(<span class="fu" style="color: #4758AB;">max</span>(x), <span class="fu" style="color: #4758AB;">max</span>(y), <span class="at" style="color: #657422;">pos =</span> <span class="dv" style="color: #AD0000;">2</span>,</span>
<span id="cb3-6">             <span class="at" style="color: #657422;">fontfamily =</span> <span class="st" style="color: #20794D;">"monospace"</span>,</span>
<span id="cb3-7">             <span class="at" style="color: #657422;">label =</span> <span class="fu" style="color: #4758AB;">paste</span>(eqn, sumry.lbl, <span class="at" style="color: #657422;">sep =</span> <span class="st" style="color: #20794D;">"</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">"</span>))</span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;">panel.abline</span>(mdl, <span class="at" style="color: #657422;">col =</span> <span class="st" style="color: #20794D;">"red"</span>, <span class="at" style="color: #657422;">lty =</span> <span class="dv" style="color: #AD0000;">2</span>, <span class="at" style="color: #657422;">lwd =</span> <span class="dv" style="color: #AD0000;">2</span>)</span>
<span id="cb3-9">}</span>
<span id="cb3-10"><span class="fu" style="color: #4758AB;">xyplot</span>(mpg <span class="sc" style="color: #5E5E5E;">~</span> disp, <span class="at" style="color: #657422;">data =</span> mtcars,</span>
<span id="cb3-11">       <span class="at" style="color: #657422;">panel =</span> lm.panel,</span>
<span id="cb3-12">       <span class="at" style="color: #657422;">main =</span> <span class="st" style="color: #20794D;">"Displacement vs Mile per Gallon"</span>,</span>
<span id="cb3-13">       <span class="at" style="color: #657422;">xlab =</span> <span class="st" style="color: #20794D;">"Displacement"</span>, <span class="at" style="color: #657422;">ylab =</span> <span class="st" style="color: #20794D;">"Mile per Gallon"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://mathatistics.com/blog/posts/2017-03-01-basic-scatter-plot-and-linear-fitted-line/index_files/figure-html/unnamed-chunk-4-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ggplot" class="level3 tab">
<h3 class="tab anchored" data-anchor-id="ggplot">ggplot</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;">library</span>(ggplot2)</span>
<span id="cb4-2">plt <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">qplot</span>(disp, mpg, <span class="at" style="color: #657422;">data =</span> mtcars, <span class="at" style="color: #657422;">geom =</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="st" style="color: #20794D;">"point"</span>),</span>
<span id="cb4-3">             <span class="at" style="color: #657422;">xlab =</span> <span class="st" style="color: #20794D;">"Displacement"</span>,</span>
<span id="cb4-4">             <span class="at" style="color: #657422;">ylab =</span> <span class="st" style="color: #20794D;">"Mile per Gallon"</span>,</span>
<span id="cb4-5">             <span class="at" style="color: #657422;">main =</span> <span class="st" style="color: #20794D;">"Displacement vs Mile per Gallon"</span>,</span>
<span id="cb4-6">             <span class="at" style="color: #657422;">size =</span> <span class="fu" style="color: #4758AB;">I</span>(<span class="dv" style="color: #AD0000;">3</span>), <span class="at" style="color: #657422;">shape =</span> <span class="fu" style="color: #4758AB;">I</span>(<span class="dv" style="color: #AD0000;">22</span>), <span class="at" style="color: #657422;">fill =</span> <span class="fu" style="color: #4758AB;">I</span>(<span class="st" style="color: #20794D;">"grey"</span>))</span>
<span id="cb4-7">plt <span class="sc" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;">geom_smooth</span>(<span class="at" style="color: #657422;">method =</span> <span class="st" style="color: #20794D;">"lm"</span>, <span class="at" style="color: #657422;">color =</span> <span class="st" style="color: #20794D;">"red"</span>, <span class="at" style="color: #657422;">linetype =</span> <span class="dv" style="color: #AD0000;">2</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb4-9">  <span class="fu" style="color: #4758AB;">annotate</span>(<span class="at" style="color: #657422;">x =</span> <span class="cn" style="color: #8f5902;">Inf</span>, <span class="at" style="color: #657422;">y =</span> <span class="cn" style="color: #8f5902;">Inf</span>, <span class="at" style="color: #657422;">geom =</span> <span class="st" style="color: #20794D;">"text"</span>,</span>
<span id="cb4-10">           <span class="at" style="color: #657422;">hjust =</span> <span class="fl" style="color: #AD0000;">1.2</span>, <span class="at" style="color: #657422;">vjust =</span> <span class="fl" style="color: #AD0000;">1.2</span>,</span>
<span id="cb4-11">           <span class="at" style="color: #657422;">family =</span> <span class="st" style="color: #20794D;">"monospace"</span>,</span>
<span id="cb4-12">           <span class="at" style="color: #657422;">label =</span> <span class="fu" style="color: #4758AB;">paste</span>(eqn, sumry.lbl, <span class="at" style="color: #657422;">sep =</span> <span class="st" style="color: #20794D;">"</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://mathatistics.com/blog/posts/2017-03-01-basic-scatter-plot-and-linear-fitted-line/index_files/figure-html/unnamed-chunk-5-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>The fitted regression summary is,</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ disp, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8922 -2.2022 -0.9631  1.6272  7.2305 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 29.599855   1.229720  24.070  &lt; 2e-16 ***
disp        -0.041215   0.004712  -8.747 9.38e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.251 on 30 degrees of freedom
Multiple R-squared:  0.7183,    Adjusted R-squared:  0.709 
F-statistic: 76.51 on 1 and 30 DF,  p-value: 9.38e-10</code></pre>
</div>
</div>
<p>This means, the effect of displacement on mile per gallon of the cars in the model is negative and its magnitude is 0.04. In other words, on one unit change of displacement, the car will travel 0.04 less per gallon.</p>


</section>
</section>

 ]]></description>
  <guid>https://mathatistics.com/blog/posts/2017-03-01-basic-scatter-plot-and-linear-fitted-line/index.html</guid>
  <pubDate>Tue, 28 Feb 2017 23:00:00 GMT</pubDate>
</item>
<item>
  <title>LaTeX autocompletion in RStudio</title>
  <dc:creator>therimalaya</dc:creator>
  <link>https://mathatistics.com/blog/posts/2016-02-25-latex-autocompletion-in-rstudio/index.html</link>
  <description><![CDATA[ 



<p>When I was working on my Masters thesis, I needed the latex autocompletion feature in Rsudio, but could not find it anywhere. There is no option to create custom snippet either. But recently I found some basic and necessary auto-completion for latex is available in RStudio. Following are some of the these you want to use, but remember to press <code>Shift + Tab</code> for autocomplete. Further this will only work on <code>sweave</code> or <code>knitr</code> file only, which is pretty obvious. But we can always create snippets for <code>rmarkdown</code> documents.</p>
<section id="section" class="level2 keyword-title">
<h2 class="keyword-title anchored" data-anchor-id="section">Section</h2>
<p id="tex-keyword">
keyword: <code>sec</code>
</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode tex code-with-copy"><code class="sourceCode latex"><span id="cb1-1"><span class="kw" style="color: #003B4F;">\section</span>{section name}</span>
<span id="cb1-2"><span class="kw" style="color: #003B4F;">\label</span>{<span class="ex" style="color: null;">sec:section name</span>}</span></code></pre></div>
</section>
<section id="part" class="level2 keyword-title">
<h2 class="keyword-title anchored" data-anchor-id="part">Part</h2>
<p id="tex-keyword">
keyword: <code>part</code>
</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode tex code-with-copy"><code class="sourceCode latex"><span id="cb2-1"><span class="kw" style="color: #003B4F;">\part</span>{part name} <span class="co" style="color: #5E5E5E;">% (fold)</span></span>
<span id="cb2-2"><span class="kw" style="color: #003B4F;">\label</span>{<span class="ex" style="color: null;">prt:part name</span>}</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;">% part part name (end) </span></span></code></pre></div>
</section>
<section id="chapter" class="level2 keyword-title">
<h2 class="keyword-title anchored" data-anchor-id="chapter">Chapter</h2>
<p id="tex-keyword">
keyword: <code>chap</code>
</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode tex code-with-copy"><code class="sourceCode latex"><span id="cb3-1"><span class="kw" style="color: #003B4F;">\chapter</span>{chapter name}</span>
<span id="cb3-2"><span class="kw" style="color: #003B4F;">\label</span>{<span class="ex" style="color: null;">cha:chapter name</span>}</span></code></pre></div>
</section>
<section id="equation" class="level2 keyword-title">
<h2 class="keyword-title anchored" data-anchor-id="equation">Equation</h2>
<p id="tex-keyword">
keyword: <code>eq</code>
</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode tex code-with-copy"><code class="sourceCode latex"><span id="cb4-1"><span class="kw" style="color: #003B4F;">\begin</span>{<span class="ex" style="color: null;">equation</span>}</span>
<span id="cb4-2"><span class="ss" style="color: #20794D;">  </span></span>
<span id="cb4-3"><span class="kw" style="color: #003B4F;">\end</span>{<span class="ex" style="color: null;">equation</span>}</span></code></pre></div>
</section>
<section id="figure" class="level2 keyword-title">
<h2 class="keyword-title anchored" data-anchor-id="figure">Figure</h2>
<p id="tex-keyword">
keyword: <code>fig</code>
</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode tex code-with-copy"><code class="sourceCode latex"><span id="cb5-1"><span class="kw" style="color: #003B4F;">\begin</span>{<span class="ex" style="color: null;">figure</span>}</span>
<span id="cb5-2"><span class="kw" style="color: #003B4F;">\begin</span>{<span class="ex" style="color: null;">center</span>}</span>
<span id="cb5-3">    <span class="bu" style="color: null;">\includegraphics</span>[scale=]{<span class="ex" style="color: null;">Figures/</span>}</span>
<span id="cb5-4"><span class="kw" style="color: #003B4F;">\end</span>{<span class="ex" style="color: null;">center</span>}</span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;">\caption</span>{}</span>
<span id="cb5-6"><span class="kw" style="color: #003B4F;">\label</span>{<span class="ex" style="color: null;">fig:</span>}</span>
<span id="cb5-7"><span class="kw" style="color: #003B4F;">\end</span>{<span class="ex" style="color: null;">figure</span>}</span></code></pre></div>
</section>
<section id="tabular" class="level2 keyword-title">
<h2 class="keyword-title anchored" data-anchor-id="tabular">Tabular</h2>
<p id="tex-keyword">
keyword: <code>tab</code>
</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode tex code-with-copy"><code class="sourceCode latex"><span id="cb6-1"><span class="kw" style="color: #003B4F;">\begin</span>{<span class="ex" style="color: null;">tabular</span>}{c}</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="kw" style="color: #003B4F;">\end</span>{<span class="ex" style="color: null;">tabular</span>}</span></code></pre></div>
</section>
<section id="matrix" class="level2 keyword-title">
<h2 class="keyword-title anchored" data-anchor-id="matrix">Matrix</h2>
<p id="tex-keyword">
keyword: <code>mat</code>
</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode tex code-with-copy"><code class="sourceCode latex"><span id="cb7-1"><span class="kw" style="color: #003B4F;">\begin</span>{<span class="ex" style="color: null;">p</span><span class="er" style="color: #AD0000;">/b/v/V/B/smallmatrix</span>}</span>
<span id="cb7-2">  </span>
<span id="cb7-3"><span class="kw" style="color: #003B4F;">\end</span>{<span class="ex" style="color: null;">p</span><span class="er" style="color: #AD0000;">/b/v/V/B/smallmatrix</span>}</span></code></pre></div>
</section>
<section id="description-list" class="level2 keyword-title">
<h2 class="keyword-title anchored" data-anchor-id="description-list">Description List</h2>
<p id="tex-keyword">
keyword: <code>desc</code>
</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode tex code-with-copy"><code class="sourceCode latex"><span id="cb8-1"><span class="kw" style="color: #003B4F;">\begin</span>{<span class="ex" style="color: null;">description</span>}</span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;">\item</span>[] </span>
<span id="cb8-3"><span class="kw" style="color: #003B4F;">\end</span>{<span class="ex" style="color: null;">description</span>}</span></code></pre></div>
</section>
<section id="enumerate-list" class="level2 keyword-title">
<h2 class="keyword-title anchored" data-anchor-id="enumerate-list">Enumerate List</h2>
<p id="tex-keyword">
keyword: <code>enum</code>
</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode tex code-with-copy"><code class="sourceCode latex"><span id="cb9-1"><span class="kw" style="color: #003B4F;">\begin</span>{<span class="ex" style="color: null;">enumerate</span>}</span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;">\item</span> </span>
<span id="cb9-3"><span class="kw" style="color: #003B4F;">\end</span>{<span class="ex" style="color: null;">enumerate</span>}</span></code></pre></div>
</section>
<section id="general-environment" class="level2 keyword-title">
<h2 class="keyword-title anchored" data-anchor-id="general-environment">General Environment</h2>
<p id="tex-keyword">
keyword: <code>begin</code>
</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode tex code-with-copy"><code class="sourceCode latex"><span id="cb10-1"><span class="kw" style="color: #003B4F;">\begin</span>{<span class="ex" style="color: null;">env</span>}</span>
<span id="cb10-2">  </span>
<span id="cb10-3"><span class="kw" style="color: #003B4F;">\end</span>{<span class="ex" style="color: null;">env</span>}</span></code></pre></div>
</section>
<section id="figure-reference" class="level2 keyword-title">
<h2 class="keyword-title anchored" data-anchor-id="figure-reference">Figure Reference</h2>
<p id="tex-keyword">
keyword: <code>figure</code>
</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode tex code-with-copy"><code class="sourceCode latex"><span id="cb11-1">Figure~<span class="kw" style="color: #003B4F;">\ref</span>{<span class="ex" style="color: null;">fig:</span>}</span></code></pre></div>
</section>
<section id="table-reference" class="level2 keyword-title">
<h2 class="keyword-title anchored" data-anchor-id="table-reference">Table Reference</h2>
<p id="tex-keyword">
keyword: <code>table</code>
</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode tex code-with-copy"><code class="sourceCode latex"><span id="cb12-1">Table~<span class="kw" style="color: #003B4F;">\ref</span>{<span class="ex" style="color: null;">tab:</span>}</span></code></pre></div>
</section>
<section id="citation" class="level2 keyword-title">
<h2 class="keyword-title anchored" data-anchor-id="citation">Citation</h2>
<p id="tex-keyword">
keyword: <code>cite</code>
</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode tex code-with-copy"><code class="sourceCode latex"><span id="cb13-1"><span class="kw" style="color: #003B4F;">\cite</span>[]{}</span></code></pre></div>
<p>Apart from these basic formatting options such as <code>bf</code>, <code>sc</code>, <code>it</code> and <code>tt</code> will also work.</p>
</section>
<section id="update" class="level2">
<h2 class="anchored" data-anchor-id="update">Update:</h2>
<p>If you install daily-update of Rstudio, you will get TeX snippets support for both <code>TeX</code> and <code>Rnw</code> files. This has opened all the doors for features discussed here.</p>


</section>

 ]]></description>
  <category>Knitr</category>
  <category>LaTeX</category>
  <category>R IDE</category>
  <category>RStudio</category>
  <guid>https://mathatistics.com/blog/posts/2016-02-25-latex-autocompletion-in-rstudio/index.html</guid>
  <pubDate>Wed, 24 Feb 2016 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Scatter plot with multiple group</title>
  <dc:creator>Raju Rimal</dc:creator>
  <link>https://mathatistics.com/blog/posts/2016-01-12-scatter-with-multiple-group/index.html</link>
  <description><![CDATA[ 



<p>In many situations, it becomes essential to have a plot with multiple categories. For example, colour the scatter plot according to gender and have two different regression line for each of them.</p>
<p>Lets scatter the some points using data from <code>mtcars</code>, available default in R. Continuing the discussing from this post, where we had plotted mile per gallon (<code>mpg</code>) vs displacement (<code>disp</code>). Here we will create a separate regression line and colour the points accordingly based on number of cylinder (<code>cyl</code>) in the cars. In this article also, I will use there plotting system – base graphics, lattice plot and ggplot2.</p>
<p>First, lets fit our linear model with number of cylinder as a categorical variable.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">mtcars <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">within</span>(mtcars, cyl <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">as.factor</span>(cyl))</span>
<span id="cb1-2">mdl    <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">lm</span>(mpg <span class="sc" style="color: #5E5E5E;">~</span> disp <span class="sc" style="color: #5E5E5E;">*</span> cyl, <span class="at" style="color: #657422;">data =</span> mtcars)</span>
<span id="cb1-3">sumry  <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">summary</span>(mdl)</span>
<span id="cb1-4">sumry</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ disp * cyl, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4766 -1.8101 -0.2297  1.3523  5.0208 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  40.87196    3.02012  13.533 2.79e-13 ***
disp         -0.13514    0.02791  -4.842 5.10e-05 ***
cyl6        -21.78997    5.30660  -4.106 0.000354 ***
cyl8        -18.83916    4.61166  -4.085 0.000374 ***
disp:cyl6     0.13875    0.03635   3.817 0.000753 ***
disp:cyl8     0.11551    0.02955   3.909 0.000592 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.372 on 26 degrees of freedom
Multiple R-squared:  0.8701,    Adjusted R-squared:  0.8452 
F-statistic: 34.84 on 5 and 26 DF,  p-value: 9.968e-11</code></pre>
</div>
</div>
<p>Lets create a (intercept, slope) pair for each level of <code>cyl</code> and create separate equation for them.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">cf  <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">round</span>(<span class="fu" style="color: #4758AB;">coef</span>(mdl), <span class="dv" style="color: #AD0000;">3</span>)</span>
<span id="cb3-2">eq1 <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">c</span>(cf[<span class="dv" style="color: #AD0000;">1</span>], cf[<span class="dv" style="color: #AD0000;">2</span>])</span>
<span id="cb3-3">eq2 <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">c</span>(cf[<span class="dv" style="color: #AD0000;">1</span>] <span class="sc" style="color: #5E5E5E;">+</span> cf[<span class="dv" style="color: #AD0000;">3</span>], cf[<span class="dv" style="color: #AD0000;">2</span>] <span class="sc" style="color: #5E5E5E;">+</span> cf[<span class="dv" style="color: #AD0000;">5</span>])</span>
<span id="cb3-4">eq3 <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">c</span>(cf[<span class="dv" style="color: #AD0000;">1</span>] <span class="sc" style="color: #5E5E5E;">+</span> cf[<span class="dv" style="color: #AD0000;">4</span>], cf[<span class="dv" style="color: #AD0000;">2</span>] <span class="sc" style="color: #5E5E5E;">+</span> cf[<span class="dv" style="color: #AD0000;">6</span>])</span>
<span id="cb3-5">eq.fn <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(eq) {</span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;">paste0</span>(<span class="st" style="color: #20794D;">"mpg = "</span>, eq[<span class="dv" style="color: #AD0000;">1</span>],</span>
<span id="cb3-7">         <span class="fu" style="color: #4758AB;">ifelse</span>(eq[<span class="dv" style="color: #AD0000;">2</span>] <span class="sc" style="color: #5E5E5E;">&lt;</span> <span class="dv" style="color: #AD0000;">0</span>, <span class="st" style="color: #20794D;">" - "</span>, <span class="st" style="color: #20794D;">" + "</span>),</span>
<span id="cb3-8">         <span class="fu" style="color: #4758AB;">abs</span>(eq[<span class="dv" style="color: #AD0000;">2</span>]), <span class="st" style="color: #20794D;">" disp"</span>)</span>
<span id="cb3-9">}</span>
<span id="cb3-10">eqn <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">sapply</span>(<span class="fu" style="color: #4758AB;">list</span>(eq1, eq2, eq3), eq.fn)</span>
<span id="cb3-11">rsq.info <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="fu" style="color: #4758AB;">paste0</span>(<span class="st" style="color: #20794D;">"R^2: "</span>, <span class="fu" style="color: #4758AB;">round</span>(sumry[[<span class="st" style="color: #20794D;">"r.squared"</span>]], <span class="dv" style="color: #AD0000;">2</span>)),</span>
<span id="cb3-12">              <span class="fu" style="color: #4758AB;">paste0</span>(<span class="st" style="color: #20794D;">"adj. R^2: "</span>, <span class="fu" style="color: #4758AB;">round</span>(sumry[[<span class="st" style="color: #20794D;">"adj.r.squared"</span>]], <span class="dv" style="color: #AD0000;">2</span>)))</span></code></pre></div>
</div>
<section id="plots" class="level2 tabset">
<h2 class="tabset anchored" data-anchor-id="plots">Plots</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">Base Graphics</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">Lattice Plot</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" aria-controls="tabset-1-3" aria-selected="false">ggplot2</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab tab-pane active" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;">with</span>(mtcars, {</span>
<span id="cb4-2">  car<span class="sc" style="color: #5E5E5E;">::</span><span class="fu" style="color: #4758AB;">scatterplot</span>(disp, mpg, <span class="at" style="color: #657422;">groups =</span> cyl, <span class="at" style="color: #657422;">smooth =</span> F,</span>
<span id="cb4-3">                   <span class="at" style="color: #657422;">xlab =</span> <span class="st" style="color: #20794D;">"Displacement"</span>,</span>
<span id="cb4-4">                   <span class="at" style="color: #657422;">ylab =</span> <span class="st" style="color: #20794D;">"Mile per Gallon"</span>,</span>
<span id="cb4-5">                   <span class="at" style="color: #657422;">main =</span> <span class="st" style="color: #20794D;">"Mile per gallon vs displacement"</span>)</span>
<span id="cb4-6">})</span>
<span id="cb4-7">op <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">par</span>(<span class="at" style="color: #657422;">family =</span> <span class="st" style="color: #20794D;">"monospace"</span>)</span>
<span id="cb4-8"><span class="fu" style="color: #4758AB;">legend</span>(<span class="st" style="color: #20794D;">"topright"</span>, <span class="at" style="color: #657422;">text.col =</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">3</span>, <span class="at" style="color: #657422;">col =</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">3</span>, <span class="at" style="color: #657422;">box.lty =</span> <span class="dv" style="color: #AD0000;">0</span>,</span>
<span id="cb4-9">       <span class="at" style="color: #657422;">lty =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">lwd =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">legend =</span> eqn)</span>
<span id="cb4-10"><span class="fu" style="color: #4758AB;">legend</span>(<span class="st" style="color: #20794D;">"bottomleft"</span>, <span class="at" style="color: #657422;">legend =</span> rsq.info)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://mathatistics.com/blog/posts/2016-01-12-scatter-with-multiple-group/index_files/figure-html/base-plot-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;">par</span>(op)</span></code></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;">library</span>(lattice)</span>
<span id="cb6-2">lm.panel <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="cf" style="color: #003B4F;">function</span>(x, y, ...) {</span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;">panel.xyplot</span>(x, y, ...)</span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;">panel.abline</span>(eq1, <span class="at" style="color: #657422;">col =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">lwd =</span> <span class="dv" style="color: #AD0000;">2</span>, <span class="at" style="color: #657422;">lty =</span> <span class="dv" style="color: #AD0000;">2</span>)</span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;">panel.abline</span>(eq2, <span class="at" style="color: #657422;">col =</span> <span class="dv" style="color: #AD0000;">2</span>, <span class="at" style="color: #657422;">lwd =</span> <span class="dv" style="color: #AD0000;">2</span>, <span class="at" style="color: #657422;">lty =</span> <span class="dv" style="color: #AD0000;">2</span>)</span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;">panel.abline</span>(eq3, <span class="at" style="color: #657422;">col =</span> <span class="dv" style="color: #AD0000;">3</span>, <span class="at" style="color: #657422;">lwd =</span> <span class="dv" style="color: #AD0000;">2</span>, <span class="at" style="color: #657422;">lty =</span> <span class="dv" style="color: #AD0000;">2</span>)</span>
<span id="cb6-7">  <span class="fu" style="color: #4758AB;">panel.text</span>(<span class="fu" style="color: #4758AB;">max</span>(x), <span class="fu" style="color: #4758AB;">max</span>(y), <span class="at" style="color: #657422;">pos =</span> <span class="dv" style="color: #AD0000;">2</span>,</span>
<span id="cb6-8">             <span class="at" style="color: #657422;">fontfamily =</span> <span class="st" style="color: #20794D;">"monospace"</span>,</span>
<span id="cb6-9">             <span class="at" style="color: #657422;">label =</span> <span class="fu" style="color: #4758AB;">paste</span>(eqn, <span class="at" style="color: #657422;">collapse =</span> <span class="st" style="color: #20794D;">"</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">"</span>))</span>
<span id="cb6-10">  <span class="fu" style="color: #4758AB;">panel.text</span>(<span class="fu" style="color: #4758AB;">min</span>(x), <span class="fu" style="color: #4758AB;">min</span>(y), <span class="at" style="color: #657422;">pos =</span> <span class="dv" style="color: #AD0000;">4</span>,</span>
<span id="cb6-11">             <span class="at" style="color: #657422;">fontfamily =</span> <span class="st" style="color: #20794D;">"monospace"</span>,</span>
<span id="cb6-12">             <span class="at" style="color: #657422;">label =</span> <span class="fu" style="color: #4758AB;">paste</span>(rsq.info, <span class="at" style="color: #657422;">collapse =</span> <span class="st" style="color: #20794D;">"</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">"</span>))</span>
<span id="cb6-13">}</span>
<span id="cb6-14"><span class="fu" style="color: #4758AB;">xyplot</span>(mpg <span class="sc" style="color: #5E5E5E;">~</span> disp, <span class="at" style="color: #657422;">data =</span> mtcars, <span class="at" style="color: #657422;">groups =</span> cyl,</span>
<span id="cb6-15">       <span class="at" style="color: #657422;">auto.key =</span> <span class="fu" style="color: #4758AB;">list</span>(<span class="at" style="color: #657422;">columns =</span> <span class="dv" style="color: #AD0000;">3</span>, <span class="at" style="color: #657422;">cex =</span> <span class="fl" style="color: #AD0000;">0.8</span>,</span>
<span id="cb6-16">                       <span class="at" style="color: #657422;">title =</span> <span class="st" style="color: #20794D;">"Cylinder"</span>),</span>
<span id="cb6-17">       <span class="at" style="color: #657422;">col =</span> <span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">3</span>, <span class="at" style="color: #657422;">xlab =</span> <span class="st" style="color: #20794D;">"Displacement"</span>,</span>
<span id="cb6-18">       <span class="at" style="color: #657422;">ylab =</span> <span class="st" style="color: #20794D;">"Mile per gallon"</span>,</span>
<span id="cb6-19">       <span class="at" style="color: #657422;">panel =</span> lm.panel)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://mathatistics.com/blog/posts/2016-01-12-scatter-with-multiple-group/index_files/figure-html/lattice-graphics-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab tab-pane" aria-labelledby="tabset-1-3-tab">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;">library</span>(ggplot2)</span>
<span id="cb7-2"><span class="do" style="color: #5E5E5E;
font-style: italic;">## Equation table for displaying them on the plot</span></span>
<span id="cb7-3">eqn.df <span class="ot" style="color: #003B4F;">&lt;-</span> <span class="fu" style="color: #4758AB;">with</span>(mtcars, {</span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;">data.frame</span>(</span>
<span id="cb7-5">    <span class="at" style="color: #657422;">cyl  =</span> <span class="fu" style="color: #4758AB;">sort</span>(<span class="fu" style="color: #4758AB;">unique</span>(cyl)),</span>
<span id="cb7-6">    <span class="at" style="color: #657422;">mpg  =</span> <span class="fu" style="color: #4758AB;">max</span>(mpg) <span class="sc" style="color: #5E5E5E;">-</span> <span class="fu" style="color: #4758AB;">c</span>(<span class="dv" style="color: #AD0000;">1</span><span class="sc" style="color: #5E5E5E;">:</span><span class="dv" style="color: #AD0000;">3</span>),</span>
<span id="cb7-7">    <span class="at" style="color: #657422;">disp =</span> <span class="fu" style="color: #4758AB;">max</span>(disp), <span class="at" style="color: #657422;">eqn =</span> eqn</span>
<span id="cb7-8">  )</span>
<span id="cb7-9">})</span>
<span id="cb7-10"><span class="fu" style="color: #4758AB;">ggplot</span>(mtcars, <span class="fu" style="color: #4758AB;">aes</span>(disp, mpg, <span class="at" style="color: #657422;">color =</span> cyl)) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb7-11">  <span class="fu" style="color: #4758AB;">geom_point</span>() <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb7-12">  <span class="fu" style="color: #4758AB;">theme_bw</span>(<span class="at" style="color: #657422;">base_size =</span> <span class="dv" style="color: #AD0000;">14</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb7-13">  <span class="fu" style="color: #4758AB;">geom_smooth</span>(<span class="at" style="color: #657422;">method =</span> <span class="st" style="color: #20794D;">"lm"</span>, <span class="at" style="color: #657422;">se =</span> <span class="cn" style="color: #8f5902;">FALSE</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;">geom_text</span>(<span class="at" style="color: #657422;">data =</span> eqn.df, <span class="fu" style="color: #4758AB;">aes</span>(<span class="at" style="color: #657422;">label =</span> eqn),</span>
<span id="cb7-15">            <span class="at" style="color: #657422;">hjust =</span> <span class="dv" style="color: #AD0000;">1</span>, <span class="at" style="color: #657422;">family =</span> <span class="st" style="color: #20794D;">"mono"</span>) <span class="sc" style="color: #5E5E5E;">+</span></span>
<span id="cb7-16">  <span class="fu" style="color: #4758AB;">annotate</span>(<span class="at" style="color: #657422;">geom =</span> <span class="st" style="color: #20794D;">"text"</span>,</span>
<span id="cb7-17">           <span class="at" style="color: #657422;">x =</span> <span class="fu" style="color: #4758AB;">min</span>(mtcars<span class="sc" style="color: #5E5E5E;">$</span>disp), <span class="at" style="color: #657422;">y =</span> <span class="fu" style="color: #4758AB;">min</span>(mtcars<span class="sc" style="color: #5E5E5E;">$</span>mpg),</span>
<span id="cb7-18">           <span class="at" style="color: #657422;">family =</span> <span class="st" style="color: #20794D;">"mono"</span>, <span class="at" style="color: #657422;">hjust =</span> <span class="dv" style="color: #AD0000;">0</span>,</span>
<span id="cb7-19">           <span class="at" style="color: #657422;">label =</span> <span class="fu" style="color: #4758AB;">paste0</span>(rsq.info, <span class="at" style="color: #657422;">collapse =</span> <span class="st" style="color: #20794D;">"</span><span class="sc" style="color: #5E5E5E;">\n</span><span class="st" style="color: #20794D;">"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://mathatistics.com/blog/posts/2016-01-12-scatter-with-multiple-group/index_files/figure-html/ggplot-1.svg" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>


</section>

 ]]></description>
  <guid>https://mathatistics.com/blog/posts/2016-01-12-scatter-with-multiple-group/index.html</guid>
  <pubDate>Mon, 11 Jan 2016 23:00:00 GMT</pubDate>
</item>
</channel>
</rss>
